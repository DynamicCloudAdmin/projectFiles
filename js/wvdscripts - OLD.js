const userId = new Date().getTime();
const MIN_4 = 240000;

document.getElementById("AddNewAssignmentsPanel").style.display = "none";
document.getElementById("ModifyAVDOptionsModal").style.display = "none";
document.getElementById("AddTenantModalToDispAndClose").style.display = "none";
document.getElementById("TestSPNModalForm").style.display = "none";
document.getElementById("EditDetailsDiv").style.display = "none";
document.getElementById("AddChartcolumnModal").style.display = "none";
document.getElementById("SessManQuickAction").style.display = "none";
document.getElementById("AddNewRBACUserModal").style.display = "none";
document.getElementById("AddNewNotificationPanel").style.display = "none";
document.getElementById("AddNewTemplateModal").style.display = "none";
document.getElementById("CreateNewAVDTempPane").style.display = "none";
document.getElementById("ConfirmDBox").style.display = "none";
document.getElementById("ProfileServerAddModal").style.display = "none";
document.getElementById("AVDRunningNotificationsPane").style.display = "none";
document.getElementById("ServerMonActionDetailsMod").style.display = "none";
document.getElementById("FeedbackModDiv").style.display = "none";

document.getElementById("TemplateHostPoolPane").style.display = "block";
document.getElementById("TemplateSessionHostPane").style.display = "none";
document.getElementById("TemplateFSLogixPane").style.display = "none";
document.getElementById("TemplateImagePane").style.display = "none";
document.getElementById("ShadowSessModN").style.display = "none";

document.getElementById("SecondLoginBox").style.display = "none";
//document.getElementById("FirstLoginBox").style.display = "none";

document.getElementById("CheckLoginCircle").style.display = "none";

document.getElementById("EnableProactiveMonitoringCheckBox").checked = false;

function GlobalTimerToExecuteForAll() {
    var GlobalNovaTimer = setInterval(function() { GlobalWhatToGetNowFunction() }, 3000);

    function GlobalWhatToGetNowFunction() {
        var WhatToGetNow = document.getElementById("WhatToGetFromServer").innerHTML;

        if (WhatToGetNow == "GETCOMPANDRISKITEMS") {
            document.getElementById("SwitchToRiskAndCompList").click();
        }
        if (WhatToGetNow == "DASHITEMS") {
            document.getElementById("DASHSwitchToSelTen").click();
        }

        // SOCKETIO - commented this as hadnling through socetio
        // if (WhatToGetNow == "HOSTHEALTHITEMS") {
        //     document.getElementById("HOSTAvaSelTenButtonN").click();
        // }
        if (WhatToGetNow == "SESSMANAGERITEMS") {
            document.getElementById("SessManaAvaSelSwitchButton").click();
        }
        if (WhatToGetNow == "SESSMONITEMS") {
            document.getElementById("MonSelSelTen").click();
        }
        if (WhatToGetNow == "ASSIGNMENTITEMS") {
            document.getElementById("ManAssSwitchToSelTenNN").click();
        }
        if (WhatToGetNow == "IMAGEMANAGERITEMS") {
            document.getElementById("SwitchToImageManagerTen").click();
        }
        if (WhatToGetNow == "SERVERACTIONS_USERSCONNECTED") {
            GetServerActionFileNow()
        }
        if (WhatToGetNow == "FETCHIMAGES") {
            document.getElementById("RefAndAllImagesNow").click();
        }
        if (WhatToGetNow == "FETCHIMAGESTEN") {
            AVDTemplateAllFetchImages()
        }
        if (WhatToGetNow == "COLLECTVMSIZES") {
            CheckFileSizeNowFunction()
        }
        if (WhatToGetNow == "COLLECTVMNETWORK") {
            CheckNetworkFileForHost()
        }
        if (WhatToGetNow == "GETALLTENLOCATIONS") {
            GetAllTenLocationsNowFunction()
        }
        if (WhatToGetNow == "AVD Host Pools") {
            document.getElementById("ButtonSwitchToAVDTen").click();
        }
        if (WhatToGetNow == "AVD Start Menu Apps") {
            document.getElementById("ButtonSwitchToAVDTen").click();
        }
        if (WhatToGetNow == "AVD Application Groups") {
            document.getElementById("ButtonSwitchToAVDTen").click();
        }
        if (WhatToGetNow == "AVD Application Group Users") {
            document.getElementById("ButtonSwitchToAVDTen").click();
        }
        if (WhatToGetNow == "AVD Workspace Info") {
            document.getElementById("ButtonSwitchToAVDTen").click();
        }
        if (WhatToGetNow == "AVD Session Hosts Info") {
            document.getElementById("ButtonSwitchToAVDTen").click();
        }
        if (WhatToGetNow == "AVD Session Hosts Heartbeat and Update Status") {
            document.getElementById("ButtonSwitchToAVDTen").click();
        }
        if (WhatToGetNow == "GETHOSTSFORSCRIPT") {
            document.getElementById("DEPLOpenScriptTemplateNow").click();
        }
        if (WhatToGetNow == "PROFILESREF") {
            document.getElementById("ProfManaSwitchTenNN").click();
        }
        if (WhatToGetNow == "PROFILESSIZES") {
            GetAllProfileSizesNowFunction()
        }
        if (WhatToGetNow == "COLLECTUSERSFROMGROUP") {
            ShowCollectedUsersFromGroupFunction()
        }

        // if (WhatToGetNow == "AVDDEPLOYMONITOR") {
        //    MonitorAVDDEployFunction()
        // }
    }

    //    var TaskCheckingTimer = setInterval(function() { CheckAllTasksStatusFunction() }, 300000);

    //  function CheckAllTasksStatusFunction() {
    // Call TOP Notification Refresh Button here
    //document.getElementById("RefAllTaskRunningListButton").click();

    //}
}

// START: POLicy MANAGER PANE
{

    $("#RemoveAllRBACUsers").click(function(e) {

        var ThisUser = document.getElementById("AllRBACUsersList").value;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to remove ALL Users?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVEALLUSERS";

    });

    $("#RemoveSelectedRBACUser").click(function(e) {

        var ThisUser = document.getElementById("AllRBACUsersList").value;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to remove Selected User: " + ThisUser
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVERBACUSER";

    });

    $("#RemAllTemplateID").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Remove All Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVEALLTEMPLATES";
    });

    $("#RemoveSelTemplateID").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Remove Current Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVECURRENTTEMPLATE";
    });

    $("#ResetValueToZero").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Reset all Hours to ZERO?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "RESETTOZERO";
    });

    $("#SaveCurPolicy").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Save current Policy Settings?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "SAVEPOLSETTINGS";
    });

    $("#CreateNewPolicy").click(function(e) {

        document.getElementById("AddNewPolicyN").style.display = "block";
        GetAllHostPoolsForPolCreation()

    });

    $("#ClosePolModal").click(function(e) {

        document.getElementById("AddNewPolicyN").style.display = "none";

    });

    $("#OpenSelectedPolicyN").click(function(e) {

        var ThisMsg = "Opening Policy. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeftEmailTemplate = document.getElementById("SelectedPolEmailTemplateN");
                    var options = document.querySelectorAll('#SelectedPolEmailTemplateN option');
                    options.forEach(o => o.remove());

                    var xLeftScriptOne = document.getElementById("ConditionANumberFIVE");
                    var options = document.querySelectorAll('#ConditionANumberFIVE option');
                    options.forEach(o => o.remove());

                    var xLeftScriptTwo = document.getElementById("ConditionALLOFFFIVE");
                    var options = document.querySelectorAll('#ConditionALLOFFFIVE option');
                    options.forEach(o => o.remove());

                    var xLeftScriptThree = document.getElementById("ConditionALLOFFFIVE");
                    var options = document.querySelectorAll('#ConditionALLOFFFIVE option');
                    options.forEach(o => o.remove());

                    var xLeftScriptFour = document.getElementById("ConditionALLONFOUR");
                    var options = document.querySelectorAll('#ConditionALLONFOUR option');
                    options.forEach(o => o.remove());

                    var xLeftScriptFive = document.getElementById("ConditionZERONINE");
                    var options = document.querySelectorAll('#ConditionZERONINE option');
                    options.forEach(o => o.remove());

                    var xLeftScriptSix = document.getElementById("ConditionZEROSEVENTEEN");
                    var options = document.querySelectorAll('#ConditionZEROSEVENTEEN option');
                    options.forEach(o => o.remove());

                    var xLeftHostOne = document.getElementById("ConditionANumberFOUR");
                    var options = document.querySelectorAll('#ConditionANumberFOUR option');
                    options.forEach(o => o.remove());

                    var xLeftHostTwo = document.getElementById("ConditionZEROEIGHT");
                    var options = document.querySelectorAll('#ConditionZEROEIGHT option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {

                                    if (CheckTType == "SessionHostTemplate") {

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftHostOne.add(optionR);

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftHostTwo.add(optionR);

                                    }

                                    if (CheckTType == "EmailTemplate") {

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftEmailTemplate.add(optionR);

                                    }

                                    if (CheckTType == "ScriptTemplate") {

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftScriptOne.add(optionR);

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftScriptTwo.add(optionR);

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftScriptThree.add(optionR);

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftScriptFour.add(optionR);

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftScriptFive.add(optionR);

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeftScriptSix.add(optionR);

                                    }


                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

        var SelPolicyNow = document.getElementById("AllAvaPolicyInPane").value;

        document.getElementById("OpenedPolicyNameN").innerHTML = "Selected Policy: " + SelPolicyNow;
        document.getElementById("OpenedPoltype").innerHTML = "Policy Type: Multi-Scaling";

        const PolHoursCol = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/CallLoadPolicyDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelPolicyNow': SelPolicyNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'PolicyHourlyTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatablePolicyChart = document.createElement("table");
                    datatablePolicyChart.id = 'PolicyHourlyChartTable'
                    datatablePolicyChart.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableConditionAllOffVMs = document.createElement("table");
                    datatableConditionAllOffVMs.id = 'datatableConditionAllOffTable'
                    datatableConditionAllOffVMs.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableConditionAllOnVMs = document.createElement("table");
                    datatableConditionAllOnVMs.id = 'datatableConditionAllOnTable'
                    datatableConditionAllOnVMs.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableConditionZEROOneVMs = document.createElement("table");
                    datatableConditionZEROOneVMs.id = 'datatableConditionZEROOneTable'
                    datatableConditionZEROOneVMs.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableConditionZEROTwoVMs = document.createElement("table");
                    datatableConditionZEROTwoVMs.id = 'datatableConditionZEROTwoTable'
                    datatableConditionZEROTwoVMs.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckSRow == "CONDITIONANUMBER") {

                            var ForThisSetting = cells[2];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionANumberONE").checked = true;
                            } else {
                                document.getElementById("ConditionANumberONE").checked = false;
                            }

                            var ForThisSetting = cells[3];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionANumberTWO").checked = true;
                            } else {
                                document.getElementById("ConditionANumberTWO").checked = false;
                            }

                            var ForThisSetting = cells[4];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionANumberTHREE").checked = true;
                            } else {
                                document.getElementById("ConditionANumberTHREE").checked = false;
                            }

                            var ForThisSetting = cells[5];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionANumberFOUR").value = SettingNow;

                            var ForThisSetting = cells[6];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionANumberFIVE").value = SettingNow;

                            var ForThisSetting = cells[7];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionANumberSIX").checked = true;
                            } else {
                                document.getElementById("ConditionANumberSIX").checked = false;
                            }

                            var ForThisSetting = cells[8];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionANumberSEVEN").checked = true;
                            } else {
                                document.getElementById("ConditionANumberSEVEN").checked = false;
                            }

                            var ForThisSetting = cells[9];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionANumberTHREEEEXECUTEASCRIPT").checked = true;
                            } else {
                                document.getElementById("ConditionANumberTHREEEEXECUTEASCRIPT").checked = false;
                            }

                            var ForThisSetting = cells[10];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZERONINESCRIPTTemplate").value = SettingNow;

                            var ForThisSetting = cells[11];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ForceLogoffUsersD").checked = true;
                            } else {
                                document.getElementById("ForceLogoffUsersD").checked = false;
                            }


                        }

                        if (CheckSRow == "CONDITIONALLOFF") {

                            var ForThisSetting = cells[2];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionALLOFFONE").checked = true;
                            } else {
                                document.getElementById("ConditionALLOFFONE").checked = false;
                            }

                            var ForThisSetting = cells[3];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionALLOFFTWO").checked = true;
                            } else {
                                document.getElementById("ConditionALLOFFTWO").checked = false;
                            }

                            var ForThisSetting = cells[4];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionALLOFFTHREE").checked = true;
                            } else {
                                document.getElementById("ConditionALLOFFTHREE").checked = false;
                            }

                            var ForThisSetting = cells[5];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionALLOFFFOUR").checked = true;
                            } else {
                                document.getElementById("ConditionALLOFFFOUR").checked = false;
                            }

                            var ForThisSetting = cells[6];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionALLOFFFIVE").value = SettingNow;

                            var ForThisSetting = cells[7];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ForceLogoffUSersTWOInAllOff").checked = true;
                            } else {
                                document.getElementById("ForceLogoffUSersTWOInAllOff").checked = false;
                            }

                        }

                        if (CheckSRow == "CONDITIONALLON") {

                            var ForThisSetting = cells[2];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionALLONONE").checked = true;
                            } else {
                                document.getElementById("ConditionALLONONE").checked = false;
                            }

                            var ForThisSetting = cells[3];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionALLONTWO").checked = true;
                            } else {
                                document.getElementById("ConditionALLONTWO").checked = false;
                            }

                            var ForThisSetting = cells[4];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionALLONTHREE").checked = true;
                            } else {
                                document.getElementById("ConditionALLONTHREE").checked = false;
                            }

                            var ForThisSetting = cells[5];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionALLONFOUR").value = SettingNow;

                        }

                        if (CheckSRow == "CONDITIONZEROSCALEOUT") {

                            var ForThisSetting = cells[2];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZEROONE").value = SettingNow;

                            var ForThisSetting = cells[3];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROTWO").checked = true;
                            } else {
                                document.getElementById("ConditionZEROTWO").checked = false;
                            }

                            var ForThisSetting = cells[4];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROTHREE").checked = true;
                            } else {
                                document.getElementById("ConditionZEROTHREE").checked = false;
                            }

                            var ForThisSetting = cells[5];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROFOUR").checked = true;
                            } else {
                                document.getElementById("ConditionZEROFOUR").checked = false;
                            }

                            var ForThisSetting = cells[6];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROFIVE").checked = true;
                            } else {
                                document.getElementById("ConditionZEROFIVE").checked = false;
                            }

                            var ForThisSetting = cells[7];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZEROSIX").value = SettingNow;

                            var ForThisSetting = cells[8];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROSEVEN").checked = true;
                            } else {
                                document.getElementById("ConditionZEROSEVEN").checked = false;
                            }

                            var ForThisSetting = cells[9];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZEROEIGHT").value = SettingNow;

                            var ForThisSetting = cells[10];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZERONINE").value = SettingNow;

                        }

                        if (CheckSRow == "CONDITIONZEROSCALEIN") {

                            var ForThisSetting = cells[2];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZEROELEVEN").value = SettingNow;

                            var ForThisSetting = cells[3];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROTWE").checked = true;
                            } else {
                                document.getElementById("ConditionZEROTWE").checked = false;
                            }

                            var ForThisSetting = cells[4];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROTHIRTEEN").checked = true;
                            } else {
                                document.getElementById("ConditionZEROTHIRTEEN").checked = false;
                            }

                            var ForThisSetting = cells[5];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROFOURTEEN").checked = true;
                            } else {
                                document.getElementById("ConditionZEROFOURTEEN").checked = false;
                            }

                            var ForThisSetting = cells[6];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROFIFTEEN").checked = true;
                            } else {
                                document.getElementById("ConditionZEROFIFTEEN").checked = false;
                            }

                            var ForThisSetting = cells[7];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZEROSEVENTEEN").value = SettingNow;

                            var ForThisSetting = cells[8];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ConditionZEROFIVEKeepMinimumOrNotCheckBox").checked = true;
                            } else {
                                document.getElementById("ConditionZEROFIVEKeepMinimumOrNotCheckBox").checked = false;
                            }

                            var ForThisSetting = cells[9];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            document.getElementById("ConditionZEROSIXMinimumHostsInScalIn").value = SettingNow;

                            var ForThisSetting = cells[8];
                            var RC = ForThisSetting.split(":")
                            var SettingNow = RC[1];
                            if (SettingNow == "true") {
                                document.getElementById("ForceLogoffUsersInScalInN").checked = true;
                            } else {
                                document.getElementById("ForceLogoffUsersInScalInN").checked = false;
                            }

                        }

                        if (CheckSRow == "POLSETTINGS") {
                            document.getElementById("SelectedPolPolTenant").value = cells[2];
                            document.getElementById("SelectedPolPolHostPool").value = cells[3];
                            document.getElementById("SelectedPolPolStatus").value = cells[4];
                            document.getElementById("SelectedPolPolMode").value = cells[5];
                            document.getElementById("SelectedPolEmailTemplateN").value = cells[8];
                            document.getElementById("PolicyMSGTitleN").value = cells[9];
                            document.getElementById("MSGHereForUserS").value = cells[10];
                            document.getElementById("PolicyWaitSecondsBeforeForceLogoff").value = cells[11];

                        }

                        if (CheckSRow == "WEEKLYNUMBER") {

                            var ForThisDay = cells[2];
                            var RC = ForThisDay.split(":")
                            var WhichValue = RC[1];
                            var ThisValue = RC[2];
                            document.getElementById("MondayLogicValue").value = WhichValue;
                            document.getElementById("MondayLogicValueValue").value = ThisValue;

                            var ForThisDay = cells[3];
                            var RC = ForThisDay.split(":")
                            var WhichValue = RC[1];
                            var ThisValue = RC[2];
                            document.getElementById("TeusdayLogicValue").value = WhichValue;
                            document.getElementById("TeusdayLogicValueValue").value = ThisValue;

                            var ForThisDay = cells[4];
                            var RC = ForThisDay.split(":")
                            var WhichValue = RC[1];
                            var ThisValue = RC[2];
                            document.getElementById("WednedayLogicValue").value = WhichValue;
                            document.getElementById("WednedayLogicValueValue").value = ThisValue;

                            var ForThisDay = cells[5];
                            var RC = ForThisDay.split(":")
                            var WhichValue = RC[1];
                            var ThisValue = RC[2];
                            document.getElementById("ThuLogicValue").value = WhichValue;
                            document.getElementById("ThuLogicValueValue").value = ThisValue;

                            var ForThisDay = cells[6];
                            var RC = ForThisDay.split(":")
                            var WhichValue = RC[1];
                            var ThisValue = RC[2];
                            document.getElementById("FridayLogicValue").value = WhichValue;
                            document.getElementById("FridayLogicValueValue").value = ThisValue;

                            var ForThisDay = cells[7];
                            var RC = ForThisDay.split(":")
                            var WhichValue = RC[1];
                            var ThisValue = RC[2];
                            document.getElementById("SatLogicValue").value = WhichValue;
                            document.getElementById("SatLogicValueValue").value = ThisValue;

                            var ForThisDay = cells[8];
                            var RC = ForThisDay.split(":")
                            var WhichValue = RC[1];
                            var ThisValue = RC[2];
                            document.getElementById("SundayLogicValue").value = WhichValue;
                            document.getElementById("SundayLogicValueValue").value = ThisValue;
                        }

                        if (CheckSRow == "POLHOURS") {
                            var CheckRRow = cells[2];

                            var row = datatable.insertRow(-1);

                            if (CheckRRow == "H1") {
                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        if (!PolHoursCol.includes(j)) {
                                            continue
                                        }

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];

                                        cell.style.backgroundColor = "white";
                                        cell.style.color = "#066d95";
                                        cell.style.textAlign = "left";
                                        cell.style.letterSpacing = "0px";
                                        cell.style.fontWeight = "600";
                                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                        cell.style.position = "sticky";
                                        cell.style.zIndex = "22";
                                        cell.style.top = "0px";
                                        cell.style.fontSize = "12px";
                                        cell.style.fontFamily = "Calibri";
                                        cell.style.textAlign = "center";

                                    }
                                }
                            } else {

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        if (!PolHoursCol.includes(j)) {
                                            continue
                                        }

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.contentEditable = "true";
                                        cell.style.textAlign = "center";
                                    }
                                }

                            }
                        }

                        if (CheckSRow == "CONDITIONALLOFFVMS") {
                            var CheckRRow = cells[2];

                            var row = datatableConditionAllOffVMs.insertRow(-1);

                            if (CheckRRow == "Session Host") {
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];



                            }
                        }

                        if (CheckSRow == "CONDITIONALLONVMS") {
                            var CheckRRow = cells[2];

                            var row = datatableConditionAllOnVMs.insertRow(-1);

                            if (CheckRRow == "Session Host") {
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];



                            }
                        }

                        if (CheckSRow == "CONDITIONSCALEOUTVMS") {
                            var CheckRRow = cells[2];

                            var row = datatableConditionZEROOneVMs.insertRow(-1);

                            if (CheckRRow == "Session Host") {
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];



                            }
                        }

                        if (CheckSRow == "CONDITIONSCALEINVMS") {
                            var CheckRRow = cells[2];

                            var row = datatableConditionZEROTwoVMs.insertRow(-1);

                            if (CheckRRow == "Session Host") {
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];



                            }
                        }

                        var dtable = document.getElementById("HourlyValueDiv");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatable);

                        var dtable = document.getElementById("ConditionALLOFFSIX");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatableConditionAllOffVMs);

                        var dtable = document.getElementById("ConditionALLONFIVE");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatableConditionAllOnVMs);

                        var dtable = document.getElementById("ConditionZEROTEN");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatableConditionZEROOneVMs);

                        var dtable = document.getElementById("ConditionZEROETEEN");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatableConditionZEROTwoVMs);


                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

    });


    $("#CreateNewPolicyButtonN").click(function(e) {

        var ThisPolName = document.getElementById("PolUniqueNameN").value;
        var PolTenant = document.getElementById("AllPoliciiesTenList").value;
        var PolHostPool = document.getElementById("AllPoliciesTenSelHostPool").value;

        var ProceedOrNot = "Yes"
        if (ThisPolName == null) {
            var ThisMsg = "Please provide input to all values..."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }
            ProceedOrNot = "No"
        }

        if (ProceedOrNot == "Yes") {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Create CloudNova Policy? You can configure Policy values once its created."
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "CREATEPOLICY";
        }

    });

    $("#RefAllPolicyButton").click(function(e) {

        var ProceedOrNot = "Yes";

        if (ProceedOrNot == "Yes") {

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/LoadAllVMPolicies', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        if (data.message == "FileNotFound") {} else {
                            var xLeft = document.getElementById("AllAvaPolicyInPane");
                            var options = document.querySelectorAll('#AllAvaPolicyInPane option');
                            options.forEach(o => o.remove());

                            let res = data.message.replaceAll('"', "");

                            var rows = res.split("\n");
                            for (var i = 0; i < rows.length; i++) {
                                var cells = rows[i].split(",");
                                if (cells.length > 1) {

                                    var CheckCellTwo = cells[1];
                                    if (CheckCellTwo == "POLSETTINGS") {
                                        var optionR = document.createElement("option");
                                        optionR.text = cells[0];
                                        xLeft.add(optionR);
                                    }
                                }
                            }

                        }
                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });
        }

    });



}
// END: POLicy MANAGER PANE

// START: SCRIPT EXECUTION HERE
{

    $("#RefAllScriptHostsNow").click(function(e) {

        var tablenew, rowsnew, i, x, y, shouldSwitch;
        tablenew = document.getElementById("DEPLScriptTableHostTable");
        rowsnew = tablenew.rows;

        var DataTableScriptResult = document.createElement("table");
        DataTableScriptResult.id = 'ScriptResultTableNow'
        DataTableScriptResult.setAttribute('class', 'SummaryTableClassforAzBilling');

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;
        var AppTempName = document.getElementById("DEPLAllScriptTemplatesList").value;

        $.ajax({
            url: '/GetScriptExecutionHostStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisUser': FinalUserNameNow,
                'TRPKey': TRPKey,
                'AppTempName': AppTempName

            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var r = 0; r < rows.length; r++) {
                        var cells = rows[r].split(",");

                        var CheckFRow = cells[0];

                        if (CheckFRow == "HOSTSTATUS") {

                            var ThisAttr = cells[1];
                            var CheckDepStatus = cells[2];

                            if (CheckDepStatus == "Working") {
                                var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'
                            }
                            if (CheckDepStatus == "Executed") {
                                var ThisAttrDepStatus = '<i class="far fa-check-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                            }

                            if (ThisAttr == "Failed") {
                                clearInterval(GlobalScriptExecutionMonitor);
                            }
                            if (ThisAttr == "Executed") {
                                clearInterval(GlobalScriptExecutionMonitor);
                            }

                            for (i = 1; i < (rowsnew.length - 1); i++) {

                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == ThisAttr) {
                                    rowsnew[i].getElementsByTagName("TD")[3].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }

                        if (CheckFRow == "SCRIPTRESULT") {

                            var row = DataTableScriptResult.insertRow(-1);
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];
                        }

                    }

                    var dtable = document.getElementById("DEPLExecuteScriptResultPaneDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(DataTableScriptResult);


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    clearInterval(GlobalScriptExecutionMonitor);
                    document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                    document.getElementById("RefAllTaskRunningListButton").click();

                    document.getElementById("RefAllTaskRunningListButton").click();

                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                clearInterval(GlobalScriptExecutionMonitor);
                document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                document.getElementById("RefAllTaskRunningListButton").click();

                document.getElementById("RefAllTaskRunningListButton").click();

            }
        });


    });

    $("#FetchAllHostsForScriptTemplate").click(function(e) {

        document.getElementById("NotRunningC").style.display = "block";
        document.getElementById("CollectHostsForScriptCircle").style.display = "block";

        var AppTempName = document.getElementById("ScriptTemplateAttributeAndName").innerHTML;
        var res = AppTempName.split(":")
        var FinalAppTempName = res[1];

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CallFetchHostsForScript', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'AppTempName': FinalAppTempName,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    document.getElementById("WhatToGetFromServer").innerHTML = "GETHOSTSFORSCRIPT";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLRefAllScriptTemplates").click(function(e) {

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("DEPLAllScriptTemplatesList");
                    var options = document.querySelectorAll('#DEPLAllScriptTemplatesList option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {
                                    if (CheckTType == "ScriptTemplate") {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLOpenScriptTemplateNow").click(function(e) {

        var SelTempNow = document.getElementById("DEPLAllScriptTemplatesList").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        document.getElementById("ScriptTemplateAttributeAndName").innerHTML = "Script Template Attributes:" + SelTempNow;
        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/DEPLLoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': SelTempNow,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var DataTableScriptResult = document.createElement("table");
                    DataTableScriptResult.id = 'ScriptResultTableNow'
                    DataTableScriptResult.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatable = document.createElement("table");
                    datatable.id = 'DEPLScriptTemplaetTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableAllHosts = document.createElement("table");
                    datatableAllHosts.id = 'DEPLScriptTableHostTable'
                    datatableAllHosts.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckFRow == "APPHOSTS") {

                            document.getElementById("CollectHostsForScriptCircle").style.display = "none";
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();


                            if (CheckFRow == "APPHOSTS") {
                                var row = datatableAllHosts.insertRow(-1);
                                if (CheckSRow == "Session Host") {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[4];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                } else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[4];

                                    FinalServerName = cells[1] + ":" + cells[3];
                                    var ExecuteScriptOnServer = '<button id = ' + FinalServerName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:126px; padding:6px;" onclick="ExecuteScriptOnSingleHostFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Execute Script</button>'

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = ExecuteScriptOnServer;

                                }

                            }



                        } else {


                            var row = datatable.insertRow(-1);

                            if (CheckFRow == "Parameter") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[0];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";
                                cell.style.width = "170px";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";


                            } else {

                                if (cells[0] == "" || cells[0] == null) {} else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    cell.style.background = "#f7f7f7";
                                    cell.style.fontWeight = "500";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.background = "white";

                                }
                            }

                        }

                    }

                    var dtable = document.getElementById("DEPLOpenedTemplateScriptTempAttrDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("DEPLOpenedScriptTemplateAllHostsDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableAllHosts);

                    document.getElementById("RefAllScriptHostsNow").click();

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#DEPLExecuteScriptNowButton").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Execute PowerShell SCript from Selected Script Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "DEPLOYSCRIPTONALLHOSTS";

    });

    function checkHostPoolDeplStatus() {
        // Check Status here and load logs

        document.getElementById("DEPLHosPoolStatusONE").style.display = "block";

        var myTimerHostPoolStatus = setInterval(function() { FuncGetHostPoolDeplStatus() }, 5000);

        function FuncGetHostPoolDeplStatus() {

            var datatable = document.createElement("table");
            datatable.id = 'HostPoolDeplStatusTable'
            datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

            var PoolTemplateName = document.getElementById("DEPLAllAvaPoolTemplates").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            $.ajax({
                url: '/GetHostPoolDeplLog', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'PoolTempName': PoolTemplateName,
                    'ThisUser': FinalUserNameNow
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            var row = datatable.insertRow(-1);

                            var CheckFRow = cells[0];

                            if (CheckFRow == "ENDOFDATA") {

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";
                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                                clearInterval(myTimerHostPoolStatus); // Clear Timer here to ensure it doesn't run once again and then append below data
                                document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                            } else {

                                if (CheckFRow == "Phase-1-Connecting") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "block";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                                }
                                if (CheckFRow == "Phase-2-Deploying") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "block";
                                }

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";

                                        if (cells[1] == "Phase-1-Connecting" || cells[1] == "Phase-2-Deploying") {
                                            cell.style.background = "aliceblue";
                                            cell.style.fontWeight = "700";
                                        }

                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });


        }




    }

    function RemoveAppNowFunction(ThisSessHost) {

        var res = ThisSessHost.split(":");
        var HostNameNow = res[0];
        var HostResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Remove Application from Session Host? " + HostNameNow + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVEAPPFROMHOST";
        document.getElementById("ForMultiStringID").innerHTML = ThisSessHost;

    }

    function ExecuteScriptOnHostFunction(ThisSessHost) {

        var res = ThisSessHost.split(":");
        var HostNameNow = res[0];
        var HostResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Execute Script on Session Host? " + HostNameNow + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "EXECUTESINGLESCRIPT";
        document.getElementById("ForMultiStringID").innerHTML = ThisSessHost;


    }



}
// END: SCRIPT EXECUTION HERE


// START: DEPLOYMENT OF FSLOGIX CONFIG HERE
{

    $("#RefAllFSLogixConfigHostsButton").click(function(e) {

        document.getElementById("DEPLOpenSelFSLogixTemplateButton").click();

    });

    $("#FEtchAllHostsForFSLogixButton").click(function(e) {

        document.getElementById("NotRunningC").style.display = "block";

        var AppTempName = document.getElementById("SELFSLogixTempAttr").innerHTML;
        var res = AppTempName.split(":")
        var FinalAppTempName = res[1];

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CallFetchHostsForFSLogix', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'AppTempName': FinalAppTempName,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {



                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLFSLogixRefTemplatesButton").click(function(e) {

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("DEPLAllFSLogixTemplatesList");
                    var options = document.querySelectorAll('#DEPLAllFSLogixTemplatesList option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {
                                    if (CheckTType == "FSLogixTemplate") {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLOpenSelFSLogixTemplateButton").click(function(e) {

        var SelTempNow = document.getElementById("DEPLAllFSLogixTemplatesList").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        document.getElementById("SELFSLogixTempAttr").innerHTML = "FSLogix Template Attributes:" + SelTempNow;

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/DEPLLoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': SelTempNow,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'DeplFSLogixTmpAttTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableAllHosts = document.createElement("table");
                    datatableAllHosts.id = 'DeplFSLogixAttrTableAllHostsTable'
                    datatableAllHosts.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckFRow == "APPHOSTS") {


                            var row = datatableAllHosts.insertRow(-1);
                            if (CheckSRow == "Session Host") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[5];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[5];

                                FinalServerName = cells[1] + ":" + cells[3];
                                var ExecuteScriptNow = '<button id = ' + FinalServerName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:100px; padding:6px;" onclick="ExecuteScriptOnHostFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Deploy Config</button>'

                                var cell = row.insertCell(-1);
                                cell.innerHTML = ExecuteScriptNow;

                            }

                        } else {


                            var row = datatable.insertRow(-1);

                            if (CheckFRow == "Parameter") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[0];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";
                                cell.style.width = "170px";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";


                            } else {

                                if (cells[0] == "" || cells[0] == null) {} else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    cell.style.background = "#f7f7f7";
                                    cell.style.fontWeight = "500";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.background = "white";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.background = "white";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];
                                    cell.style.background = "white";

                                }
                            }

                        }

                    }

                    var dtable = document.getElementById("DEPLOpenedFSLogixTempAttrDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("DEPLFSLogixTempAttrHostDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableAllHosts);


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#DEPLImageDeplNowN").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to start the deployment of Application from Selected Application Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "DEPLOYHOSTPOOL";

    });

    function checkHostPoolDeplStatus() {
        // Check Status here and load logs

        document.getElementById("DEPLHosPoolStatusONE").style.display = "block";

        var myTimerHostPoolStatus = setInterval(function() { FuncGetHostPoolDeplStatus() }, 5000);

        function FuncGetHostPoolDeplStatus() {

            var datatable = document.createElement("table");
            datatable.id = 'HostPoolDeplStatusTable'
            datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

            var PoolTemplateName = document.getElementById("DEPLAllAvaPoolTemplates").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            $.ajax({
                url: '/GetHostPoolDeplLog', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'PoolTempName': PoolTemplateName,
                    'ThisUser': FinalUserNameNow
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            var row = datatable.insertRow(-1);

                            var CheckFRow = cells[0];

                            if (CheckFRow == "ENDOFDATA") {

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";
                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                                clearInterval(myTimerHostPoolStatus); // Clear Timer here to ensure it doesn't run once again and then append below data
                                document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                            } else {

                                if (CheckFRow == "Phase-1-Connecting") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "block";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                                }
                                if (CheckFRow == "Phase-2-Deploying") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "block";
                                }

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";

                                        if (cells[1] == "Phase-1-Connecting" || cells[1] == "Phase-2-Deploying") {
                                            cell.style.background = "aliceblue";
                                            cell.style.fontWeight = "700";
                                        }

                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });


        }
    }

    function RemoveAppNowFunction(ThisSessHost) {

        var res = ThisSessHost.split(":");
        var HostNameNow = res[0];
        var HostResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Remove Application from Session Host? " + HostNameNow + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVEAPPFROMHOST";
        document.getElementById("ForMultiStringID").innerHTML = ThisSessHost;

    }

    function ExecuteScriptOnSingleHostFunction(ThisSessHost) {

        var res = ThisSessHost.split(":");
        var HostNameNow = res[0];
        var HostResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Execute Script On Session Host? " + HostNameNow + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "EXECUTESCRIPTONSINGLEHOST";
        document.getElementById("ForMultiStringID").innerHTML = ThisSessHost;

    }




}
// END: DEPLOYMENT OF FSLOGIX CONFIG HERE


// START: DEPLOYMENT OF APPLICATION HERE
{

    $("#FetchAllHostsForAppTemplate").click(function(e) {

        document.getElementById("DEPLOpenSelAppTemplateNow").click();

    });

    $("#FetchAllHostsForAppTemplate").click(function(e) {

        document.getElementById("NotRunningC").style.display = "block";

        var AppTempName = document.getElementById("SelImageDEPLTempNameN").innerHTML;
        var res = AppTempName.split(":")
        var FinalAppTempName = res[1];

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CallFetchHostsForApp', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'AppTempName': FinalAppTempName,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {



                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLAppTemplateRefAll").click(function(e) {

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("DEPLAllAppTemplatesHere");
                    var options = document.querySelectorAll('#DEPLAllAppTemplatesHere option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {
                                    if (CheckTType == "AppTemplate") {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLOpenSelAppTemplateNow").click(function(e) {

        var SelTempNow = document.getElementById("DEPLAllAppTemplatesHere").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        document.getElementById("SelImageDEPLTempNameN").innerHTML = "Template Attributes:" + SelTempNow;
        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/DEPLLoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': SelTempNow,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'DeplHostPoolAttrTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableAllHosts = document.createElement("table");
                    datatableAllHosts.id = 'DeplHostPoolAttrTableAllHostsTable'
                    datatableAllHosts.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckFRow == "APPHOSTS") {


                            var row = datatableAllHosts.insertRow(-1);
                            if (CheckSRow == "Session Host") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[5];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[5];

                                FinalServerName = cells[1] + ":" + cells[3];
                                var UnInstallAppButton = '<button id = ' + FinalServerName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:100px; padding:6px;" onclick="RemoveAppNowFunction(id)"><i class="ri-landscape-line" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Remove App</button>'
                                var InstallAppButton = '<button id = ' + FinalServerName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:100px; padding:6px;" onclick="InstallAppNowFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Install App</button>'
                                var VerifyApp = '<button id = ' + FinalServerName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:100px; padding:6px;" onclick="VerifyAppNowFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Verify App</button>'

                                var cell = row.insertCell(-1);
                                cell.innerHTML = UnInstallAppButton;
                                var cell = row.insertCell(-1);
                                cell.innerHTML = InstallAppButton;
                                var cell = row.insertCell(-1);
                                cell.innerHTML = VerifyApp;
                            }

                        } else {


                            var row = datatable.insertRow(-1);

                            if (CheckFRow == "Parameter") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[0];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";
                                cell.style.width = "170px";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";


                            } else {

                                if (cells[0] == "" || cells[0] == null) {} else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    cell.style.background = "#f7f7f7";
                                    cell.style.fontWeight = "500";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.background = "white";

                                }
                            }

                        }

                    }

                    var dtable = document.getElementById("DEPLOpenedTemplateAttrDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("DEPLOpenedTempHostPoolHostsDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableAllHosts);


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#DEPLImageDeplNowN").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to start the deployment of Application from Selected Application Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "DEPLOYHOSTPOOL";

    });

    function checkHostPoolDeplStatus() {
        // Check Status here and load logs

        document.getElementById("DEPLHosPoolStatusONE").style.display = "block";

        var myTimerHostPoolStatus = setInterval(function() { FuncGetHostPoolDeplStatus() }, 5000);

        function FuncGetHostPoolDeplStatus() {

            var datatable = document.createElement("table");
            datatable.id = 'HostPoolDeplStatusTable'
            datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

            var PoolTemplateName = document.getElementById("DEPLAllAvaPoolTemplates").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            $.ajax({
                url: '/GetHostPoolDeplLog', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'PoolTempName': PoolTemplateName,
                    'ThisUser': FinalUserNameNow
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            var row = datatable.insertRow(-1);

                            var CheckFRow = cells[0];

                            if (CheckFRow == "ENDOFDATA") {

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";
                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                                clearInterval(myTimerHostPoolStatus); // Clear Timer here to ensure it doesn't run once again and then append below data
                                document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                            } else {

                                if (CheckFRow == "Phase-1-Connecting") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "block";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                                }
                                if (CheckFRow == "Phase-2-Deploying") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "block";
                                }

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";

                                        if (cells[1] == "Phase-1-Connecting" || cells[1] == "Phase-2-Deploying") {
                                            cell.style.background = "aliceblue";
                                            cell.style.fontWeight = "700";
                                        }

                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });


        }




    }

    function RemoveAppNowFunction(ThisSessHost) {

        var res = ThisSessHost.split(":");
        var HostNameNow = res[0];
        var HostResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Remove Application from Session Host? " + HostNameNow + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVEAPPFROMHOST";
        document.getElementById("ForMultiStringID").innerHTML = ThisSessHost;

    }


    function InstallAppNowFunction(ThisSessHost) {

        var res = ThisSessHost.split(":");
        var HostNameNow = res[0];
        var HostResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Install Application on Session Host? " + HostNameNow + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "INSTALLAPPONHOST";
        document.getElementById("ForMultiStringID").innerHTML = ThisSessHost;


    }

    function VerifyAppNowFunction(ThisSessHost) {


    }


}
// END: DEPLOYMENT OF APPLICATION HERE

// START: IMAGE MANAGER PANE
{


    $("#CaptureVMImageNowButton").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Start Capturing Image from VM?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CAPTUREVMIMAGE";

    });

    $("#CreateStartImageNButton").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Start Creating Master Image? Please note Master Image will be deployed in the Tenant as part of Image Template."
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CREATEMASTERIMAGE";

    });


    $("#RefSelImageTAttrInDiv").click(function(e) {

        var FinalSelTempNow = document.getElementById("AllImageTemplatesFroMD").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/LoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': FinalSelTempNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'SelImageTemplateTableN'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckFRow == "TENIMAGES" || CheckFRow == "LOCATIONS") {

                        } else {

                            var row = datatable.insertRow(-1);
                            if (CheckFRow == "Parameter" || CheckFRow == "Assignment Name") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[0];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";


                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";


                            } else {

                                if (CheckFRow == "" || CheckFRow == null) {

                                } else {


                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    cell.style.background = "#f7f7f7";
                                    cell.style.fontWeight = "500";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.background = "white";
                                    cell.contentEditable = "true";
                                    cell.spellcheck = "false";

                                }

                            }

                        }
                    }

                    var dtable = document.getElementById("SelectedImageTempAttrForMasterImageDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#RemSelectedImageN").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("NotRunningC").style.display = "block";

            document.getElementById("RefRefAllImagesForSelTenCircle").style.display = "block";

            var ThisTen = document.getElementById("AVDImageManagerTenList").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/RefAllSelTenImagesNow', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "IMAGEMANAGERITEMS";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });

    $("#CheckVMandResStatusButton").click(function(e) {

        document.getElementById("TestingVMNameCapturecircle").style.display = "block";

        var ThisTen = document.getElementById("CaptureImageManTenList").value;
        var ThisVMName = document.getElementById("CaptureExistingVMName").value;
        var ThisVMResGroup = document.getElementById("CaptureVMResGroupName").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault()
        $.ajax({
            url: '/CallCaptureImageCheckVMStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisVMName': ThisVMName,
                'ThisVMResGroup': ThisVMResGroup,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    document.getElementById("TestingVMNameCapturecircle").style.display = "none";

                    var ThisData = data.message
                    if (ThisData == "NOTPRESENT") {

                        var ThisMsg = "Error: Please check VM Name and Resource Group."
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            clearInterval(MyTimerFooter);
                        }
                    }


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#SwitchToImageManagerTen").click(function(e) {


        document.getElementById("RefRefAllImagesForSelTenCircle").style.display = "block";

        var SelTen = document.getElementById("AVDImageManagerTenList").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        var ThisTen = document.getElementById("AVDImageManagerTenList").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault()
        $.ajax({
            url: '/CheckTenImageFileStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {
                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("RefRefAllImagesForSelTenCircle").style.display = "none";
                        }
                    } else {
                        FunctionGetTenImagesFileData(data.message)
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("RefAllTaskRunningListButton").click();

                        document.getElementById("RefRefAllImagesForSelTenCircle").style.display = "none";
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });


    function FunctionGetTenImagesFileData(ThisCompleteData) {
        // Check Status here and load logs

        //var InsertC = '<div id="RefAllCircleHAHA" style="width: 80%; display: block; /*! float: right; */ margin-right: 10px; margin-top: 7px;margin: 0;position: absolute;top: 50%;-ms-transform: translateY(-50%);transform: translateY(-50%);transition: translateX(-50%);display: flex;justify-content: center;"><i id="ssss" class="fas fa-circle-notch fa-spin" aria-hidden="true" style="margin-right: 7px;font-size: 50px;color: #13baf1;margin-left: 7px;float: left;text-shadow: none;"></i></div>'
        //document.getElementById("HostsStatusPerPoolResultDiv").innerHTML = InsertC;
        //document.getElementById("AllHostsAttrStatusDIV").innerHTML = InsertC;

        var datatable = document.createElement("table");
        datatable.id = 'AllSelectedTenImagesTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        const PoolCols = [1, 2, 3, 4, 5]

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");

            var CheckFRow = cells[0];
            var CheckSRow = cells[1];

            if (CheckFRow == "ENDOFDATA") {

                if (CheckFRow == "TENIMAGES") {
                    var row = datatable.insertRow(-1);

                    if (CheckSRow == "Image Type") {
                        for (var j = 0; j < cells.length; j++) {
                            var CheckIfBlank = cells[0]
                            if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                if (!PoolCols.includes(j)) {
                                    continue
                                }

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[j];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            }
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = "Attributes";
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.textAlign = "center";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = "Create VM";
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.textAlign = "center";


                    } else {

                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[2];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[3];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[4];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[5];
                            cell.style.width = "300px";

                            var resRC = cells[2].split("/");
                            var FinalImageName = resRC[1];

                            if (FinalImageName == "undefined" || FinalImageName == null || FinalImageName == "") {
                                var IDToAppend = cells[2] + ":" + cells[3] + ":" + cells[5] + ":" + cells[4];
                            } else {
                                var IDToAppend = FinalImageName + ":" + cells[3] + ":" + cells[5] + ":" + cells[4];
                            }

                            var ShowAttrofImage = '<button id = ' + FinalImageName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="ShowSelImageAttrFunction(id)"><i class="ri-landscape-line" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Show Attributes</button>'
                            var RemoveImage = '<button id = ' + FinalImageName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="RemoveImageFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Remove Image</button>'
                            var ExploreVHD = '<button id = ' + FinalImageName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="ExploreVHDFunction(id)"><i class="ri-landscape-line" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Explore VHD</button>'
                            var EditImage = '<button id = ' + IDToAppend + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="EditImageFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Edit Image</button>'

                            var cell = row.insertCell(-1);
                            cell.innerHTML = ShowAttrofImage;

                            //var cell = row.insertCell(-1);
                            //cell.innerHTML = RemoveImage;

                            //var cell = row.insertCell(-1);
                            //cell.innerHTML = ExploreVHD;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = EditImage;
                        }


                    }
                }


                var dtable = document.getElementById("AllImagesForSelctedTenDiv");
                dtable.innerHTML = "";
                dtable.appendChild(datatable);


            } else {



                if (CheckFRow == "TENIMAGES") {
                    var row = datatable.insertRow(-1);

                    if (CheckSRow == "Image Type") {
                        for (var j = 0; j < cells.length; j++) {
                            var CheckIfBlank = cells[0]
                            if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                if (!PoolCols.includes(j)) {
                                    continue
                                }

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[j];

                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            }
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = "Attributes";
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.textAlign = "center";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = "Create VM";
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.textAlign = "center";

                    } else {


                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[2];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[3];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[4];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[5];
                            cell.style.width = "300px";

                            var resRC = cells[2].split("/");
                            var FinalImageName = resRC[1];

                            if (FinalImageName == "undefined" || FinalImageName == null || FinalImageName == "") {
                                var IDToAppend = cells[2] + ":" + cells[3] + ":" + cells[5] + ":" + cells[4];
                            } else {
                                var IDToAppend = FinalImageName + ":" + cells[3] + ":" + cells[5] + ":" + cells[4];
                            }

                            var ShowAttrofImage = '<button id = ' + FinalImageName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="ShowSelImageAttrFunction(id)"><i class="ri-landscape-line" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Show Attributes</button>'
                            var RemoveImage = '<button id = ' + FinalImageName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="RemoveImageFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Remove Image</button>'
                            var ExploreVHD = '<button id = ' + FinalImageName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="ExploreVHDFunction(id)"><i class="ri-landscape-line" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Explore VHD</button>'
                            var EditImage = '<button id = ' + IDToAppend + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; width:143px; padding:10px;" onclick="EditImageFunction(id)"><i class="fas fa-eraser" aria-hidden="true" style="color: #f7933a;margin-right: 5px;"></i>Edit Image</button>'

                            var cell = row.insertCell(-1);
                            cell.innerHTML = ShowAttrofImage;

                            //var cell = row.insertCell(-1);
                            //cell.innerHTML = RemoveImage;

                            //var cell = row.insertCell(-1);
                            //cell.innerHTML = ExploreVHD;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = EditImage;
                        }


                    }
                }


                var dtable = document.getElementById("AllImagesForSelctedTenDiv");
                dtable.innerHTML = "";
                dtable.appendChild(datatable);




            }
        }

    }



    function UpdateGroupSettingsFunction(ThisImageName) {

        var ThisMsg = "This feature is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    }

    function RemoveCurrentGroupFunction(ThisImageName) {

        var ThisMsg = "This feature is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    }

    function PatchCurrentSessionHostFunction(ThisImageName) {

        var ThisMsg = "This feature is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    }

    function UpdatePoolSettingsFunction(ThisImageName) {

        var ThisMsg = "This feature is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    }

    function RemoveImageFunction(ThisImageName) {

        var ThisMsg = "Remove Image is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    }

    function ExploreVHDFunction(ThisImageName) {

        var ThisMsg = "Explore VHD is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    }

    function ExploreVHDFunction(ThisImageName) {

        var ThisMsg = "Explore VHD is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    }

    function ShowSelImageAttrFunction(ThisImageName) {

        document.getElementById("RefCircleForRiskAndComp").style.display = "block";

        document.getElementById("SelectedImageAttrMod").style.display = "block";

        document.getElementById("WhichImageWasSelectedID").innerHTML = "Image: " + ThisImageName;

        var ThisTen = document.getElementById("AVDImageManagerTenList").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var datatable = document.createElement("table");
        datatable.id = 'AllDefAttrTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/GetSelImageAttrFiles', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisLUser': FinalUserNameNow,
                'ThisImageName': ThisImageName,
                'TRPKey': TRPKey
            },
            success: function(data) {

                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(":");

                        var FRowData = cells[0].trim();

                        var row = datatable.insertRow(-1);

                        if (FRowData == "" || FRowData == null) {} else {

                            var FRowData = cells[0].trim();
                            var SRowData = cells[1].trim();

                            var cell = row.insertCell(-1);
                            cell.innerHTML = FRowData;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = SRowData;

                        }

                        var dtable = document.getElementById("SelectedImageImageDefDiv");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatable);

                        document.getElementById("RefCircleForRiskAndComp").style.display = "none";


                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }

            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    }

    $("#CloseImageAttrMod").click(function(e) {

        document.getElementById("SelectedImageAttrMod").style.display = "none";

    });

    $("#CloseCaptureMod").click(function(e) {

        document.getElementById("CaptureVMImageMod").style.display = "none";

    });

    $("#CaptureAnImageButton").click(function(e) {

        document.getElementById("CaptureVMImageMod").style.display = "block";

    });

    $("#CloseCreateMasterImageMod").click(function(e) {

        document.getElementById("CrateMasterImageMod").style.display = "none";

    });
    $("#CreateAMasterImageButton").click(function(e) {

        document.getElementById("CrateMasterImageMod").style.display = "block";
        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("AllImageTemplatesFroMD");
                    var options = document.querySelectorAll('#AllImageTemplatesFroMD option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {
                                    if (CheckTType == "ImageTemplate") {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });



    });

}
// END: IMAGE MANAGER PANE

// START: AVD RISK AND COMPLIANCE
{


    $("#RefRiskAndCompDash").click(function(e) {

        var ProceedOrNot = "Yes"

        if (ProceedOrNot == "No") {

            var ThisMsg = "This feature is not production ready yet...."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }
        }
        if (ProceedOrNot == "Yes") {


            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                document.getElementById("RefCircleForRiskAndComp").style.display = "block";

                var ThisTen = document.getElementById("AVDRiskAndCompTenList").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/RefComplianceItems', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTen': ThisTen,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("WhatToGetFromServer").innerHTML = "GETCOMPANDRISKITEMS";

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

    });

    $("#SwitchToRiskAndCompList").click(function(e) {

        var ProceedOrNot = "Yes"
        if (ProceedOrNot == "No") {


            var ThisMsg = "This feature is not production ready yet...."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }
        }
        if (ProceedOrNot == "Yes") {


            document.getElementById("RefCircleForRiskAndComp").style.display = "block";

            var SelTen = document.getElementById("AVDRiskAndCompTenList").value;
            document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

            var ThisTen = document.getElementById("AVDRiskAndCompTenList").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CheckRiskAndCompStatusFile', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 500000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        if (data.message == "FileNotFound") {
                            if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                                document.getElementById("RefCircleForRiskAndComp").style.display = "none";
                            }
                        } else {

                            GetRiskAndCompStatusData(data.message)
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();

                            document.getElementById("RefCircleForRiskAndComp").style.display = "none";

                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }

    });


    function GetRiskAndCompStatusData(ThisCompleteData) {

        document.getElementById("RefCircleForRiskAndComp").style.display = "block";

        var datatable = document.createElement("table");
        datatable.id = 'SecAndCompVMsAndResTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableIssueItems = document.createElement("table");
        datatableIssueItems.id = 'SecAndCompIssuesTable'
        datatableIssueItems.setAttribute('class', 'SummaryTableClassforAzBilling');

        const PoolCols = [1, 2, 3]
        const HostCols = [1, 2, 3, 4, 5, 6, 7, 8]

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split("#");

            var CheckFRow = cells[0];
            var CheckSRow = cells[1];

            if (CheckFRow == "LASTREFDATE") {

                //document.getElementById("HostLastRefDate").innerHTML = "Last Refresh: " + cells[1];
            }


            if (CheckFRow == "VMANDRES") {
                var row = datatable.insertRow(-1);

                if (CheckSRow == "VM") {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }

                    }
                } else {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            if (!PoolCols.includes(j)) {
                                continue
                            }

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];
                        }

                    }

                }
            }

            if (CheckFRow == "COMPITEMS") {
                var row = datatableIssueItems.insertRow(-1);

                if (CheckSRow == "Type") {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }

                    }
                } else {

                    var TypeNow = cells[1];
                    var ItemNow = cells[2];
                    var ValueNow = cells[3];

                    var CheckIfBlank = cells[0]

                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TypeNow;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = ItemNow;

                        if (ValueNow == "") {
                            var cell = row.insertCell(-1);
                            cell.innerHTML = "NA";
                        } else {
                            var cell = row.insertCell(-1);
                            cell.innerHTML = ValueNow;
                        }

                        var ShowSecItems = '<button id = ' + TypeNow + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;width:110px;" onclick="ShowSecItemsFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Show Items</button>'
                        var cell = row.insertCell(-1);
                        cell.innerHTML = ShowSecItems;


                    }

                }

            }

            if (CheckFRow == "AVDNUMBERS") {

                var TotAVDHosts = cells[1];
                var TotAVDHostsWithOldAgent = cells[2];
                var TotAVDHostsNotPatched = cells[3];

                document.getElementById("SubStatusTextFIVE").innerHTML = TotAVDHosts;
                document.getElementById("SubStatusTextSIX").innerHTML = TotAVDHostsWithOldAgent;
                document.getElementById("SubStatusTextSEVEN").innerHTML = TotAVDHostsNotPatched;

            }

            if (CheckFRow == "COMPNUMBERS") {
                var TotForOne = cells[1];
                var TotForTwo = cells[2];
                var TotForThree = cells[3];
                var TotForFour = cells[4];
                var TotForFive = cells[5];
                var TotForSix = cells[6];
                var TotForSeven = cells[7];

                document.getElementById("SecNumberONE").innerHTML = TotForOne;
                document.getElementById("SecNumberTWO").innerHTML = TotForTwo;
                document.getElementById("SecNumberTHREE").innerHTML = TotForThree;
                document.getElementById("SecNumberFOUR").innerHTML = TotForFour;
                document.getElementById("SecNumberFIVE").innerHTML = TotForFive;
                document.getElementById("SecNumberSIX").innerHTML = TotForSix;
                document.getElementById("SecNumberSEVEN").innerHTML = TotForSeven;

                if (TotForOne == "0") {
                    document.getElementById("SecNumberONE").style.color = "green";
                } else {
                    document.getElementById("SecNumberONE").style.color = "red";
                }

                if (TotForTwo == "0") {
                    document.getElementById("SecNumberTWO").style.color = "green";
                } else {
                    document.getElementById("SecNumberTWO").style.color = "red";
                }

                if (TotForThree == "0") {
                    document.getElementById("SecNumberTHREE").style.color = "green";
                } else {
                    document.getElementById("SecNumberTHREE").style.color = "red";
                }

                if (TotForFour == "0") {
                    document.getElementById("SecNumberFOUR").style.color = "green";
                } else {
                    document.getElementById("SecNumberFOUR").style.color = "red";
                }

                if (TotForFive == "0") {
                    document.getElementById("SecNumberFIVE").style.color = "green";
                } else {
                    document.getElementById("SecNumberFIVE").style.color = "red";
                }

                if (TotForSix == "0") {
                    document.getElementById("SecNumberSIX").style.color = "green";
                } else {
                    document.getElementById("SecNumberSIX").style.color = "red";
                }

                if (TotForSeven == "0") {
                    document.getElementById("SecNumberSEVEN").style.color = "green";
                } else {
                    document.getElementById("SecNumberSEVEN").style.color = "red";
                }


            }

            if (CheckFRow == "SUBSTATUS") {
                var ScoreOne = cells[1];
                var ScoreTwo = cells[2];
                var ScoreThree = cells[3];
                var ScoreFour = cells[4];
                var ScoreFive = cells[5];
                var ScoreSix = cells[6];

                document.getElementById("SubStatusScoreOne").innerHTML = ScoreOne;
                document.getElementById("SubStatusScoreTwo").innerHTML = ScoreTwo;
                document.getElementById("SubStatusScoreThree").innerHTML = ScoreThree;
                document.getElementById("SubStatusScoreFour").innerHTML = ScoreFour;
                document.getElementById("SubStatusScoreFive").innerHTML = ScoreFive;
                document.getElementById("SubStatusScoreSix").innerHTML = ScoreSix;

            }

        }


        var dtable = document.getElementById("AllRiskAndCompVMsandRSGroupDiv");
        dtable.innerHTML = "";
        dtable.appendChild(datatable);

        var dtable = document.getElementById("AllIssuesListedDiv");
        dtable.innerHTML = "";
        dtable.appendChild(datatableIssueItems);


    }






}
// END: AVD RISK AND COMPLIANCE

// START: OPERATIONAL LOGS PANE

{

    $("#OptUserClearLogs").click(function(e) {

        var ThisLog = document.getElementById("SelectedAVDMenu").innerHTML;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to clear Operational Log Activities for User?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CLEAROPTLOG";

    });

    $("#RefOptUsersNNButton").click(function(e) {

        var ProceedOrNot = "Yes";

        var ThisSelNow = document.getElementById("ThisOpenedRBACUsers").innerHTML;
        var res = ThisSelNow.split(":");
        var Value1 = res[0];
        var Value2 = res[1];
        if (Value2 == "" || Value2 == null) {
            ProceedOrNot = "Yes"
        } else {
            ProceedOrNot = "No"
        }

        var TRPKey = document.getElementById("TRPKeyN").value;

        ProceedOrNot = "Yes"
        if (ProceedOrNot == "Yes") {

            $.ajax({
                url: '/LoadRBACUsers', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        var xLeft = document.getElementById("OptUsersListN");
                        var options = document.querySelectorAll('#OptUsersListN option');
                        options.forEach(o => o.remove());

                        let res = data.message.replaceAll('"', "");

                        var rows = res.split("\n");
                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            if (cells.length > 1) {

                                var newcell = cells[0] + ":" + cells[3];
                                var rUName = cells[0];

                                if (rUName == 'UserName') {} else {
                                    if (rUName == "" || rUName == null) {} else {
                                        var optionR = document.createElement("option");
                                        optionR.text = rUName;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }


                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });

    $("#UnCheckAllActionsForOpt").click(function(e) {

        document.getElementById("FILTAction1").checked = false;
        document.getElementById("FILTAction2").checked = false;
        document.getElementById("FILTAction3").checked = false;
        document.getElementById("FILTAction4").checked = false;
        document.getElementById("FILTAction5").checked = false;
        document.getElementById("FILTAction6").checked = false;
        document.getElementById("FILTAction7").checked = false;
        document.getElementById("FILTAction7A").checked = false;
        document.getElementById("FILTAction8").checked = false;
        document.getElementById("FILTAction9").checked = false;
        document.getElementById("FILTAction10").checked = false;
        document.getElementById("FILTAction11").checked = false;
        document.getElementById("FILTAction12").checked = false;
        document.getElementById("FILTAction13").checked = false;
        document.getElementById("FILTAction14").checked = false;
        document.getElementById("FILTAction15").checked = false;
        document.getElementById("FILTAction16").checked = false;
        document.getElementById("FILTAction17").checked = false;
        document.getElementById("FILTAction18").checked = false;
        document.getElementById("FILTAction19").checked = false;
        document.getElementById("FILTAction20").checked = false;
        document.getElementById("FILTAction21").checked = false;
        document.getElementById("FILTAction22").checked = false;
        document.getElementById("FILTAction23").checked = false;
        document.getElementById("FILTAction24").checked = false;
        document.getElementById("FILTAction25").checked = false;
        document.getElementById("FILTAction26").checked = false;

    });

    $("#CheckAllActionsForOpt").click(function(e) {

        document.getElementById("FILTAction1").checked = true;
        document.getElementById("FILTAction2").checked = true;
        document.getElementById("FILTAction3").checked = true;
        document.getElementById("FILTAction4").checked = true;
        document.getElementById("FILTAction5").checked = true;
        document.getElementById("FILTAction6").checked = true;
        document.getElementById("FILTAction7").checked = true;
        document.getElementById("FILTAction7A").checked = true;
        document.getElementById("FILTAction8").checked = true;
        document.getElementById("FILTAction9").checked = true;
        document.getElementById("FILTAction10").checked = true;
        document.getElementById("FILTAction11").checked = true;
        document.getElementById("FILTAction12").checked = true;
        document.getElementById("FILTAction13").checked = true;
        document.getElementById("FILTAction14").checked = true;
        document.getElementById("FILTAction15").checked = true;
        document.getElementById("FILTAction16").checked = true;
        document.getElementById("FILTAction17").checked = true;
        document.getElementById("FILTAction18").checked = true;
        document.getElementById("FILTAction19").checked = true;
        document.getElementById("FILTAction20").checked = true;
        document.getElementById("FILTAction21").checked = true;
        document.getElementById("FILTAction22").checked = true;
        document.getElementById("FILTAction23").checked = true;
        document.getElementById("FILTAction24").checked = true;
        document.getElementById("FILTAction25").checked = true;
        document.getElementById("FILTAction26").checked = true;

    });


    $("#OpenOptUserToSeeLogs").click(function(e) {

        var ThisMsg = "Collecting Operational Log for User. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var SelUserNow = document.getElementById("OptUsersListN").value;
        document.getElementById("OptUserSelectedNNS").innerHTML = "Tenant :" + SelUserNow;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault()
        $.ajax({
            url: '/CheckUserLogActionFile', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelUserNow': SelUserNow,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileFound") {
                        GetActionLogForSelUserFunction()
                    }
                    if (data.message == "FileNotFound") {
                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    function GetActionLogForSelUserFunction() {
        // Check Status here and load logs

        var TRPKey = document.getElementById("TRPKeyN").value;

        var ThisSelUser = document.getElementById("OptUsersListN").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var datatable = document.createElement("table");
        datatable.id = 'UserActionLogTableN'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        $.ajax({
            url: '/GetUserActionFileData', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisSelUser': ThisSelUser,
                'ThisUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {

                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        var CheckFRow = cells[0];

                        if (CheckFRow == "ENDOFDATA") {

                            if (CheckFRow == "Date") {
                                for (var j = 0; j < cells.length; j++) {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[j];

                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                }
                            } else {

                                var CheckIfBlank = cells[0]

                                if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    if (cells[1] == "Action:Success") {
                                        cell.style.color = "green";
                                        cell.style.fontWeight = "500";
                                    }
                                    if (cells[1] == "Action:Failed") {
                                        cell.style.color = "red";
                                        cell.style.fontWeight = "500";
                                    }

                                    if (cells[1] == "Remove Current Sessionsss") {
                                        cell.style.background = "#bce6ff";
                                        cell.style.color = "#464545";
                                        cell.style.borderRadius = "00px 0px 10px 10px";
                                        cell.style.fontFamily = "Roboto";
                                        cell.style.fontSize = "11px";
                                        cell.style.fontWeight = "500";

                                    }

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];

                                }
                            }

                        } else {

                            if (CheckFRow == "Date") {
                                for (var j = 0; j < cells.length; j++) {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[j];

                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                }
                            } else {

                                var CheckIfBlank = cells[0]

                                if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    if (cells[1] == "Action:Success") {
                                        cell.style.color = "green";
                                        cell.style.fontWeight = "500";
                                    }
                                    if (cells[1] == "Action:Failed") {
                                        cell.style.color = "red";
                                        cell.style.fontWeight = "500";
                                    }

                                    if (cells[1] == "Remove Current Session" || cells[1] == "Logoff Current Session") {
                                        cell.style.background = "#bce6ff";
                                        cell.style.color = "#464545";
                                        cell.style.borderRadius = "00px 0px 10px 10px";
                                        cell.style.fontFamily = "Roboto";
                                        cell.style.fontSize = "11px";
                                        cell.style.fontWeight = "500";

                                    }

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];

                                }
                            }

                        }
                    }

                    var dtable = document.getElementById("OptUserSelectedDataDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    clearInterval(myTimerGetUserActLog); // Clear Timer here to ensure it doesn't run once again and then append below data

                }

            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });




    }



    $("#OptUserExpoLogs").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Export Operational Log Activities for user?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "EXPORTOPTLOG";

        }
    });

}


// END: OPERATIONAL LOGS PANE

// START: PROFILES MANAGER
{

    $("#RefAllAVDImagesDuringC").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {


            document.getElementById("CollectingAVDCreateTempImagesCircle").style.display = "block";





        }
    });

    $("#DeleteSeleProfilesNow").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var ThisMsg = "This feature is not production ready yet!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        }
    });

    $("#ProfilesNowExportAll").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Export Profiles for Selected Tenant and Share?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "EXPORTPROFILESNOW";


        }
    });

    $("#ProfilesNowMarkAllProfs").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var ThisMsg = "This feature is not production ready yet!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }
    });

    $("#ProfilesNowUnMarkAllProfs").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var ThisMsg = "This feature is not production ready yet!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }
    });

    $("#CompactAllProfilesNow").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var ThisMsg = "This feature is not production ready yet!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }
    });

    $("#CompactSelProfilesNow").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var ThisMsg = "This feature is not production ready yet!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }
    });

    $("#ProfilesNowRefAll").click(function(e) {

        document.getElementById("CollectingProfCircleNowS").style.display = "block";
        document.getElementById("NotRunningC").style.display = "block";

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var ProceedOrNot = "Yes"
            if (ProceedOrNot == "Yes") {

                var ThisString = document.getElementById("ProfManagerTenListNH").value;
                var res = ThisString.split(":");
                var ThisProfTen = res[0];
                var ThisTenShare = res[1];

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/RefServerAllProfilesN', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisProfTen': ThisProfTen,
                        'ThisTenShare': ThisTenShare,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("WhatToGetFromServer").innerHTML = "PROFILESREF";

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }

        }
    });

    $("#ProfManaSwitchTenNN").click(function(e) {

        var ProceedOrNot = "Yes"
        if (ProceedOrNot == "Yes") {

            var ThisString = document.getElementById("ProfManagerTenListNH").value;
            var res = ThisString.split(":");
            var ThisProfTen = res[0];
            var ThisTenShare = res[1];

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];
            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CheckServerProfilesFileStatus', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisProfTen': ThisProfTen,
                    'ThisTenShare': ThisTenShare,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        if (data.message == "FileNotFound") {
                            if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                                document.getElementById("CollectingProfCircleNowS").style.display = "none";
                            }
                        } else {
                            GetServerProfilesFunction(data.message)
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingProfCircleNowS").style.display = "none";
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });
        }

    });

    function GetServerProfilesFunction(ThisCompleteData) {
        // Check Status here and load logs


        var datatable = document.createElement("table");
        datatable.id = 'ServerProfilesTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableHandles = document.createElement("table");
        datatableHandles.id = 'ServerProfilesHandlesTable'
        datatableHandles.setAttribute('class', 'SummaryTableClassforAzBilling');

        const PoolCols = [0, 1, 2, 3, 4, 5, 6, 7, 8]

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");
        var TotJoinedVDI = 0;
        var TotNotJoinedVDI = 0;
        var TotProfNotOk = 0;
        var TotProfilesNow = 0;

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");

            var CheckFRow = cells[0];
            var CheckSRow = cells[1];

            if (CheckFRow == "LASTREFDATE") {
                var LastRefDate = cells[1];
                document.getElementById("DashLastRefForTen").innerHTML = "Last Refresh: " + LastRefDate;
            }

            if (CheckFRow == "FILEHANDLES") {
                var row = datatableHandles.insertRow(-1);

                if (CheckSRow == "Client IP") {

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[1];
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "left";
                    cell.style.width = "150px";

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[2];
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "left";
                    cell.style.width = "200px";

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[3];
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "left";
                    cell.style.width = "700px";

                    var cell = row.insertCell(-1);
                    cell.innerHTML = "Handle";
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "left";

                } else {

                    if (cells[0] == "" || cells[0] == null) {} else {

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[1];
                        cell.style.maxWidth = "150px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[2];
                        cell.style.maxWidth = "150px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[3];
                        cell.style.maxWidth = "700px";

                        var ThisString = document.getElementById("ProfManagerTenListNH").value;
                        var nres = ThisString.split(":");
                        var ThisProfTen = nres[0];
                        var ThisTenShare = nres[1];

                        var HandleString = ThisProfTen + ":" + ThisTenShare + ":" + cells[3]

                        var CloseFileHandle = '<button id = ' + HandleString + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:none;" onclick="CloseSingleFileHandleFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Close Handle</button>'

                        var cell = row.insertCell(-1);
                        cell.innerHTML = CloseFileHandle;

                    }

                }

            } else {

                var row = datatable.insertRow(-1);

                if (CheckFRow == "Profile Path") {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }
                    }

                    var cell = row.insertCell(-1);
                    cell.innerHTML = "Compact";
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "center";

                    var cell = row.insertCell(-1);
                    cell.innerHTML = "Delete";
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "center";

                    var cell = row.insertCell(-1);
                    cell.innerHTML = "Refresh Size";
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "center";

                } else {

                    if (cells[0] == "" || cells[0] == null) {} else {

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[0];
                        cell.style.maxWidth = "200px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[1];
                        cell.style.maxWidth = "60px";

                        if (cells[1] == "Not Ok") {
                            cell.style.color = "#e17c22";
                            ++TotProfNotOk
                        }
                        if (cells[1] == "Ok") {
                            cell.style.color = "green";
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[2];
                        cell.style.maxWidth = "100px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[3];
                        cell.style.maxWidth = "100px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[4];
                        cell.style.maxWidth = "100px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[5];
                        cell.style.maxWidth = "100px";

                        if (cells[5] == "Not Joined") {
                            cell.style.color = "#e17c22";
                            ++TotNotJoinedVDI
                        }
                        if (cells[5] == "Joined") {
                            cell.style.color = "green";
                            ++TotJoinedVDI
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[6];
                        cell.style.maxWidth = "100px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[7];
                        cell.style.maxWidth = "100px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[8];
                        cell.style.maxWidth = "100px";

                        var GetHandles = '<button id = ' + cells[0] + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="UpdateSelectedItemSetting(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Get Handles</button>'
                        var CompactProf = '<button id = ' + cells[0] + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="UpdateSelectedItemSetting(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Compact</button>'
                        var DeleteProf = '<button id = ' + cells[0] + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="UpdateSelectedItemSetting(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Delete</button>'
                        var RefSize = '<button id = ' + cells[0] + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="UpdateSelectedItemSetting(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Refresh Size</button>'

                        var cell = row.insertCell(-1);
                        cell.innerHTML = CompactProf;
                        var cell = row.insertCell(-1);
                        cell.innerHTML = DeleteProf;
                        var cell = row.insertCell(-1);
                        cell.innerHTML = RefSize;

                        ++TotProfilesNow
                    }

                }

            }

        }

        var dtable = document.getElementById("LoadedProfilesForSelTenDiv");
        dtable.innerHTML = "";
        dtable.appendChild(datatable);

        var dtable = document.getElementById("LoadedProfileHandlesTableDiv");
        dtable.innerHTML = "";
        dtable.appendChild(datatableHandles);

        document.getElementById("ShowProfilesButtonNowN").click();

        GetAllProfileSizesNowFunction()

        document.getElementById("TotProfilesNowForSelServerAndShare").innerHTML = TotProfilesNow;
        document.getElementById("TotUsersJoinedVDIInProfMan").innerHTML = TotJoinedVDI;
        document.getElementById("TotUsersNotJoinedInProfMan").innerHTML = TotNotJoinedVDI;
        document.getElementById("TotPrifleNotOkInPane").innerHTML = TotProfNotOk;


    }

}


// END: PROFILES MANAGER

// START: PROFILE SERVERS PANE
{

    $("#OpenProfileServerBButton").click(function(e) {

        e.preventDefault()

        var ThisMsg = "This feature is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        var ProceedOrNot = "No"
        if (ProceedOrNot == "Yes") {


            var ThisMsg = "Opening Profile Server. Please Wait..."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";

            var SelProfServer = document.getElementById("ProfileTenList").value;
            document.getElementById("SelProfServerNN").innerHTML = "Server :" + SelProfServer;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CheckProfileDashFile', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'SelProfServer': SelProfServer,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        if (data.message == "FileFound") {
                            GetProfileShareDashItemsFunction()
                        }
                        if (data.message == "FileNotFound") {
                            document.getElementById("ProfileRefProfileDashboard").click();
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        }
    });

    function GetProfileShareDashItemsFunction() {
        // Check Status here and load logs

        //document.getElementById("RefDASHSTOPCIRCLE").style.display = "block";

        var myTimerProfileItems = setInterval(function() { FuncGetProfileDashItemsN() }, 1000);

        function FuncGetProfileDashItemsN() {

            var datatable = document.createElement("table");
            datatable.id = 'ProfileAccessStatusTable'
            datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

            var datatableB = document.createElement("table");
            datatableB.id = 'LastWeekTableProfileSizes'
            datatableB.setAttribute('class', 'SummaryTableClassforAzBilling');

            var datatableSize = document.createElement("table");
            datatableSize.id = 'ProfileLargeTable'
            datatableSize.setAttribute('class', 'SummaryTableClassforAzBilling');

            var SelProfServer = document.getElementById("ProfileTenList").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            var rRequest = $.ajax({
                url: '/GetProfileDashItemFileN', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'SelProfServer': SelProfServer,
                    'ThisUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");

                            var CheckFRow = cells[0];

                            if (CheckFRow == "ENDOFDATA") {

                                if (CheckFRow == "LASTWEEK") {

                                    var row = datatable.insertRow(-1);

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                }
                                if (CheckFRow == "LASTWEEKS") {

                                    var row = datatableB.insertRow(-1);

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                }
                                if (CheckFRow == "LARGEPROFILE") {

                                    var row = datatableSize.insertRow(-1);

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                }

                                clearInterval(myTimerProfileItems); // Clear Timer here to ensure it doesn't run once again and then append below data                                                                

                            } else {

                                if (CheckFRow == "LASTWEEK") {

                                    var row = datatable.insertRow(-1);

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                }
                                if (CheckFRow == "LASTWEEKS") {

                                    var row = datatableB.insertRow(-1);

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                }
                                if (CheckFRow == "LARGEPROFILE") {

                                    var row = datatableSize.insertRow(-1);

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                }

                            }

                        }

                        var dtable = document.getElementById("ProfileLastWeekData");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatable);

                        var dtable = document.getElementById("ProfileLastWeekDataSIZES");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatableB);

                        var dtable = document.getElementById("ServerLargeProfilesData");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatableSize);

                        FuncGenLastAccessChart()
                        FuncGenLargeProfilesChart()

                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        rRequest.abort();
                        clearInterval(myTimerDashItemsStatusRef); // Clear Timer here to ensure it doesn't run once again and then append below data

                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    //rRequest.abort();
                    clearInterval(myTimerDashItemsStatusRef); // Clear Timer here to ensure it doesn't run once again and then append below data
                    document.getElementById("RefDASHSTOPCIRCLE").style.display = "none";


                }
            });

        }
    }


    function FuncGenLastAccessChart() {

        document.getElementById("ProfileLastWeekChart").style.display = "block";
        document.getElementById("ProfileLastWeekData").style.display = "none";

        Highcharts.chart('ProfileLastWeekChart', {
            data: {
                table: 'ProfileAccessStatusTable',
                startColumn: 0,
                endColumn: 1
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Number Of Profiles'
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });


        document.getElementById("ProfileLastWeekChartSIZES").style.display = "block";
        document.getElementById("ProfileLastWeekDataSIZES").style.display = "none";

        Highcharts.chart('ProfileLastWeekChartSIZES', {
            data: {
                table: 'LastWeekTableProfileSizes',
                startColumn: 0,
                endColumn: 1
            },
            chart: {
                type: 'pie'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Sizes'
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });

    }

    function FuncGenLargeProfilesChart() {

        document.getElementById("ServerLargeProfilesChart").style.display = "block";
        document.getElementById("ServerLargeProfilesData").style.display = "none";

        Highcharts.chart('ServerLargeProfilesChart', {
            data: {
                table: 'ProfileLargeTable',
                startColumn: 0,
                endColumn: 1
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Profiles'
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });

    }

    $("#CloseAddProfileServerModal").click(function(e) {
        document.getElementById("ProfileServerAddModal").style.display = "none";
    });

    $("#AddProfileServerButton").click(function(e) {
        document.getElementById("ProfileServerAddModal").style.display = "block";

    });

    $("#AddNewProfileServerNow").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Add Profile Share under the management of CloudNovaDesk?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ADDPROFILESERVER";

    });

    $("#RefListOfServersInProfMan").click(function(e) {

        var ProceedOrNot = "Yes"
        if (ProceedOrNot == "Yes") {

            var TRPKey = document.getElementById("TRPKeyN").value;

            e.preventDefault()
            $.ajax({
                url: '/LoadProfileServers', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        var xLeft = document.getElementById("ProfManagerTenListNH");
                        var options = document.querySelectorAll('#ProfManagerTenListNH option');
                        options.forEach(o => o.remove());

                        let res = data.message.replaceAll('"', "");

                        var rows = res.split("\n");
                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            if (cells.length > 1) {

                                var newcell = cells[3] + ":" + cells[2];
                                var rUName = cells[0];

                                if (rUName == 'ResGroup') {} else {
                                    if (rUName == "" || rUName == null) {} else {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }


                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }

    });




}

// END: PROFILE SERVERS PANE

// START: CONFIRM DIA BOX
{

    $("#CancelCancel").click(function(e) {
        document.getElementById("ConfirmDBox").style.display = "none";

        var WhatAction = document.getElementById("ActionDoWhat").innerHTML;

        if (WhatAction == "ENABLEPROACTIVEMON") {
            document.getElementById("EnableProactiveMonitoringCheckBox").checked = false;

        }

    });

    $("#ConfirmYESYES").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "none";

        var WhatAction = document.getElementById("ActionDoWhat").innerHTML;

        if (WhatAction == "SAVENOTANDACTION") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Saving Notifications and Actions Settings for Tenant. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var convertedIntoArray = [];
                $("table#RBACUserTasksTableN tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        convertedIntoArray.push(rowDataArray);
                    }
                });

                var SelTen = document.getElementById("NotAndActionTenList").value;
                var TempData = convertedIntoArray;

                var Not1StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not1NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not2StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not2NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not3StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not3NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not4StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not4NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not5StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not5NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not6StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not6NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not7StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not7NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not8StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not8NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not9StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not9NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var Not10StatusEnabledOrDisabled = document.getElementById("Not1StatusEnabledOrDisabled").style.color.value;
                var Not10NotifyWhenFinalStatus = document.getElementById("NOT1NotifyWhen").value;

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/SaveNotAndTenSettings', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SenTenant': SelTen,
                        'TempData': TempData,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "CLEARCOMPLETED") {

            var TRPKey = document.getElementById("TRPKeyN").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            $.ajax({
                url: '/CallClearTasks', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        document.getElementById("RefAllTaskRunningListButton").click();

                        var ThisMsg = "Completed Tasks were cleared!"
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            clearInterval(MyTimerFooter);
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });
        }

        if (WhatAction == "STOPTASKS") {

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallDismissAllTasks', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        document.getElementById("RefAllTaskRunningListButton").click();

                        var ThisMsg = "All tasks were dismissed!"
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            clearInterval(MyTimerFooter);
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });


        }

        if (WhatAction == "APPLYSCRIPTSET") {

            var OptScriptOrNot = document.getElementById("IsOptScriptOrNot").value;
            var OptiScriptVersion = document.getElementById("OptiScriptVersion").value;
            var ScriptPathForPowerShell = document.getElementById("ScriptPathForPowerShell").value;
            var ScriptRetResOrNot = document.getElementById("ScriptRetResultOrNot").value;

            var table, rows, i, x, y, shouldSwitch;
            table = document.getElementById("TemplateAttrTable");
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {

                x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                if (x == "Is Optimization Script?") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = OptScriptOrNot;
                }
                if (x == "Optimization Version") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = OptiScriptVersion;
                }
                if (x == "PowerShell Script Path") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = ScriptPathForPowerShell;
                }
                if (x == "Script Returns Result?") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = ScriptRetResOrNot;
                }
            }

            var ThisMsg = "Script Settings applied successfully!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }

        if (WhatAction == "APPLYAPPSETTOTEMP") {

            var AppFrndName = document.getElementById("TempAppFrndlyName").value;
            var AppMSIName = document.getElementById("AppMSINameHere").value;
            var AppMSIPath = document.getElementById("AppMSIPathSharedFolder").value;
            var TempFolderOnHost = document.getElementById("TempFolderNameOnHosts").value;


            var table, rows, i, x, y, shouldSwitch;
            table = document.getElementById("TemplateAttrTable");
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {

                x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                if (x == "Application Friendly Name") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = AppFrndName;
                }
                if (x == "Application MSI Name") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = AppMSIName;
                }
                if (x == "Application MSI Path") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = AppMSIPath;
                }
                if (x == "Temp Folder On Session Hosts") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = TempFolderOnHost;
                }

            }

            var ThisMsg = "Application Settings applied successfully!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }

        if (WhatAction == "RESETTOZERO") {

            var table, rows, i, x, y, shouldSwitch;
            table = document.getElementById("PolicyHourlyTable");
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {

                rows[i].getElementsByTagName("TD")[0].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[1].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[2].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[3].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[4].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[5].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[6].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[7].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[8].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[9].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[10].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[11].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[12].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[13].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[14].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[15].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[16].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[17].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[18].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[19].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[20].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[21].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[22].innerHTML = "0";
                rows[i].getElementsByTagName("TD")[23].innerHTML = "0";

            }


        }

        if (WhatAction == "UPDATEEMAILSETTINGS") {

            var EmailTempEmailToATTR = document.getElementById("EmailTempEmailToATTR").value;
            var EmailSTMPServerATTR = document.getElementById("EmailSTMPServerATTR").value;
            var EmailSMTPPortATTR = document.getElementById("EmailSMTPPortATTR").value;
            var EmailUseSSLOrNotATTR = document.getElementById("EmailUseSSLOrNotATTR").value;
            var EmailSenderEmailATTR = document.getElementById("EmailSenderEmailATTR").value;
            var EmailSenderUserNameATTR = document.getElementById("EmailSenderUserNameATTR").value;
            var EmailSenderPasswordATTR = document.getElementById("EmailSenderPasswordATTR").value;

            var table, rows, i, x, y, shouldSwitch;
            table = document.getElementById("TemplateAttrTable");
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {

                x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                if (x == "Email To") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = EmailTempEmailToATTR;
                }
                if (x == "SMTP Server") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = EmailSTMPServerATTR;
                }
                if (x == "SMTP Port") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = EmailSMTPPortATTR;
                }
                if (x == "Use SSL") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = EmailUseSSLOrNotATTR;
                }
                if (x == "Sender Email") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = EmailSenderEmailATTR;
                }
                if (x == "Sender Username") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = EmailSenderUserNameATTR;
                }
                if (x == "Sender Password") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = EmailSenderPasswordATTR;
                }

            }

            var ThisMsg = "Email Settings applied successfully!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }

        if (WhatAction == "APPLYHOSTPOOLSET") {

            var PoolTypeNow = document.getElementById("OPTTempPoolType").value;
            var PoolLocation = document.getElementById("OPTHostPoolAllLocs").value;
            var PoolMech = document.getElementById("OPTHostPoolBalMech").value;
            var PoolSessN = document.getElementById("MaxSessLimitID").value;

            var table, rows, i, x, y, shouldSwitch;
            table = document.getElementById("TemplateAttrTable");
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {

                x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                if (x == "Host Pool Type") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = PoolTypeNow;
                }
                if (x == "Host Pool Location") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = PoolLocation;
                }
                if (x == "Load Balancing Mechanism") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = PoolMech;
                }
                if (x == "Maximum Sessions Limit") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = PoolSessN;
                }

            }

            var ThisMsg = "Host Pool Settings applied successfully!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }


        }

        if (WhatAction == "APPLYIMAGENOW") {

            var ThisImageIDNow = document.getElementById("SelectedImageIDforTenN").innerHTML;

            var table, rows, i, x, y, shouldSwitch;
            table = document.getElementById("TemplateAttrTable");
            rows = table.rows;
            for (i = 0; i < (rows.length); i++) {

                x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                if (x == "Image Source ID") {
                    rows[i].getElementsByTagName("TD")[1].innerHTML = ThisImageIDNow;
                }
            }

            var ThisMsg = "Image was applied successfully!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        }

        if (WhatAction == "SENDTESTEMAIL") {

            var EmailTempEmailToATTR = document.getElementById("EmailTempEmailToATTR").value;
            var EmailSTMPServerATTR = document.getElementById("EmailSTMPServerATTR").value;
            var EmailSMTPPortATTR = document.getElementById("EmailSMTPPortATTR").value;
            var EmailUseSSLOrNotATTR = document.getElementById("EmailUseSSLOrNotATTR").value;
            var EmailSenderEmailATTR = document.getElementById("EmailSenderEmailATTR").value;
            var EmailSenderUserNameATTR = document.getElementById("EmailSenderUserNameATTR").value;
            var EmailSenderPasswordATTR = document.getElementById("EmailSenderPasswordATTR").value;

            if (EmailTempEmailToATTR == null || EmailSTMPServerATTR == null || EmailSMTPPortATTR == null || EmailUseSSLOrNotATTR == null || EmailSenderEmailATTR == null || EmailSenderUserNameATTR == null || EmailSenderPasswordATTR == null) {

                var ThisMsg = "Some Email fields are blank...."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }
            } else {

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];
                var TRPKey = document.getElementById("TRPKeyN").value;

                var ThisMsg = "Sending Test Email...Please check if you have got Test Email..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

                $.ajax({
                    url: '/CallSendTestEmail', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'EmailTempEmailToATTR': EmailTempEmailToATTR,
                        'EmailSTMPServerATTR': EmailSTMPServerATTR,
                        'EmailSMTPPortATTR': EmailSMTPPortATTR,
                        'EmailUseSSLOrNotATTR': EmailUseSSLOrNotATTR,
                        'EmailSenderEmailATTR': EmailSenderEmailATTR,
                        'EmailSenderUserNameATTR': EmailSenderUserNameATTR,
                        'EmailSenderPasswordATTR': EmailSenderPasswordATTR,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {





                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }


        }

        if (WhatAction == "EXECUTESINGLESCRIPT") {

            var ThisAppTemplate = document.getElementById("DEPLAllScriptTemplatesList").value;

            var ThisSessHost = document.getElementById("ForMultiStringID").innerHTML;

            var res = ThisSessHost.split(":");
            var HostNameNow = res[0];
            var HostResGroup = res[1];

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];
            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallSingleHostScriptExecute', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisHost': HostNameNow,
                    'HostResGroup': HostResGroup,
                    'ThisLUser': FinalUserNameNow,
                    'ThisAppTemplate': ThisAppTemplate,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {



                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });



        }

        if (WhatAction == "DEPLOYSCRIPTONALLHOSTS") {

            document.getElementById("NotRunningC").style.display = "block";
            var ThisScriptTemplate = document.getElementById("DEPLAllScriptTemplatesList").value;

            var ThisSessHost = document.getElementById("ForMultiStringID").innerHTML;

            var res = ThisSessHost.split(":");
            var HostNameNow = res[0];
            var HostResGroup = res[1];

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallExecuteScriptAllHosts', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisHost': HostNameNow,
                    'HostResGroup': HostResGroup,
                    'ThisLUser': FinalUserNameNow,
                    'ThisAppTemplate': ThisScriptTemplate,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'

                        var tablenew, rowsnew, i, x, y, shouldSwitch;
                        tablenew = document.getElementById("DEPLScriptTableHostTable");
                        rowsnew = tablenew.rows;
                        for (i = 1; i < (rowsnew.length - 1); i++) {
                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = ThisAttrDepStatus;
                        }

                        MonitorScriptExecutionFunction()

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }

        if (WhatAction == "EXECUTESCRIPTONSINGLEHOST") {

            document.getElementById("NotRunningC").style.display = "block";
            var ThisScriptTemplate = document.getElementById("DEPLAllScriptTemplatesList").value;

            var ThisSessHost = document.getElementById("ForMultiStringID").innerHTML;

            var res = ThisSessHost.split(":");
            var HostNameNow = res[0];
            var HostResGroup = res[1];

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallExecuteScriptSingleHost', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisHost': HostNameNow,
                    'HostResGroup': HostResGroup,
                    'ThisLUser': FinalUserNameNow,
                    'ThisAppTemplate': ThisScriptTemplate,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'

                        var tablenew, rowsnew, i, x, y, shouldSwitch;
                        tablenew = document.getElementById("DEPLScriptTableHostTable");
                        rowsnew = tablenew.rows;
                        for (i = 1; i < (rowsnew.length - 1); i++) {

                            x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                            if (x == HostNameNow) {
                                rowsnew[i].getElementsByTagName("TD")[3].innerHTML = ThisAttrDepStatus;
                            }
                        }

                        MonitorScriptExecutionFunction()

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }

        if (WhatAction == "INSTALLAPPONHOST") {

            var ThisAppTemplate = document.getElementById("DEPLAllAppTemplatesHere").value;

            var ThisSessHost = document.getElementById("ForMultiStringID").innerHTML;

            var res = ThisSessHost.split(":");
            var HostNameNow = res[0];
            var HostResGroup = res[1];

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallInstallAppNow', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisHost': HostNameNow,
                    'HostResGroup': HostResGroup,
                    'ThisLUser': FinalUserNameNow,
                    'ThisAppTemplate': ThisAppTemplate,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {



                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }

        if (WhatAction == "REMOVEAPPFROMHOST") {

            var ThisAppTemplate = document.getElementById("DEPLAllAppTemplatesHere").value;

            var ThisSessHost = document.getElementById("ForMultiStringID").innerHTML;

            var res = ThisSessHost.split(":");
            var HostNameNow = res[0];
            var HostResGroup = res[1];

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallRemoveAppNow', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisHost': HostNameNow,
                    'HostResGroup': HostResGroup,
                    'ThisLUser': FinalUserNameNow,
                    'ThisAppTemplate': ThisAppTemplate,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {



                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });



        }

        if (WhatAction == "REMOVETASKFROMLIST") {
            var TaskStringNow = document.getElementById("ForMultiStringID").innerHTML;

            RemoveTaskFromListNow(TaskStringNow)

        }

        if (WhatAction == "SAVEACTPOLICIES") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Saving Host Pool Settings. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var convertedIntoArrayForActivePolicies = [];
                $("table#AVDActivePoliciesTable tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        convertedIntoArrayForActivePolicies.push(rowDataArray);
                    }
                });

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/CallSaveActivePolicies', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'TempData': convertedIntoArrayForActivePolicies,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }


        if (WhatAction == "RESETACTPOLICIES") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Resetting Active Policies. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/ResetActivePolicies', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ActivePolRefAllPolN").click();
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "REMOVEALLUSERS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Removing All RBAC users. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var SelRBACUser = document.getElementById("AllRBACUsersList").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/CallRemoveRBACUser', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SelRBACUser': SelRBACUser,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                document.getElementById("OpenRBACUserID").click();

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "REMOVERBACUSER") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Removing RBAC user. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var SelRBACUser = document.getElementById("AllRBACUsersList").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/CallRemoveRBACUser', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SelRBACUser': SelRBACUser,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');


                            if (FinalItem == "Success") {

                                document.getElementById("RefAllRBACUsers").click();
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                document.getElementById("OpenRBACUserID").click();
                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "ALLMONITORACTIONS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                //document.getElementById("ForMultiStringID").innerHTML = "KILLPROCESS:" + ThisHost + ":" + ThisAppProcess + ":" + ThisProcessID;

                var ThisUserID = document.getElementById("ForMultiStringID").innerHTML;
                var res = ThisUserID.split(":");
                var FinalMonAction = res[0];
                var FinalHostName = res[1];
                var ThisAppProcess = res[2];
                var ThisProcessID = res[3];

                var ThisTenant = document.getElementById("MONAvaTenList").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallMonitorActionsLogoff', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'FinalHostName': FinalHostName,
                        'ThisUser': FinalUserNameNow,
                        'ThisTenant': ThisTenant,
                        'TRPKey': TRPKey,
                        'FinalMonAction': FinalMonAction,
                        'ThisAppProcess': ThisAppProcess,
                        'ThisProcessID': ThisProcessID
                    },
                    success: function(data) {
                        if (data.message) {

                            let res = data.message.replaceAll('"', "");
                            var rows = res.split("\n");

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

        if (WhatAction == "QUICKCLOSESINGLEHANDLENOW") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var ThisProfTen = document.getElementById("SessManagerAavaTenListN").value;
                var ThisPoolName = document.getElementById("QuickHostPool").innerHTML;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallQuickCloseSingleHandleNow', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisProfTen': ThisProfTen,
                        'ThisPoolName': ThisPoolName,
                        'ThisUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            let res = data.message.replaceAll('"', "");
                            var rows = res.split("\n");

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

        if (WhatAction == "CLOSESINGLEHANDLENOW") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var ThisUserID = document.getElementById("ForMultiStringID").innerHTML;
                var RC = ThisUserID.split(":");
                var ThisProfTen = RC[0];
                var ThisTenShare = RC[1];
                var ThisHandlePath = RC[2];

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallCloseSingleHandleNow', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisProfTen': ThisProfTen,
                        'ThisTenShare': ThisTenShare,
                        'ThisHandlePath': ThisHandlePath,
                        'ThisUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            let res = data.message.replaceAll('"', "");
                            var rows = res.split("\n");

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }



        if (WhatAction == "REMOVEALLTEMPLATES") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Removing All Templates. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/CallRemoveAllTemplates', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                document.getElementById("RefAllTemplatesID").click();

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "REMOVECURRENTTEMPLATE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Removing Current Template. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var SelTempNow = document.getElementById("AllAvaTempltesOpt").value;
                var res = SelTempNow.split(":");
                var FinalSelTempNow = res[0];
                var FinalTypeNow = res[1];

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/CallRemoveCurrentTemplate', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SelCurTemplate': FinalSelTempNow,
                        'TemplateType': FinalTypeNow,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                document.getElementById("OpenRBACUserID").click();

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "RESETTASK") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Resetting Tasks for user. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var SelRBACUser = document.getElementById("AllRBACUsersList").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/ResetRBACTasksSettings', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SelRBACUser': SelRBACUser,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                document.getElementById("OpenRBACUserID").click();

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "SAVETASK") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Saving Tasks for user. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var convertedIntoArray = [];
                $("table#RBACUserTasksTableN tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        convertedIntoArray.push(rowDataArray);
                    }
                });

                var convertedIntoArrayForPools = [];
                $("table#RBACUserTasksTableForTenAndPoolN tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        convertedIntoArrayForPools.push(rowDataArray);
                    }
                });

                var SelRBACUser = document.getElementById("AllRBACUsersList").value;
                var TempData = convertedIntoArray;
                var PoolAndTenData = convertedIntoArrayForPools;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/SaveRBACTasksSettings', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SelRBACUser': SelRBACUser,
                        'TempData': TempData,
                        'PoolAndTenData': PoolAndTenData,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "STARTPOLICYAGENT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var WhatToDoNow = "STARTPOLICYAGENT"
                CallAgentOptScript(WhatToDoNow)

                var ThisMsg = "Starting Policy Agent. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }

        if (WhatAction == "STOPPOLICYAGENT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var WhatToDoNow = "STOPPOLICYAGENT"
                CallAgentOptScript(WhatToDoNow)

                var ThisMsg = "Stopping Policy Agent. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }

        if (WhatAction == "STARTNOTIFYAGENT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var WhatToDoNow = "STARTNOTIFYAGENT"
                CallAgentOptScript(WhatToDoNow)

                var ThisMsg = "Starting Notification Agent. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }

        if (WhatAction == "STOPNOTIFYAGENT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var WhatToDoNow = "STOPNOTIFYAGENT"
                CallAgentOptScript(WhatToDoNow)

                var ThisMsg = "Stopping Notification Agent. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }

        if (WhatAction == "STOPCOSTAGENT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var WhatToDoNow = "STOPCOSTAGENT"
                CallAgentOptScript(WhatToDoNow)

                var ThisMsg = "Stopping Cost Analyzer Agent. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }

        if (WhatAction == "STARTCOSTAGENT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var WhatToDoNow = "STARTCOSTAGENT"
                CallAgentOptScript(WhatToDoNow)

                var ThisMsg = "Starting Cost Analyzer Agent. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }


        if (WhatAction == "REMOVEALLSTALE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var WhatToDoNow = "Remove All Stale Sessions"
                CallLogoffRemoveStaleFunction(WhatToDoNow)

                var ThisMsg = "Removing All Stale Sessions..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }

        if (WhatAction == "REMOVEALLDISCON") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var WhatToDoNow = "Remove All Disconnected Sessions"
                CallLogoffRemoveStaleFunction(WhatToDoNow)

                var ThisMsg = "Removing All Disconnected Sessions..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            }
        }

        if (WhatAction == "LOGOFFALLDISCON") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Task Initiated. Please refresh Sessions Manager in few minutes."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

                document.getElementById("NotRunningC").style.display = "block";

                var WhatToDoNow = "Logging Off All Disconnected Sessions"
                CallLogoffRemoveStaleFunction(WhatToDoNow)

                var ThisMsg = "Logging Off All Disconnected Sessions..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }
            }

        }

        if (WhatAction == "ACTIONSENDMSGTOUSER") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var ThisTenant = document.getElementById("SessManagerAavaTenListN").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var UPNUser = document.getElementById("MSGToUserUPN").innerHTML;
                var HostPoolNow = document.getElementById("MSGToUserPool").innerHTML;
                var MSGToUserRSGroup = document.getElementById("MSGToUserRSGroup").innerHTML;
                var MSGToUserSessID = document.getElementById("MSGToUserSessID").innerHTML;
                var MSGToUserHostName = document.getElementById("MSGToUserHostName").innerHTML;

                var MSGTitleNow = document.getElementById("MSGToUserTitleNOWRT").value;
                var ThisMSGNow = document.getElementById("FinalMSGToUserNTD").value;

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallSendMSGToUser', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'UPNUser': UPNUser,
                        'HostPoolNow': HostPoolNow,
                        'MSGToUserRSGroup': MSGToUserRSGroup,
                        'MSGToUserSessID': MSGToUserSessID,
                        'MSGToUserHostName': MSGToUserHostName,
                        'ThisUser': FinalUserNameNow,
                        'ThisTenant': ThisTenant,
                        'MSGTitleNow': MSGTitleNow,
                        'ThisMSGNow': ThisMSGNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            let res = data.message.replaceAll('"', "");
                            var rows = res.split("\n");

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

        if (WhatAction == "REMOVELOGOFF") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var ThisUserID = document.getElementById("ForMultiStringID").innerHTML;
                var res = ThisUserID.split("_");
                var FinalUserIDNow = res[0];
                var FinalActionNow = res[1];
                var FindSessID = res[2];

                var ThisTenant = document.getElementById("SessManagerAavaTenListN").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/SessTakeSingleAction', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisUserID': FinalUserIDNow,
                        'FinalActionNow': FinalActionNow,
                        'ThisUser': FinalUserNameNow,
                        'ThisTenant': ThisTenant,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            if (FinalActionNow == "LOGOFF") {

                                var tablenew, rowsnew, i, x, y, shouldSwitch;
                                tablenew = document.getElementById("SessionManagerTable");
                                rowsnew = tablenew.rows;
                                for (i = 1; i < (rowsnew.length); i++) {

                                    x = rowsnew[i].getElementsByTagName("TD")[3].innerHTML;
                                    if (x == FindSessID) {
                                        rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "LOGGED OFF";
                                        rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                                    }
                                }
                            }
                            if (FinalActionNow == "REMOVE") {

                                var tablenew, rowsnew, i, x, y, shouldSwitch;
                                tablenew = document.getElementById("SessionManagerTable");
                                rowsnew = tablenew.rows;
                                for (i = 1; i < (rowsnew.length); i++) {

                                    x = rowsnew[i].getElementsByTagName("TD")[3].innerHTML;
                                    if (x == FindSessID) {
                                        // Davit change start
                                        //rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "REMOVED";
                                        //rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                                        if (data.message === "DONE") {
                                            jQuery(rowsnew[i]).remove();
                                        } else {
                                            rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "FAILED TO REMOVE";
                                            rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                                        }
                                        // Davit change ends
                                    }
                                }
                            }

                            let res = data.message.replaceAll('"', "");
                            var rows = res.split("\n");

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

        if (WhatAction == "SHADOWSESSION") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {



            }
        }

        if (WhatAction == "SAVETENDET") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var thisSPNGuid = document.getElementById("EditSPNGUID").value;
                var thisSPNPass = document.getElementById("EditSPNPass").value;
                var ThisSPNSubID = document.getElementById("EditSPNSUBID").value;
                var ThisSPNTenID = document.getElementById("EditSPNTenantID").value;
                var ThisTenWorkspaceID = document.getElementById("EditTenAzWorkspaceID").value;
                var ThisLogWID = document.getElementById("EditTenLogAnaID").value;
                var ThisLogSKey = document.getElementById("EditTenSharedKeyN").value;

                var str = document.getElementById("EditTenThisTenSelected").innerHTML;
                var res = str.split(":");
                var TenName = res[1];

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallSaveTenDet', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: true,
                    timeout: 50000,
                    data: {
                        'ThisTenNow': TenName,
                        'ThisSPNGuid': thisSPNGuid,
                        'ThisSPNPass': thisSPNPass,
                        'ThisSPNSubID': ThisSPNSubID,
                        'ThisSPNTenID': ThisSPNTenID,
                        'ThisTenWorkspaceID': ThisTenWorkspaceID,
                        'ThisLogWID': ThisLogWID,
                        'ThisLogSKey': ThisLogSKey,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {

                        document.getElementById("EditDetailsDiv").style.display = "none";

                        document.getElementById("RefAllTenants").click();

                        var ThisMsg = "Tenant details were saved successfully."
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            clearInterval(MyTimerFooter);
                        }


                    },
                    error: function() {
                        alert("Error");
                    }
                });
            }
        }

        if (WhatAction == "ALLHOSTACTIONSNOW") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var ThisHostToAct = document.getElementById("ForMultiStringID").innerHTML;

                var res = ThisHostToAct.split(":");
                var ThisHost = res[0];
                var ThisResGroup = res[1];
                var ThisHostPool = res[2];
                var FinalHostActionNow = res[3];

                var ThisTenant = document.getElementById("HOSTHAvaTenListN").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                var DeleteResOrNotForSingleHost = document.getElementById("SingleHostDelVMResourcesAlso").checked;
                var DeleteResOrNotForAllHosts = document.getElementById("DeleteVMResourcesAsWellCheckBox").checked;
                var DeleteVMResourcesForSelHosts = document.getElementById("DeleteVMResourcesForSelHosts").checked;
                var DeleteHostPoolAfter = document.getElementById("DeleteHostPoolAlsoAfterRemovingHostCheckBox").checked;

                var AllHostsValues = [];
                var table, rows, i, x, y, shouldSwitch;
                table = document.getElementById("SessionHostsStatusTable");
                rows = table.rows;
                for (i = 1; i < (rows.length); i++) {

                    //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
                    x = rows[i].getElementsByTagName("TD")[0].innerHTML;

                    var ThisNow = x.split('"');
                    var ThisIDNow = ThisNow[1];
                    var CheckThisHost = document.getElementById(ThisIDNow).checked;

                    if (CheckThisHost == true) {
                        AllHostsValues.push(ThisIDNow);
                    }
                }

                var FinalHostValuesNow = AllHostsValues.join('\r\n');

                $.ajax({
                    url: '/CallAllHostActionsNow', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTen': ThisTenant,
                        'ThisHostToAct': ThisHost,
                        'ThisResGroup': ThisResGroup,
                        'ThisHostPool': ThisHostPool,
                        'FinalHostActionNow': FinalHostActionNow,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey,
                        'DeleteResOrNotForSingleHost': DeleteResOrNotForSingleHost,
                        'DeleteResOrNotForAllHosts': DeleteResOrNotForAllHosts,
                        'DeleteVMResourcesForSelHosts': DeleteVMResourcesForSelHosts,
                        'AllHostsValues': FinalHostValuesNow,
                        'DeleteHostPoolAfter': DeleteHostPoolAfter
                    },
                    success: function(data) {
                        if (data.message) {

                            if (data.message == "ExecutingHostAction") {

                                var ThisDataS = ThisHost + ":" + ThisResGroup + ":" + ThisHostPool;

                                var Repair = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top:0px;outline:none;" onclick="RepairHostFunction(id)">Repair</button>'
                                var TurnOn = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOnHostFunction(id)"">Turn On</button>'
                                var TurnOff = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOffHostFunction(id)">Turn Off</button>'
                                var PutInDrainMode = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostFalseFunction(id)">Set False</button>'
                                var RemoveFromDrainMode = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostTrueFunction(id)">Set True</button>'

                                if (FinalHostActionNow == "SETFALSE") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length - 1); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                        if (x == ThisHost) {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = "True" + PutInDrainMode;
                                        }
                                    }
                                }
                                if (FinalHostActionNow == "SETTRUE") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                        if (x == ThisHostPool) {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = "False" + RemoveFromDrainMode;
                                        }
                                    }
                                }

                                if (FinalHostActionNow == "TURNONALLHOSTSINPOOL") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[4].innerHTML;
                                        if (x == ThisHostPool) {
                                            rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM running" + TurnOff;
                                            rowsnew[i].getElementsByTagName("TD")[6].style.color = "green";
                                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Available";
                                            rowsnew[i].getElementsByTagName("TD")[3].style.color = "Green";

                                            rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "VM running";
                                            rowsnew[i].getElementsByTagName("TD")[8].style.color = "green";

                                        }
                                    }

                                }
                                if (FinalHostActionNow == "TURNOFFALLHOSTSINPOOL") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[4].innerHTML;
                                        if (x == ThisHostPool) {
                                            rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM deallocated" + TurnOn;
                                            rowsnew[i].getElementsByTagName("TD")[6].style.color = "rgb(249, 99, 25)";

                                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Unavailable";
                                            rowsnew[i].getElementsByTagName("TD")[3].style.color = "rgb(249, 99, 25)";

                                            rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "VM deallocated";
                                            rowsnew[i].getElementsByTagName("TD")[8].style.color = "rgb(249, 99, 25)";

                                        }
                                    }

                                }
                                if (FinalHostActionNow == "REMOVEALLHOSTS") {
                                    var TurnOnHostAttr = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i><span style="color: red;">Removing Host</span>'

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[4].innerHTML;
                                        if (x == ThisHostPool) {
                                            rowsnew[i].getElementsByTagName("TD")[9].innerHTML = TurnOnHostAttr;
                                        }
                                    }
                                }

                                if (FinalHostActionNow == "TURNON") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                        if (x == ThisHost) {
                                            rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM running" + TurnOff;
                                            rowsnew[i].getElementsByTagName("TD")[6].style.color = "green";
                                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Available";
                                            rowsnew[i].getElementsByTagName("TD")[3].style.color = "Green";

                                            rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "VM running";
                                            rowsnew[i].getElementsByTagName("TD")[8].style.color = "green";

                                        }
                                    }
                                }

                                if (FinalHostActionNow == "TURNOFFALLHOSTSINTEN") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                        rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM deallocated" + TurnOn;
                                        rowsnew[i].getElementsByTagName("TD")[6].style.color = "rgb(249, 99, 25)";

                                        rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Unavailable";
                                        rowsnew[i].getElementsByTagName("TD")[3].style.color = "rgb(249, 99, 25)";

                                        rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "VM deallocated";
                                        rowsnew[i].getElementsByTagName("TD")[8].style.color = "rgb(249, 99, 25)";


                                    }
                                }

                                if (FinalHostActionNow == "TURNONSELECTEDHOSTS") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rows[i].getElementsByTagName("TD")[0].innerHTML;

                                        var ThisNow = x.split('"');
                                        var ThisIDNow = ThisNow[1];
                                        var CheckThisHost = document.getElementById(ThisIDNow).checked;

                                        if (CheckThisHost == true) {

                                            x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                            rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM running" + TurnOff;
                                            rowsnew[i].getElementsByTagName("TD")[6].style.color = "green";

                                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Available";
                                            rowsnew[i].getElementsByTagName("TD")[3].style.color = "Green";

                                            rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "VM running";
                                            rowsnew[i].getElementsByTagName("TD")[8].style.color = "green";


                                        }

                                    }
                                }

                                if (FinalHostActionNow == "TURNOFFSELECTEDHOSTS") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rows[i].getElementsByTagName("TD")[0].innerHTML;

                                        var ThisNow = x.split('"');
                                        var ThisIDNow = ThisNow[1];
                                        var CheckThisHost = document.getElementById(ThisIDNow).checked;

                                        if (CheckThisHost == true) {

                                            x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                            rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM deallocated" + TurnOn;
                                            rowsnew[i].getElementsByTagName("TD")[6].style.color = "rgb(249, 99, 25)";

                                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Unavailable";
                                            rowsnew[i].getElementsByTagName("TD")[3].style.color = "rgb(249, 99, 25)";

                                            rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "Unavailable";
                                            rowsnew[i].getElementsByTagName("TD")[8].style.color = "rgb(249, 99, 25)";

                                        }

                                    }
                                }

                                if (FinalHostActionNow == "TURNONALLHOSTSINTEN") {

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                        rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM running" + TurnOff;
                                        rowsnew[i].getElementsByTagName("TD")[6].style.color = "green";

                                        rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Available";
                                        rowsnew[i].getElementsByTagName("TD")[3].style.color = "Green";

                                        rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "VM running";
                                        rowsnew[i].getElementsByTagName("TD")[8].style.color = "Green";


                                    }
                                }

                                if (FinalHostActionNow == "TURNOFF") {
                                    //var TurnOnHostAttr = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i><span style="color: red;">Turning Off</span>'

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                        if (x == ThisHost) {
                                            rowsnew[i].getElementsByTagName("TD")[6].innerHTML = "VM deallocated" + TurnOn;
                                            rowsnew[i].getElementsByTagName("TD")[6].style.color = "rgb(249, 99, 25)";
                                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = "Unavailable";
                                            rowsnew[i].getElementsByTagName("TD")[3].style.color = "rgb(249, 99, 25)";

                                            rowsnew[i].getElementsByTagName("TD")[8].innerHTML = "VM deallocated";
                                            rowsnew[i].getElementsByTagName("TD")[8].style.color = "rgb(249, 99, 25)";

                                        }
                                    }
                                }
                                if (FinalHostActionNow == "REPAIRHOST") {
                                    var TurnOnHostAttr = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: green;font-size:12px; margin-right: 5px;"></i><span style="color: green;">Repairing Host</span>'

                                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                                    tablenew = document.getElementById("SessionHostsStatusTable");
                                    rowsnew = tablenew.rows;
                                    for (i = 1; i < (rowsnew.length); i++) {

                                        x = rowsnew[i].getElementsByTagName("TD")[1].innerHTML;
                                        if (x == ThisHost) {
                                            rowsnew[i].getElementsByTagName("TD")[3].innerHTML = TurnOnHostAttr;
                                        }
                                    }
                                }



                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }

            document.getElementById("RemoveSingleHostMod").style.display = "none";
            document.getElementById("RemoveAllHostsModN").style.display = "none";
            document.getElementById("RemoveSelectedHostsModNow").style.display = "none";

        }

        if (WhatAction == "CREATEPOLICY") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("AddNewRBACUserModal").style.display = "none";

                var ThisMsg = "Creating Policy. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var ThisPolName = document.getElementById("PolUniqueNameN").value;
                var PolTenant = document.getElementById("AllPoliciiesTenList").value;
                var PolHostPool = document.getElementById("AllPoliciesTenSelHostPool").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CreateVMPolicy', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisPolName': ThisPolName,
                        'PolTenant': PolTenant,
                        'PolHostPool': PolHostPool,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("AddNewRBACUserModal").style.display = "none";

                            var ThisMsg = "Policy was created successfully!"
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";
                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                clearInterval(MyTimerFooter);
                            }



                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

                document.getElementById("AddNewPolicyN").style.display = "none";
                document.getElementById("RefAllPolicyButton").click();

            }



        }


        if (WhatAction == "ENABLEPROACTIVEMON") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("MonRefCircleForA").style.display = "none";

                var ThisTen = document.getElementById("MONAvaTenList").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TotColCount = document.getElementById("TotColCountForMon").value;

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallSetDataForHostMonTimer', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTen': ThisTen,
                        'ThisLUser': FinalUserNameNow,
                        'TotColCount': TotColCount,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {



                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

                document.getElementById("MonInProgCircle").style.display = "block";

                var DoWhatWithMonTimer = "EnableNow"
                FunctionEnableDisableMonTimer(DoWhatWithMonTimer)
            }



        }

        if (WhatAction == "CREATERBACUSER") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("AddNewRBACUserModal").style.display = "none";

                var ThisMsg = "Creating RBAC User. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var EntRBACUser = document.getElementById("RBACUserNamefld").value;
                var EntRBACPass = document.getElementById("RBACUserPassNow").value;
                var EntRBACCPass = document.getElementById("RBACUserConfirmPass").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                $.ajax({
                    url: '/CreateRBACUser', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'EntRBACUser': EntRBACUser,
                        'EntRBACPass': EntRBACPass,
                        'EntRBACCPass': EntRBACCPass,
                        'ThisLUser': FinalUserNameNow
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("AddNewRBACUserModal").style.display = "none";

                            var ThisMsg = "RBAC User was added successfully!"
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";
                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                clearInterval(MyTimerFooter);
                            }



                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }



        }

        if (WhatAction == "SAVEPOLSETTINGS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Saving Policy Settings. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var SelPolMode = document.getElementById("SelectedPolPolMode").value;
                var PolStatus = document.getElementById("SelectedPolPolStatus").value;
                var PolTenant = document.getElementById("SelectedPolPolTenant").value;
                var PolHostPool = document.getElementById("SelectedPolPolHostPool").value;
                var PolEmailTemplate = document.getElementById("SelectedPolEmailTemplateN").value;
                var PolMSGTitle = document.getElementById("PolicyMSGTitleN").value;
                var PolMSGToUsers = document.getElementById("MSGHereForUserS").value;
                var WaitBeforeLogoff = document.getElementById("PolicyWaitSecondsBeforeForceLogoff").value;

                //RCTestNEWNNNN,POLSETTINGS,DevS1,WvdManagerTest-HP,Disabled,Audit Mode,Always,Always,NoEmailTemplate,
                var PolSettingsNow = PolTenant + "," + PolHostPool + "," + PolStatus + "," + SelPolMode + ",Always,Always," + PolEmailTemplate + "," + PolMSGTitle + "," + PolMSGToUsers + "," + WaitBeforeLogoff + ",";

                //RCTestNEWNNNN,WEEKLYNUMBER,Monday:Consider Hour Value:0,Tuesday:Consider Hour Value:0,Wednesday:Consider Hour Value:0,Thursday:Consider Hour Value:0,Friday:Consider Hour Value:0,Saturday:Consider Hour Value:0,Sunday:Consider Hour Value:0,
                var MondayValue = "Monday:" + document.getElementById("MondayLogicValue").value + ":" + document.getElementById("MondayLogicValueValue").value;
                var TueValue = "Tuesday:" + document.getElementById("TeusdayLogicValue").value + ":" + document.getElementById("TeusdayLogicValueValue").value;
                var WedValue = "Wednesday:" + document.getElementById("WednedayLogicValue").value + ":" + document.getElementById("WednedayLogicValueValue").value;
                var ThurValue = "Thursday:" + document.getElementById("ThuLogicValue").value + ":" + document.getElementById("ThuLogicValueValue").value;
                var FridayValue = "Friday:" + document.getElementById("FridayLogicValue").value + ":" + document.getElementById("FridayLogicValueValue").value;
                var SaturdayValue = "Saturday:" + document.getElementById("SatLogicValue").value + ":" + document.getElementById("SatLogicValueValue").value;
                var SundayValue = "Sunday:" + document.getElementById("SundayLogicValue").value + ":" + document.getElementById("SundayLogicValueValue").value;

                var WeeklyNumber = MondayValue + "," + TueValue + "," + WedValue + "," + ThurValue + "," + FridayValue + "," + SaturdayValue + "," + SundayValue + ","

                //RCTestNEWNNNN,CONDITIONANUMBER,TurnOnDeallocatedSessionHosts:Yes,ThenDeployNewHostsIfRequired:Yes,ExecuteAScriptAfterTurningOnHosts:No,DeploymentTemplate:NoHostTemplate,ScriptTemplate:NoScriptTemplate,WhenTurnOffSendMSGToUsers:Yes,WhenTurnOffAlwaysTurnOffOneOrTwoSessions:No,

                var SetOne = "TurnOnDeallocatedSessionHosts:" + document.getElementById("ConditionANumberONE").checked;
                var SetTwo = "ThenDeployNewHostsIfRequired:" + document.getElementById("ConditionANumberTWO").checked;
                var SetThree = "ExecuteAScriptAfterTurningOnHosts:" + document.getElementById("ConditionANumberTHREE").checked;
                var SetFour = "DeploymentTemplate:" + document.getElementById("ConditionANumberFOUR").value;
                var SetFive = "ScriptTemplate:" + document.getElementById("ConditionANumberFIVE").value;
                var SetSix = "WhenTurnOffSendMSGToUsers:" + document.getElementById("ConditionANumberSIX").checked;
                var SetSeven = "WhenTurnOffAlwaysTurnOffOneOrTwoSessions:" + document.getElementById("ConditionANumberSEVEN").checked;
                var SetEight = "ExecuteAScriptAfterTurningOff:" + document.getElementById("ConditionANumberTHREEEEXECUTEASCRIPT").checked;
                var SetNine = "TurnOffScriptTemplate:" + document.getElementById("ConditionZERONINESCRIPTTemplate").value;
                var SetTen = "ForceLogoffUsersInNumber:" + document.getElementById("ForceLogoffUsersD").checked;

                var ConditionANumber = SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + "," + SetFive + "," + SetSix + "," + SetSeven + "," + SetEight + "," + SetNine + "," + SetTen + ",";

                var SetOne = "ExecuteAScriptBeforeTurningOff:" + document.getElementById("ConditionALLOFFONE").checked;
                var SetTwo = "SendMSGToUsers:" + document.getElementById("ConditionALLOFFTWO").checked;
                var SetThree = "SendEmailAndVerifyAllOFFRoutine:" + document.getElementById("ConditionALLOFFTHREE").checked;
                var SetFour = "SessionHostExceptionListApplies:" + document.getElementById("ConditionALLOFFFOUR").checked;
                var SetFive = "ScriptTemplate:" + document.getElementById("ConditionALLOFFFIVE").value;
                var SetSix = "ForceLogoffUsersInAllOFF:" + document.getElementById("ForceLogoffUSersTWOInAllOff").checked;

                var ConditionALLOFF = SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + "," + SetFive + "," + SetSix + ",";

                var SetOne = "ExecuteAScriptOnceHostsAreTurnedOn:" + document.getElementById("ConditionALLONONE").checked;
                var SetTwo = "SendEmailAndVerifyAllOnRoutine:" + document.getElementById("ConditionALLONTWO").checked;
                var SetThree = "SessionHostsExceptionListApplies:" + document.getElementById("ConditionALLONTHREE").checked;
                var SetFour = "ScriptTemplate:" + document.getElementById("ConditionALLONFOUR").value;

                var ConditionALLON = SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + "," + SetFive + ",";

                var SetOne = "AverageConnections:" + document.getElementById("ConditionZEROONE").value;
                var SetTwo = "FirstTurnOnDeallocatedHosts:" + document.getElementById("ConditionZEROTWO").checked;
                var SetThree = "ThenDeployNewHosts:" + document.getElementById("ConditionZEROTHREE").checked;
                var SetFour = "ExecuteAScriptOnceHostsAreTurnOn:" + document.getElementById("ConditionZEROFOUR").checked;
                var SetFive = "AlwaysStartDeployExtraHosts:" + document.getElementById("ConditionZEROFIVE").checked;
                var SetSix = "ExtraHostsNumber:" + document.getElementById("ConditionZEROSIX").value;
                var SetSeven = "SessionHostsExceptionListApplies:" + document.getElementById("ConditionZEROSEVEN").checked;
                var SetEight = "DeployTemplate:" + document.getElementById("ConditionZEROEIGHT").value;
                var SetNine = "ScriptTemplate:" + document.getElementById("ConditionZERONINE").value;

                var ConditionZEROScaleOut = SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + "," + SetFive + "," + SetSix + "," + SetSeven + "," + SetEight + "," + SetNine + ",";

                var SetOne = "AverageConnections:" + document.getElementById("ConditionZEROELEVEN").value;
                var SetTwo = "ExecuteScriptBeforeTurninOff:" + document.getElementById("ConditionZEROTWE").checked;
                var SetThree = "SendMesageToUsers:" + document.getElementById("ConditionZEROTHIRTEEN").checked;
                var SetFour = "AlwaysTurnOff12Connections:" + document.getElementById("ConditionZEROFOURTEEN").checked;
                var SetFive = "SessionHostsExceptionListApplies:" + document.getElementById("ConditionZEROFIFTEEN").checked;
                var SetSix = "ScriptTemplate:" + document.getElementById("ConditionZEROSEVENTEEN").value;
                var SetSeven = "KeepMinimumHostsRunning:" + document.getElementById("ConditionZEROFIVEKeepMinimumOrNotCheckBox").checked;
                var SetEight = "MinimumHostsRunningNumber:" + document.getElementById("ConditionZEROSIXMinimumHostsInScalIn").value;
                var SetEight = "ForceLogoffUsersInScalInCond:" + document.getElementById("ForceLogoffUsersInScalInN").checked;

                var ConditionZEROScaleIN = SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + "," + SetFive + "," + SetSix + "," + SetSeven + "," + SetEight + ",";

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var PolicyHourlyTable = [];
                $("table#PolicyHourlyTable tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        PolicyHourlyTable.push(rowDataArray);
                    }
                });

                var ThisPolicyName = document.getElementById("AllAvaPolicyInPane").value;

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallSavePolSettingsNow', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'PolSettingsNow': PolSettingsNow,
                        'WeeklyNumber': WeeklyNumber,
                        'ConditionANumber': ConditionANumber,
                        'ConditionALLOFF': ConditionALLOFF,
                        'ConditionALLON': ConditionALLON,
                        'ConditionZEROScaleOut': ConditionZEROScaleOut,
                        'ConditionZEROScaleIN': ConditionZEROScaleIN,
                        'ThisLUser': FinalUserNameNow,
                        'PolicyHourlyTable': PolicyHourlyTable,
                        'ThisPolicyName': ThisPolicyName,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var ThisMsg = "Policy Settings were saved successfully!"
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";
                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                clearInterval(MyTimerFooter);
                            }



                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }



        }

        if (WhatAction == "ENABLEALLNOTIFICATIONS") {
            document.getElementById("NOTNotificationStatus1").value = "Enabled"
            document.getElementById("NOTNotificationStatus2").value = "Enabled"
            document.getElementById("NOTNotificationStatus3").value = "Enabled"
            document.getElementById("NOTNotificationStatus4").value = "Enabled"
            document.getElementById("NOTNotificationStatus5").value = "Enabled"
            document.getElementById("NOTNotificationStatus6").value = "Enabled"
            document.getElementById("NOTNotificationStatus7").value = "Enabled"
            document.getElementById("NOTNotificationStatus8").value = "Enabled"
            document.getElementById("NOTNotificationStatus9").value = "Enabled"
        }
        if (WhatAction == "DISABLEALLNOTIFICATIONS") {
            document.getElementById("NOTNotificationStatus1").value = "Disabled"
            document.getElementById("NOTNotificationStatus2").value = "Disabled"
            document.getElementById("NOTNotificationStatus3").value = "Disabled"
            document.getElementById("NOTNotificationStatus4").value = "Disabled"
            document.getElementById("NOTNotificationStatus5").value = "Disabled"
            document.getElementById("NOTNotificationStatus6").value = "Disabled"
            document.getElementById("NOTNotificationStatus7").value = "Disabled"
            document.getElementById("NOTNotificationStatus8").value = "Disabled"
            document.getElementById("NOTNotificationStatus9").value = "Disabled"
        }
        if (WhatAction == "DISABLEALLREPORTS") {
            document.getElementById("AVDReportStatus1").value = "Disabled"
            document.getElementById("AVDReportStatus2").value = "Disabled"
            document.getElementById("AVDReportStatus3").value = "Disabled"
            document.getElementById("AVDReportStatus4").value = "Disabled"
            document.getElementById("AVDReportStatus5").value = "Disabled"
            document.getElementById("AVDReportStatus6").value = "Disabled"
            document.getElementById("AVDReportStatus7").value = "Disabled"
            document.getElementById("AVDReportStatus8").value = "Disabled"
        }
        if (WhatAction == "ENABLEALLREPORTS") {
            document.getElementById("AVDReportStatus1").value = "Enabled"
            document.getElementById("AVDReportStatus2").value = "Enabled"
            document.getElementById("AVDReportStatus3").value = "Enabled"
            document.getElementById("AVDReportStatus4").value = "Enabled"
            document.getElementById("AVDReportStatus5").value = "Enabled"
            document.getElementById("AVDReportStatus6").value = "Enabled"
            document.getElementById("AVDReportStatus7").value = "Enabled"
            document.getElementById("AVDReportStatus8").value = "Enabled"
        }

        if (WhatAction == "DISABLEALLACTIONS") {
            document.getElementById("ActionStatus1").value = "Disabled"
            document.getElementById("ActionStatus2").value = "Disabled"
            document.getElementById("ActionStatus3").value = "Disabled"
            document.getElementById("ActionStatus4").value = "Disabled"
            document.getElementById("ActionStatus5").value = "Disabled"
            document.getElementById("ActionStatus6").value = "Disabled"
            document.getElementById("ActionStatus7").value = "Disabled"
            document.getElementById("ActionStatus8").value = "Disabled"
        }
        if (WhatAction == "ENABLEALLACTIONS") {
            document.getElementById("ActionStatus1").value = "Enabled"
            document.getElementById("ActionStatus2").value = "Enabled"
            document.getElementById("ActionStatus3").value = "Enabled"
            document.getElementById("ActionStatus4").value = "Enabled"
            document.getElementById("ActionStatus5").value = "Enabled"
            document.getElementById("ActionStatus6").value = "Enabled"
            document.getElementById("ActionStatus7").value = "Enabled"
            document.getElementById("ActionStatus8").value = "Enabled"
        }



        if (WhatAction == "SAVEALLNOTSETTINGS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Saving Notification Settings. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var ThisTen = document.getElementById("NotAndActionTenList").value;

                var SetOne = document.getElementById("ActionStatus1").value;
                var SetTwo = document.getElementById("ActionNotifyWhen1").value;
                var SetThree = document.getElementById("ActionEmailTemplate1").value;
                var ActionSETOne = ThisTen + ",Force Removal Of Stale Connections From Session Hosts," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("ActionStatus2").value;
                var SetTwo = document.getElementById("ActionNotifyWhen2").value;
                var SetThree = document.getElementById("ActionEmailTemplate2").value;
                var ActionSETTwo = ThisTen + ",Change VM Disk to Standard HDD for Turned Off VMs," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("ActionStatus3").value;
                var SetTwo = document.getElementById("ActionNotifyWhen3").value;
                var SetThree = document.getElementById("ActionEmailTemplate3").value;
                var ActionSETThree = ThisTen + ",UnAssign Users Not Using AVD for more than one week," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("ActionStatus4").value;
                var SetTwo = document.getElementById("ActionNotifyWhen4").value;
                var SetThree = document.getElementById("ActionEmailTemplate4").value;
                var ActionSETFour = ThisTen + ",Delete User Profiles not in use for more than one week," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("ActionStatus5").value;
                var SetTwo = document.getElementById("ActionNotifyWhen5").value;
                var SetThree = document.getElementById("ActionEmailTemplate5").value;
                var ActionSETFive = ThisTen + ",Auto-Repair Broken Session Hosts and Notify," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("ActionStatus4").value;
                var SetTwo = document.getElementById("ActionNotifyWhen6").value;
                var SetThree = document.getElementById("ActionEmailTemplate6").value;
                var ActionSETSix = ThisTen + ",Do Not Allow Connections to Overloaded Session Hosts," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("ActionStatus7").value;
                var SetTwo = document.getElementById("ActionNotifyWhen7").value;
                var SetThree = document.getElementById("ActionEmailTemplate7").value;
                var SetFour = document.getElementById("SelActionAssTemplateForTenS").value;
                var ActionSETSeven = ThisTen + ",Re-Add Missing Assignments from Assignment Template," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var SetOne = document.getElementById("ActionStatus8").value;
                var SetTwo = document.getElementById("ActionNotifyWhen8").value;
                var SetThree = document.getElementById("ActionEmailTemplate8").value;
                var SetFour = document.getElementById("MAxConValjueForSessHost").value;
                var ActionSETEight = ThisTen + ",Limit Connections On Session Hosts," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","


                var SetOne = document.getElementById("NOTNotificationStatus1").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen1").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate1").value;
                var NotificationSETOne = ThisTen + ",Notify PCI Non-Compliant Items," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus2").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen2").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate2").value;
                var NotificationSETTwo = ThisTen + ",Notify If Turned On Session Hosts Are In Drain Mode," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus3").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen3").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate3").value;
                var NotificationSETThree = ThisTen + ",Notify If Turned On Session Hosts Status Is Unavailable," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus4").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen4").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate4").value;
                var NotificationSETFour = ThisTen + ",Notify If Turned On Session Hosts Are Idle," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus5").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen5").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate5").value;
                var NotificationSETFive = ThisTen + ",Notify If Session Hosts Are Overloaded," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus6").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen6").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate6").value;
                var NotificationSETSix = ThisTen + ",Notify If Session Hosts Are Underutilized," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus7").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen7").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate7").value;
                var NotificationSETSeven = ThisTen + ",Notify If Session Hosts Are Not Patched Since 10 Days," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus8").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen8").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate8").value;
                var NotificationSETEight = ThisTen + ",Notify If Extra Session Hosts Are Turned On," + SetOne + "," + SetTwo + "," + SetThree + ","

                var SetOne = document.getElementById("NOTNotificationStatus9").value;
                var SetTwo = document.getElementById("NOTNotificationNotifyWhen9").value;
                var SetThree = document.getElementById("NOTNotificationEmailTemplate9").value;
                var NotificationSETNine = ThisTen + ",Notify If FSLogix Profiles Corruption Occurs," + SetOne + "," + SetTwo + "," + SetThree + ","


                var SetOne = document.getElementById("AVDReportStatus1").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen1").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour1").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate1").value;
                var ReportSETOne = ThisTen + ",Send Sessions Hosts Status Report," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var SetOne = document.getElementById("AVDReportStatus2").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen2").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour2").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate2").value;
                var ReportSETTwo = ThisTen + ",Send PCI and Compliance Report," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var SetOne = document.getElementById("AVDReportStatus3").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen3").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour3").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate3").value;
                var ReportSETThree = ThisTen + ",Send Session Hosts Patching Status Report," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var SetOne = document.getElementById("AVDReportStatus4").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen4").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour4").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate4").value;
                var ReportSETFour = ThisTen + ",Send AVD Joined and Not Joined Users List," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var SetOne = document.getElementById("AVDReportStatus5").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen5").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour5").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate5").value;
                var ReportSETFive = ThisTen + ",Send Hourly Active Sessions List Per Host Pool," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var SetOne = document.getElementById("AVDReportStatus6").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen6").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour6").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate6").value;
                var ReportSETSix = ThisTen + ",Send Hourly Extra Hosts Turned On Vs Hosts Needed List," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var SetOne = document.getElementById("AVDReportStatus7").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen7").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour7").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate7").value;
                var SetFive = document.getElementById("MaxUserProfileSizeToCheck").value;
                var ReportSETSeven = ThisTen + ",Send Large User Profiles," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + "," + SetFive + ","

                var SetOne = document.getElementById("AVDReportStatus8").value;
                var SetTwo = document.getElementById("AVDReportNotifyWhen8").value;
                var SetThree = document.getElementById("AVDReportNotifyWhenHour8").value;
                var SetFour = document.getElementById("AVDReportEmailTemplate8").value;
                var ReportSETEight = ThisTen + ",Send Profiles Not In Use for More Than One Week," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + ","

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/CallSaveAllNotSettings', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ActionSETOne': ActionSETOne,
                        'ActionSETTwo': ActionSETTwo,
                        'ActionSETThree': ActionSETThree,
                        'ActionSETFour': ActionSETFour,
                        'ActionSETFive': ActionSETFive,
                        'ActionSETSix': ActionSETSix,
                        'ActionSETSeven': ActionSETSeven,
                        'ActionSETEight': ActionSETEight,
                        'NotificationSETOne': NotificationSETOne,
                        'NotificationSETTwo': NotificationSETTwo,
                        'NotificationSETThree': NotificationSETThree,
                        'NotificationSETFour': NotificationSETFour,
                        'NotificationSETFive': NotificationSETFive,
                        'NotificationSETSix': NotificationSETSix,
                        'NotificationSETSeven': NotificationSETSeven,
                        'NotificationSETEight': NotificationSETEight,
                        'NotificationSETNine': NotificationSETNine,
                        'ReportSETOne': ReportSETOne,
                        'ReportSETTwo': ReportSETTwo,
                        'ReportSETThree': ReportSETThree,
                        'ReportSETFour': ReportSETFour,
                        'ReportSETFive': ReportSETFive,
                        'ReportSETSix': ReportSETSix,
                        'ReportSETSeven': ReportSETSeven,
                        'ReportSETEight': ReportSETEight,
                        'TRPKey': TRPKey,
                        'ThisTen': ThisTen,
                        'ThisLUser': FinalUserNameNow
                    },
                    success: function(data) {
                        if (data.message) {

                            var ThisMsg = "Notification Settings were saved successfully!"
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";
                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                clearInterval(MyTimerFooter);
                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }



        }

        if (WhatAction == "ADDPROFILESERVER") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ServerResGroup = document.getElementById("ProfileShareResGroupHere").value;
                var ServerStorageAccount = document.getElementById("StorageAccNameHEre").value;
                var ServerShare = document.getElementById("SharedFolderNameN").value;
                var ServerTenant = document.getElementById("SelectProfileServerTenantN").value;
                var StorageSubID = document.getElementById("StorageSubIDNo").value;
                var HostPool = document.getElementById("SelectServerProfileHostPoolHere").value;
                var UniNameNow = document.getElementById("UniProfileServerName").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var ProceedOrNot = "Yes"
                if (ServerResGroup == "" && ServerShare == "" && ServerStorageAccount == "") {
                    var ThisMsg = "Please provide all inputs before adding Profile Server."
                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                    document.getElementById("GettingReadyID").style.display = "none";
                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                    function FunctionFooterDIV() {
                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                        clearInterval(MyTimerFooter);
                    }
                    ProceedOrNot = "No"
                }

                if (ProceedOrNot == "Yes") {

                    var TRPKey = document.getElementById("TRPKeyN").value;

                    $.ajax({
                        url: '/AddProfileServer', // This tells server which Route to use OKAYYYY
                        type: 'POST',
                        async: false,
                        timeout: 50000,
                        data: {
                            'ServerResGroup': ServerResGroup,
                            'ServerStorageAccount': ServerStorageAccount,
                            'ServerShare': ServerShare,
                            'ServerTenant': ServerTenant,
                            'ThisLUser': FinalUserNameNow,
                            'TRPKey': TRPKey,
                            'StorageSubID': StorageSubID,
                            'HostPool': HostPool,
                            'UniNameNow': UniNameNow
                        },
                        success: function(data) {
                            if (data.message) {

                                document.getElementById("ProfileServerAddModal").style.display = "none";

                                if (data.message == "Success") {

                                    document.getElementById("ProfileRefProfileServersButton").click();

                                    var ThisMsg = "Profile Server was added successfully!"
                                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                    document.getElementById("GettingReadyID").style.display = "none";
                                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                    function FunctionFooterDIV() {
                                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                        clearInterval(MyTimerFooter);
                                    }
                                }


                            } else {
                                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            }
                        },
                        error: function() {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    });
                }

            }


        }

        if (WhatAction == "TESTEMAIL") {
            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {


                var NotName = document.getElementById("AllNotificationTemplatesD").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/TestEmailSettings', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisLUser': FinalUserNameNow,
                        'NotName': NotName,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            let res = data.message.replaceAll('"', "");
                            var rows = res.split("\n");

                            if (data.message == "BLANKFLDS") {
                                var ThisMsg = "Please input all Email Fields. Some fields are blank!"
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }

                            }

                            if (data.message == "MAILSENT") {
                                var ThisMsg = "Test email was sent successfully. Please ensure you received the email."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }

                            }

                            if (data.message == "MAILFAILED") {
                                var ThisMsg = "Failed to send email. Please ensure email fields including password are correct."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }

        }
        if (WhatAction == "SAVENOT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Saving Current Notification. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var convertedIntoArray = [];
                $("table#NotEmailSettingsTable tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        convertedIntoArray.push(rowDataArray);
                    }
                });

                var convertedIntoArrayVMList = [];
                $("table#NotSessionHostTable tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        convertedIntoArrayVMList.push(rowDataArray);
                    }
                });

                var SelTempNow = document.getElementById("OpenedNotificationNameN").innerHTML;
                var res = SelTempNow.split(":");
                var FinalSelTempNow = res[1];

                var SelTempNow = document.getElementById("OpenedNotificationTypeN").innerHTML;
                var res = SelTempNow.split(":");
                var FinalNTypeNow = res[1];

                var TempData = convertedIntoArray;
                var TempDataVMList = convertedIntoArrayVMList;

                var NOTSetSelTenant = document.getElementById("NOTSetSelTenant").value;
                var NOTSetSelScope = document.getElementById("NOTSetSelScope").value;
                var NOTSetSelPoolN = document.getElementById("NOTSetSelPoolN").value;
                var SetNOTEnabledOrDisabled = document.getElementById("SetNOTEnabledOrDisabled").value;
                var SETNotNotifyWhen = document.getElementById("SETNotNotifyWhen").value;
                var SETMailerToSendWhen = document.getElementById("SETMailerToSendWhen").value;
                var SelNotNNName = document.getElementById("SelNotNNName").innerHTML;

                e.preventDefault();
                $.ajax({
                    url: '/SaveNotificationSettings', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SelTempNow': FinalSelTempNow,
                        'TempTypeNow': FinalNTypeNow,
                        'NOTSetSelTenant': NOTSetSelTenant,
                        'NOTSetSelScope': NOTSetSelScope,
                        'NOTSetSelPoolN': NOTSetSelPoolN,
                        'SetNOTEnabledOrDisabled': SetNOTEnabledOrDisabled,
                        'SETNotNotifyWhen': SETNotNotifyWhen,
                        'SETMailerToSendWhen': SETMailerToSendWhen,
                        'SelNotNNName': SelNotNNName,
                        'TempData': TempData,
                        'TempDataVMList': TempDataVMList
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                var ThisMsg = "Notification was saved successfully."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }
        if (WhatAction == "CREATENOT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var NotName = document.getElementById("AVDNotifyTempUniqueIDN").value;
                var NotType = document.getElementById("NotifySelNotifyType").value;
                var NotSelType = document.getElementById("NotifySelSupportedType").value;
                var NotifyTenant = document.getElementById("NotifySelToTenant").value;
                var NotifyScope = document.getElementById("NotifySelNotScope").value;
                var NotifySelPool = document.getElementById("NotifySelNotifySelHostPool").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                e.preventDefault();
                $.ajax({
                    url: '/CreateNotification', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'NotName': NotName,
                        'NotType': NotType,
                        'NotSelType': NotSelType,
                        'NotTenant': NotifyTenant,
                        'NotScope': NotifyScope,
                        'NotSelPool': NotifySelPool,
                        'ThisLUser': FinalUserNameNow,
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("AddNewNotificationPanel").style.display = "none";

                                document.getElementById("RefAllNotificationsID").click();

                                var ThisMsg = "Notification was created successfully."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

        if (WhatAction == "UPDATEINFO") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Collecting Sessin Host Attributes for Template. Please wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var SelTempNow = document.getElementById("AllAvaTempltesOpt").value;
                var res = SelTempNow.split(":");
                var FinalSelTempNow = res[0];
                var FinalTypeNow = res[1];

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/FetchHostAttrForTemplate', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'SelTempNow': FinalSelTempNow,
                        'FinalUserNameNow': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }

        }


        if (WhatAction == "UPDATEKPISETTINGS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Saving KPI Settings. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var KPIPoolTenant = document.getElementById("ThisKPISelectedTenNOWN").innerHTML;

                var KPIHostPool = document.getElementById("KPIagentSelHostPoolNow").innerHTML;

                var SetZero = "KPIAgentShare:" + document.getElementById("EnterKPIAgentSharePathHere").value;
                var SetOne = "KPIAgentSettingsOne:" + document.getElementById("KPIAgentSettingsOne").checked;
                var SetTwo = "KPIAgentSettingsTwo:" + document.getElementById("KPIAgentSettingsTwo").checked;
                var SetThree = "KPIAgentSettingsThree:" + document.getElementById("KPIAgentSettingsThree").checked;
                var SetFour = "KPIAgentSettingsFour:" + document.getElementById("KPIAgentSettingsFour").checked;
                var SetFive = "KPIAgentSettingsFive:" + document.getElementById("KPIAgentSettingsFive").checked;
                var SetSix = "KPIAgentSettingsSix:" + document.getElementById("KPIAgentSettingsSix").checked;
                var SetSeven = "KPIAgentSettingsSeven:" + document.getElementById("KPIAgentSettingsSeven").checked;
                var SetEight = "KPIAgentSettingsEight:" + document.getElementById("KPIAgentSettingsEight").checked;
                var SetNine = "KPIAgentUserName:" + document.getElementById("UserNameToAccessShare").value;
                var SetTen = "KPIAgentPassword:" + document.getElementById("PassToAccesShare").value;

                var KPISettingsForPool = KPIHostPool + "," + SetZero + "," + SetOne + "," + SetTwo + "," + SetThree + "," + SetFour + "," + SetFive + "," + SetSix + "," + SetSeven + "," + SetEight + "," + SetNine + "," + SetTen + ",";

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/SaveKPIAgentSettings', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisHostPool': KPIHostPool,
                        'KPISettingsForPool': KPISettingsForPool,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey,
                        'KPIPoolTenant': KPIPoolTenant
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Saved") {

                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                document.getElementById("KPIAgentSettingsPane").style.display = "none";

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }

        }


        if (WhatAction == "SAVETEMPATTR") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var AllOk = "Ok"

                if (AllOk == "Ok") {

                    var ThisMsg = "Saving Current Template. Please Wait..."
                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                    document.getElementById("GettingReadyID").style.display = "none";

                    var convertedIntoArray = [];
                    $("table#TemplateAttrTable tr").each(function() {
                        var rowDataArray = [];
                        var actualData = $(this).find('td');
                        if (actualData.length > 0) {
                            actualData.each(function() {
                                rowDataArray.push($(this).text());
                            });
                            convertedIntoArray.push(rowDataArray);
                        }
                    });

                    var SelTempNow = document.getElementById("AllAvaTempltesOpt").value;
                    var res = SelTempNow.split(":");
                    var FinalSelTempNow = res[0];
                    var FinalTypeNow = res[1];

                    var TempData = convertedIntoArray;

                    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                    var res = ThisLUserNow.split("@");
                    var FinalUserNameNow = res[0];

                    var TRPKey = document.getElementById("TRPKeyN").value;

                    e.preventDefault();
                    $.ajax({
                        url: '/SaveTempSettings', // This tells server which Route to use OKAYYYY
                        type: 'POST',
                        async: false,
                        timeout: 50000,
                        data: {
                            'SelTempNow': FinalSelTempNow,
                            'TempTypeNow': FinalTypeNow,
                            'TempData': TempData,
                            'ThisLUser': FinalUserNameNow,
                            'TRPKey': TRPKey
                        },
                        success: function(data) {
                            if (data.message) {

                                var SItem = data.message.replace(/[\r\n]+/gm, "");
                                var FinalItem = SItem.replaceAll(' ', '');

                                if (FinalItem == "Success") {

                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                                }

                            } else {
                                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            }
                        },
                        error: function() {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    });

                }
            }

        }
        if (WhatAction == "CREATEAVDTEMPLATE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Creating AVD Template. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var AVDUniID = document.getElementById("AVDTempUniIDN").value;
                var AVDTenName = document.getElementById("AVDTempCreateAllTenList").value;
                var AVDBSName = document.getElementById("AVDBUnitName").value;
                var AVDAzureLocation = document.getElementById("AVDAzureLocation").value;
                var AVDPoolName = document.getElementById("AVDHostPoolNameN").value;
                var AVDPoolType = document.getElementById("AVDHostPoolTypeN").value;
                var AVDMaxSess = document.getElementById("AVDMAxSessLimitN").value;
                var AVDBalMechType = document.getElementById("AVDLBMType").value;

                var AVDNumerHosts = document.getElementById("AVDNOSH").value;
                var AVDVMPrefix = document.getElementById("AVDVMPrefix").value;
                var AVDInitNumber = document.getElementById("AVDINTNumberN").value;
                var AVDVMSize = document.getElementById("AVDSelVMSizeN").value;
                var AVDVMDiskType = document.getElementById("AVDVMDiskTypeN").value;
                var AVDVMDomain = document.getElementById("AVDVMDomFQDNN").value;
                var AVDAdminAcc = document.getElementById("AVDDomAdminAccN").value;
                var AVDAdminPass = document.getElementById("AVDDomAdminPassN").value;

                var AVDVMResGroup = document.getElementById("AVDVMResGroupN").value;

                var AVDUseOrCreate = document.getElementById("AVDUseOrCreateVNetOPT").value;
                var AVDvNetName = document.getElementById("AVDvNetNameN").value;
                var AVDvNetAddressSpace = document.getElementById("AVDvNetAddressSpaceN").value;
                var AVDSubnetName = document.getElementById("AVDSubNetNAmeN").value;
                var AVDSubnetAddressSpace = document.getElementById("AVDSubNetAddressSpaceN").value;

                var AVDSessVMImageOptN = document.getElementById("AVDSessVMImageOptN").value;
                var EntImageURIN = document.getElementById("EntImageURIN").value;

                var AVDvNetResGroupName = document.getElementById("AVDVNetResGroupND").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                document.getElementById("CreateNewAVDTempPane").style.display = "none";

                e.preventDefault();
                $.ajax({
                    url: '/CreateAVDTemplate', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'AVDUniID': AVDUniID,
                        'AVDTenName': AVDTenName,
                        'AVDBSName': AVDBSName,
                        'AVDAzureLocation': AVDAzureLocation,
                        'AVDPoolName': AVDPoolName,
                        'AVDPoolType': AVDPoolType,
                        'AVDMaxSess': AVDMaxSess,
                        'AVDBalMechType': AVDBalMechType,
                        'AVDNumberHosts': AVDNumerHosts,
                        'AVDVMPrefix': AVDVMPrefix,
                        'AVDInitNumber': AVDInitNumber,
                        'AVDVMSize': AVDVMSize,
                        'AVDVMDiskType': AVDVMDiskType,
                        'AVDVMDomain': AVDVMDomain,
                        'AVDAdminAcc': AVDAdminAcc,
                        'AVDAdminPass': AVDAdminPass,
                        'AVDUseOrCreate': AVDUseOrCreate,
                        'AVDvNetName': AVDvNetName,
                        'AVDvNetAddressSpace': AVDvNetAddressSpace,
                        'AVDSubnetName': AVDSubnetName,
                        'AVDSubnetAddressSpace': AVDSubnetAddressSpace,
                        'ThisLUser': FinalUserNameNow,
                        'AVDVMResGroup': AVDVMResGroup,
                        'AVDvNetResGroupName': AVDvNetResGroupName,
                        'EntImageURIN': EntImageURIN,
                        'AVDSessVMImageOptN': AVDSessVMImageOptN,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {
                                document.getElementById("RefAllTemplatesID").click();
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }

        }


        if (WhatAction == "PUSHKPIAGENTONSINGLEHOST") {

            document.getElementById("NotRunningC").style.display = "block";

            var ThisTen = document.getElementById("MONAvaTenList").value;
            var ThisSessHost = document.getElementById("SelHostNowInMonT").innerHTML;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallPushKPIAgentOnSingleHost', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisHost': ThisSessHost,
                    'ThisLUser': FinalUserNameNow,
                    'ThisTen': ThisTen,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {


                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }



        if (WhatAction == "CREATEADDHOSTTEMPLATE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Creating Additional Host Template. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                document.getElementById("CreateAddHostTemplateMod").style.display = "none";

                var ThisTempType = "Session Host Template";
                var TempName = document.getElementById("AddHostTemplateUniName").value;

                var ThisString = document.getElementById("AddHostTempForWhichTenant").innerHTML;
                var ThisNow = ThisString.split(':');
                var ThisTenant = ThisNow[1];

                var ThisString = document.getElementById("AddHostTempForWhichHostPool").innerHTML;
                var ThisNow = ThisString.split(':');
                var ThisHostPool = ThisNow[1];

                var TempTenName = ThisTenant
                var TempHostPool = ThisHostPool
                var TempBusinessUnitName = "NO";
                var TempNamingOrNot = "No";

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/CreateTemplate', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTempType': ThisTempType,
                        'TempName': TempName,
                        'TempTenName': TempTenName,
                        'TempHostPool': TempHostPool,
                        'TempBusinessUnitName': TempBusinessUnitName,
                        'TempNamingOrNot': TempNamingOrNot,
                        'ThisUserNow': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {
                                document.getElementById("RefAllTemplatesID").click();

                                var ThisMsg = "Template was created successfully."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });


            }

        }

        if (WhatAction == "CREATETEMPLATE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisMsg = "Creating Template. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                document.getElementById("AddNewTemplateModal").style.display = "none";

                var ThisTempType = document.getElementById("SelTempType").innerHTML;
                var TempName = document.getElementById("TempUniueNameID").value;
                var TempTenName = document.getElementById("TemplateTenAppliesTo").value;
                var TempHostPool = document.getElementById("TemplateHostPoolAppliesTo").value;
                var TempBusinessUnitName = document.getElementById("TempBusinessUnitNameNow").value;
                if (document.getElementById("TempApplyNamingOrNot").checked == true) {
                    var TempNamingOrNot = "Yes";
                } else {
                    var TempNamingOrNot = "No";
                }
                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/CreateTemplate', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTempType': ThisTempType,
                        'TempName': TempName,
                        'TempTenName': TempTenName,
                        'TempHostPool': TempHostPool,
                        'TempBusinessUnitName': TempBusinessUnitName,
                        'TempNamingOrNot': TempNamingOrNot,
                        'ThisUserNow': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {
                                document.getElementById("RefAllTemplatesID").click();

                                var ThisMsg = "Template was created successfully."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }

                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });


            }

        }

        if (WhatAction == "EXPORTOPTLOG") {

            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange;
            var j = 0;
            tab = document.getElementById('UserActionLogTableN'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";
            tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, ""); //remove if u want links in your table
            tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
            tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Data.xls");
            } else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);

        }

        if (WhatAction == "EXPORTAVDINFO") {

            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange;
            var j = 0;
            tab = document.getElementById('AVDInfoTable'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";
            tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, ""); //remove if u want links in your table
            tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
            tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Data.xls");
            } else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);

        }

        if (WhatAction == "CLOSEALLHANDLESACTION") {

            document.getElementById("NotRunningC").style.display = "block";

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ProceedOrNot = "Yes"
                if (ProceedOrNot == "Yes") {

                    var ThisString = document.getElementById("ProfManagerTenListNH").value;
                    var res = ThisString.split(":");
                    var ThisProfTen = res[0];
                    var ThisTenShare = res[1];

                    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                    var res = ThisLUserNow.split("@");
                    var FinalUserNameNow = res[0];

                    var TRPKey = document.getElementById("TRPKeyN").value;

                    $.ajax({
                        url: '/CallCloseAllHandles', // This tells server which Route to use OKAYYYY
                        type: 'POST',
                        async: false,
                        timeout: 50000,
                        data: {
                            'ThisProfTen': ThisProfTen,
                            'ThisTenShare': ThisTenShare,
                            'ThisLUser': FinalUserNameNow,
                            'TRPKey': TRPKey
                        },
                        success: function(data) {
                            if (data.message) {


                            } else {
                                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            }
                        },
                        error: function() {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    });

                }

            }



        }

        if (WhatAction == "EXPORTPCIITEMS") {

            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange;
            var j = 0;
            tab = document.getElementById('SecAndCompIssuesTable'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";
            tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, ""); //remove if u want links in your table
            tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
            tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Data.xls");
            } else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);

        }

        if (WhatAction == "EXPORTASSIGNMENTSNOW") {

            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange;
            var j = 0;
            tab = document.getElementById('AssignmentTable'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";
            tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, ""); //remove if u want links in your table
            tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
            tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Data.xls");
            } else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);

        }

        if (WhatAction == "EXPORTCOSTLOG") {

            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange;
            var j = 0;
            tab = document.getElementById('AVDLogTable'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";
            tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, ""); //remove if u want links in your table
            tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
            tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Data.xls");
            } else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);

        }

        if (WhatAction == "EXPORTPROFILESNOW") {

            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange;
            var j = 0;
            tab = document.getElementById('ServerProfilesTable'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";
            tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, ""); //remove if u want links in your table
            tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
            tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Data.xls");
            } else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);

        }

        if (WhatAction == "EXPORTSESSIONS") {

            var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
            var textRange;
            var j = 0;
            tab = document.getElementById('SessionManagerTable'); // id of table

            for (j = 0; j < tab.rows.length; j++) {
                tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
                //tab_text=tab_text+"</tr>";
            }

            tab_text = tab_text + "</table>";
            tab_text = tab_text.replace(/<A[^>]*>|<\/A>/g, ""); //remove if u want links in your table
            tab_text = tab_text.replace(/<img[^>]*>/gi, ""); // remove if u want images in your table
            tab_text = tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

            var ua = window.navigator.userAgent;
            var msie = ua.indexOf("MSIE ");

            if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) // If Internet Explorer
            {
                txtArea1.document.open("txt/html", "replace");
                txtArea1.document.write(tab_text);
                txtArea1.document.close();
                txtArea1.focus();
                sa = txtArea1.document.execCommand("SaveAs", true, "Data.xls");
            } else //other browser not tested on IE 11
                sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));
            return (sa);

        }

        if (WhatAction == "CLEARCOSTLOGS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisLogName = document.getElementById("SelectedAVDMenu").innerHTML;
                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/ClearAVDLogs', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'LogName': ThisLogName,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("GetAgentLogs").click();

                            var ThisMsg = ThisLogName + " Logs were cleared successfully!"
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";
                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                clearInterval(MyTimerFooter);
                            }


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

        if (WhatAction == "CLEAROPTLOGS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisUserLog = document.getElementById("OptUsersListN").innerHTML;
                var TRPKey = document.getElementById("TRPKeyN").value;

                $.ajax({
                    url: '/ClearOPTLog', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisUserLog': ThisUserLog,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("GetAgentLogs").click();

                            var ThisMsg = ThisLogName + " Operational Logs were cleared successfully!"
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";
                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                clearInterval(MyTimerFooter);
                            }


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }

        if (WhatAction == "SAVEAVDOPT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {


                var ThisMsg = "Saving AVD Options. Please Wait..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";

                var convertedIntoArray = [];
                $("table#AVDOptionsTable tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        convertedIntoArray.push(rowDataArray);
                    }
                });

                var TempData = convertedIntoArray;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];
                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/SaveAVDOptions', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'TempData': TempData,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            if (FinalItem == "Success") {

                                var ThisMsg = "SuperNova AVD Options were saved successfully!"
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }


                            }

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }

        }

        if (WhatAction == "SETAPPPASSWORD") {

            document.getElementById('AppPassScreenCircle').style.display = "block";

            var AppPassNow = document.getElementById('AppPasswordNow').value;
            var ConfirmPassNow = document.getElementById('ConfirmClientPasswordNow').value;

            if (AppPassNow == "" || ConfirmPassNow == "") {

                var ThisMsg = "Please provide All Inputs..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-400px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                // e.preventDefault();
                $.ajax({
                    url: '/CallSetAppPassowrd', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: true,
                    datatype: "JSON",
                    data: {
                        'AppPassNow': AppPassNow,
                        'ConfirmPassNow': ConfirmPassNow
                    },
                    success: function(data) {

                        if (data.message) {

                            document.getElementById("AppPassScreenCircle").style.display = "none";
                            document.getElementById("AppPassSetNow").style.display = "none";

                            var ThisMsg = "Password has been set successfully. Please refresh Page."
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";

                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-400px";
                                clearInterval(MyTimerFooter);
                            }


                        } else {
                            document.getElementById("AppPassScreenCircle").style.display = "none";

                        }
                    },
                    error: function() {
                        document.getElementById("AppPassScreenCircle").style.display = "none";
                    }
                });
            }


        }

        if (WhatAction == "REGISTERAZUREAPP") {

            document.getElementById("LoginToTenantCircleRegisterApp").style.display = "block";

            var FinalClientIDNow = document.getElementById('YourAppClientID').value;
            var FinalSecNow = document.getElementById('YourClientIDSecHere').value;
            var FinalTenIDNow = document.getElementById('YourClientIDTenantIDHere').value;
            var RedirectURI = document.getElementById('EntRedirectURIHere').value;

            if (FinalClientIDNow == "" || FinalSecNow == "" || FinalTenIDNow == "" || RedirectURI == "") {

                document.getElementById("LoginToTenantCircleRegisterApp").style.display = "none";

                var ThisMsg = "Please provide All Inputs..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-400px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                // e.preventDefault();
                $.ajax({
                    url: '/CallRegisterAppID', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: true,
                    datatype: "JSON",
                    data: {
                        'FinalClientIDNow': FinalClientIDNow,
                        'FinalSecNow': FinalSecNow,
                        'FinalTenIDNow': FinalTenIDNow,
                        'RedirectURI': RedirectURI
                    },
                    success: function(data) {

                        if (data.message) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            console.log("Response RECD:" + FinalItem);

                            if (FinalItem == "ALREADY") {

                                document.getElementById("RegisterAppDModBox").style.display = "none";
                                document.getElementById("LoginToTenantCircleRegisterApp").style.display = "none";

                                var ThisMsg = "App Registration is already done..."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";

                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-400px";
                                    clearInterval(MyTimerFooter);
                                }
                            }

                            if (FinalItem == "SUCCESS") {

                                //document.getElementById("RegisterAppDModBox").style.display = "none";
                                document.getElementById("LoginToTenantCircleRegisterApp").style.display = "none";

                                var ThisMsg = "App Registration is successful..."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";

                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-400px";
                                    clearInterval(MyTimerFooter);
                                }
                            }


                            document.getElementById("LoginToTenantCircleRegisterApp").style.display = "none";


                        } else {
                            document.getElementById("LoginToTenantCircleRegisterApp").style.display = "none";

                        }
                    },
                    error: function() {
                        document.getElementById("LoginToTenantCircleRegisterApp").style.display = "none";
                    }
                });
            }


        }


        if (WhatAction == "ADDTENANT") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {


                document.getElementById("AddTenantCircle").style.display = "block";

                var TRPKeyNow = document.getElementById("TRPKeyN").value;
                var TenUName = document.getElementById("fname").value;
                var TenDomName = document.getElementById("TenDomName").value;

                var TenGAUser = document.getElementById("ConUserNameNew").value;
                var TenGAPass = document.getElementById("GlobalPassNow").value;

                var SPNDispName = document.getElementById("SPNDisplayName").value;
                var SPNGUID = document.getElementById("SPNGUID").value;
                var SPNPass = document.getElementById("SPNPass").value;
                var SPNSubID = document.getElementById("SPNSUBID").value;
                var SPNTenID = document.getElementById("SPNTenantID").value;

                var TenAccessUserName = document.getElementById("TenAccUserNameNow").value;
                var TenAccessPass = document.getElementById("TenAccPasswordNow").value;

                var TenAccessUserName = "NotNeeded"
                var TenAccessPass = "NotNeeded"

                var TenDatabaseOpt = "SuperNova";
                var MonWorkspaceID = document.getElementById("MonAzureWorkspaceIDNow").value;
                var AnaLogID = document.getElementById("LogAnaAzureWorkspaceIDNow").value;
                var AnaLogIDKey = document.getElementById("SharedKeyAzureWorkspaceIDNow").value;

                var GovOrNot = document.getElementById("TenUsingGOVCloud").checked;
                if (GovOrNot == true) {
                    var FinalGOVOrNot = "GOV"
                } else {
                    var FinalGOVOrNot = "NOGOV"
                }

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                if (TenUName == "" || TenDomName == "" || TenGAUser == "" || TenGAPass == "" || SPNGUID == "" || SPNPass == "" || SPNSubID == "" || SPNTenID == "") {

                    document.getElementById("AddTenantCircle").style.display = "none";

                    var ThisMsg = "Please provide all inputs."
                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                    document.getElementById("GettingReadyID").style.display = "none";
                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                    function FunctionFooterDIV() {
                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                        clearInterval(MyTimerFooter);
                    }

                } else {
                    // Now pass Tenant Values here
                    $.ajax({
                        url: '/AddNewTenantNow', // This tells server which Route to use OKAYYYY
                        type: 'POST',
                        async: true,
                        timeout: 50000,
                        data: {
                            'TenNameNow': TenUName,
                            'TenDomNameNow': TenDomName,
                            'TenGAUserNow': TenGAUser,
                            'TenGAPassNow': TenGAPass,
                            'TenSPNGuid': SPNGUID,
                            'TenSPNPass': SPNPass,
                            'TenSPNSubID': SPNSubID,
                            'TenSPNTenID': SPNTenID,
                            'TenAccUserName': TenAccessUserName,
                            'TenAccPass': TenAccessPass,
                            'TenDBOpt': TenDatabaseOpt,
                            'TenMonWPID': MonWorkspaceID,
                            'TenAnaLogID': AnaLogID,
                            'TenAnaLogKey': AnaLogIDKey,
                            'GOVOrNo': FinalGOVOrNot,
                            'ThisLUser': FinalUserNameNow,
                            'SPNDispName': SPNDispName,
                            'TRPKeyNow': TRPKeyNow,
                        },
                        success: function(data) {

                            var SItem = data.message.replace(/[\r\n]+/gm, "");
                            var FinalItem = SItem.replaceAll(' ', '');

                            //alert("R" + FinalItem + "R");

                            if (data.message) {
                                if (FinalItem == "TenantAlready") {

                                    document.getElementById("AddTenantCircle").style.display = "none";

                                    var ThisMsg = "Tenant by Same Name already exists!"
                                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                    document.getElementById("GettingReadyID").style.display = "none";
                                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                    function FunctionFooterDIV() {
                                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                        clearInterval(MyTimerFooter);
                                    }

                                }
                                if (FinalItem == "TenantAdded") {

                                    document.getElementById("AddTenantCircle").style.display = "none";

                                    document.getElementById("RefAllTenants").click();
                                    document.getElementById("RefAllAVDTenNow").click();
                                    document.getElementById("AddTenantModalToDispAndClose").style.display = "none";

                                    var ThisMsg = "Tenant has been added successfully!"
                                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                    document.getElementById("GettingReadyID").style.display = "none";
                                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                    function FunctionFooterDIV() {
                                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                        clearInterval(MyTimerFooter);
                                    }

                                }



                            } else {
                                document.getElementById("AddTenantCircle").style.display = "none";

                                alert("Error adding Tenant");
                            }
                        },
                        error: function() {
                            document.getElementById("AddTenantCircle").style.display = "none";
                            alert("Error adding Tenant");
                        }
                    });
                }

            }
        }

        if (WhatAction == "CAPTUREVMIMAGE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";
                document.getElementById("CaptureVMImageMod").style.display = "none";

                var ThisTen = document.getElementById("CaptureImageManTenList").value;
                var ThisVMName = document.getElementById("CaptureExistingVMName").value;
                var ThisVMResGroup = document.getElementById("CaptureVMResGroupName").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault()
                $.ajax({
                    url: '/CallFinalCaptureVMImage', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTen': ThisTen,
                        'ThisVMName': ThisVMName,
                        'ThisVMResGroup': ThisVMResGroup,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("TestingVMNameCapturecircle").style.display = "none";

                            var ThisData = data.message
                            if (ThisData == "NOTPRESENT") {

                                var ThisMsg = "Error: Please check VM Name and Resource Group."
                                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                document.getElementById("GettingReadyID").style.display = "none";
                                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                function FunctionFooterDIV() {
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                    clearInterval(MyTimerFooter);
                                }
                            }


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });


            }
        }

        if (WhatAction == "CREATEVMFROMIMAGE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";
                document.getElementById("CreateAVMFromImageMod").style.display = "none";

                var ThisTen = document.getElementById("AVDImageManagerTenList").value;

                var ThisVMName = document.getElementById("EditImageVMName").value;
                var ThisVMResGroup = document.getElementById("EditImageVMResGroup").value;
                var ThisVMLocation = document.getElementById("EditImageVMLocation").value;
                var ThisVMAdminUser = document.getElementById("EditImageAdminUserName").value;
                var ThisVMAdminPass = document.getElementById("EditImageAdminPassord").value;
                var ThisImageName = document.getElementById("EditImageImageToEditName").innerHTML;
                var ThisImageID = document.getElementById("EditImageImageURIID").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault()
                $.ajax({
                    url: '/CallCreateVMFromImage', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTen': ThisTen,
                        'ThisVMName': ThisVMName,
                        'ThisVMResGroup': ThisVMResGroup,
                        'ThisVMLocation': ThisVMLocation,
                        'ThisVMAdminUser': ThisVMAdminUser,
                        'ThisVMAdminPass': ThisVMAdminPass,
                        'ThisImageName': ThisImageName,
                        'ThisImageID': ThisImageID,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                            var ThisData = data.message
                            if (ThisData == "Capturing") {

                                var CaptureAttr = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: green;font-size:12px; margin-right: 5px;"></i><span style="color: green;">Capturing Image</span>'

                                var tablenew, rowsnew, i, x, y, shouldSwitch;
                                tablenew = document.getElementById("AllSelectedTenImagesTable");
                                rowsnew = tablenew.rows;
                                for (i = 1; i < (rowsnew.length - 1); i++) {

                                    x = rowsnew[i].getElementsByTagName("TD")[4].innerHTML;
                                    if (x == ThisImageID) {
                                        rowsnew[i].getElementsByTagName("TD")[8].innerHTML = CaptureAttr;
                                    }
                                }

                                MonitorCaptureImage()

                            }


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });


            }
        }

        if (WhatAction == "PROCESSASSTEMPLATENOW") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";
                document.getElementById("ProcessAssignmentTempModN").style.display = "none";

                var ThisAssTemplate = document.getElementById("AllAssignmentTemlatetoDD").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var ThisTen = document.getElementById("ManageAssTenListNV").value;

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/AVDProcessAssTemplate', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisImageTemplate': ThisAssTemplate,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey,
                        'ThisTen': ThisTen
                    },
                    success: function(data) {
                        if (data.message) {

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }
        }

        if (WhatAction == "CREATEMASTERIMAGE") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";
                document.getElementById("CrateMasterImageMod").style.display = "none";

                var ThisImageTemplate = document.getElementById("AllImageTemplatesFroMD").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/AVDCreateMasterImage', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisImageTemplate': ThisImageTemplate,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) {

                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }
        }

        if (WhatAction == "DEPLSESSHOST") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var ThisHostTemplate = document.getElementById("DEPLHostsAllSessHostTemplatesNow").value;
                var TotHostToDepl = document.getElementById("EntNumberOfSessHostsToDeplDD").value;
                var VMInitNumberNow = document.getElementById("AddHostsVMInitialNumberN").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var MultiMode = document.getElementById("AdditionalHostMultiThreadMode").checked;

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/AVDDeploySessHosts', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisHostTemplate': ThisHostTemplate,
                        'ThisLUser': FinalUserNameNow,
                        'TotHostToDepl': TotHostToDepl,
                        'TRPKey': TRPKey,
                        'MultiMode': MultiMode,
                        'VMInitNumberNow': VMInitNumberNow
                    },
                    success: function(data) {
                        if (data.message) {

                            document.getElementById("DeployNewHostsModN").style.display = "none";
                            document.getElementById("NotRunningC").style.display = "block";

                            var ThisMsg = "Session Host Deployment was strated..."
                            document.getElementById("FootMessageID").innerHTML = ThisMsg;
                            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                            document.getElementById("GettingReadyID").style.display = "none";
                            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                            function FunctionFooterDIV() {
                                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                clearInterval(MyTimerFooter);
                            }


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });
            }
        }
        if (WhatAction == "STARTAVDDEPLOY") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var IsBlank = "No";
                if (IsBlank == "Yes") {
                    var ThisMsg = "Some of the fileds are blank in Template. Please check"
                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                    document.getElementById("GettingReadyID").style.display = "none";
                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                    function FunctionFooterDIV() {
                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                        clearInterval(MyTimerFooter);
                    }
                } else {

                    var SelHostPoolTemplate = document.getElementById("AVDDeploySelectedHostPoolTemplate").value;
                    var SelImageTemplate = document.getElementById("AVDDeploySelectedImageTemplate").value;
                    var SelSessionHostTemplate = document.getElementById("AVDDeploySelectedHostTemplate").value;
                    var SelFSLogixTemplate = document.getElementById("AVDDeploySelectedFSLogixTemplate").value;
                    var SelScriptTemplate = document.getElementById("AVDDeploySelectedScriptTemplate").value;
                    var SelAssTemplate = document.getElementById("AVDSelectedAssTemplateNowN").value;

                    var ThisTenant = document.getElementById("SelectedAVDTenNow").innerHTML;
                    var res = ThisTenant.split(":");
                    var FinalTenSelected = res[1];

                    var AppGroupName = document.getElementById("AVDAppGroupNameNow").value;
                    var AppGroupType = document.getElementById("AVDSelectedAppGroupType").value;

                    var DeployHostPoolORNot = "No";
                    if (document.getElementById("AVDDeploySelectedHostPoolTempalteAndProcess").checked == true) {
                        var DeployHostPoolORNot = "Yes";
                    }
                    var DeployImageOrNot = "No";
                    if (document.getElementById("AVDDeploySelectedImageTempAndProcess").checked == true) {
                        var DeployImageOrNot = "Yes";
                    }
                    var DeploySessionHostsOrNot = "No";
                    if (document.getElementById("AVDDeploySelectedHostTemplateAndProcess").checked == true) {
                        var DeploySessionHostsOrNot = "Yes";
                    }
                    var DeployFSLogixOrNot = "No";
                    if (document.getElementById("AVDDeploySelectFSLogixTempAndProcess").checked == true) {
                        var DeployFSLogixOrNot = "Yes";
                    }
                    var DeployScriptOrNot = "No";
                    if (document.getElementById("AVDDeploySelectScriptTempAndProcess").checked == true) {
                        var DeployScriptOrNot = "Yes";
                    }
                    var ProcessAssTemplateOrNot = "No";
                    if (document.getElementById("AVDDeploySelectAssTemplateAndProcess").checked == true) {
                        var ProcessAssTemplateOrNot = "Yes";
                    }

                    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                    var res = ThisLUserNow.split("@");
                    var FinalUserNameNow = res[0];

                    var UIDNow = document.getElementById("SelUIdentifierN").value;

                    var TRPKey = document.getElementById("TRPKeyN").value;
                    var MModeNow = document.getElementById("MultiThreadDepIsOff").checked;

                    if (AppGroupName == null || AppGroupName == "") {

                        var ThisMsg = "Please enter App Group Name..."
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            clearInterval(MyTimerFooter);
                        }

                    } else {

                        $.ajax({
                            url: '/AVDDeploymentStart', // This tells server which Route to use OKAYYYY
                            type: 'POST',
                            async: false,
                            timeout: 50000,
                            data: {
                                'HostPoolTemplate': SelHostPoolTemplate,
                                'ImageTemplate': SelImageTemplate,
                                'SessionHostTemplate': SelSessionHostTemplate,
                                'FSLogixTemplate': SelFSLogixTemplate,
                                'ScriptTemplate': SelScriptTemplate,
                                'ThisLUser': FinalUserNameNow,
                                'AppGroupName': AppGroupName,
                                'AppGroupType': AppGroupType,
                                'DeployHostPoolORNot': DeployHostPoolORNot,
                                'DeployImageOrNot': DeployImageOrNot,
                                'DeploySessionHostsOrNot': DeploySessionHostsOrNot,
                                'DeployFSLogixOrNot': DeployFSLogixOrNot,
                                'DeployScriptOrNot': DeployScriptOrNot,
                                'ProcessAssTemplateOrNot': ProcessAssTemplateOrNot,
                                'FinalTenSelected': FinalTenSelected,
                                'UIDNow': UIDNow,
                                'AssTemplateName': SelAssTemplate,
                                'TRPKey': TRPKey,
                                'MModeNow': MModeNow
                            },
                            success: function(data) {
                                if (data.message) {

                                    document.getElementById("NotRunningC").style.display = "block";

                                    var ThisMsg = "AVD Deployment was started successfully..."
                                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                                    document.getElementById("GettingReadyID").style.display = "none";
                                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                                    function FunctionFooterDIV() {
                                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                                        clearInterval(MyTimerFooter);
                                    }

                                    var ThisAttr = "Connecting";
                                    var CheckDepStatus = "Working";
                                    if (CheckDepStatus == "Working") {
                                        var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'
                                    }
                                    if (ThisAttr == "Connecting") {
                                        var tablenew, rowsnew, i, x, y, shouldSwitch;
                                        tablenew = document.getElementById("VerifiedTemplateAttrTable");
                                        rowsnew = tablenew.rows;
                                        for (i = 1; i < (rowsnew.length - 1); i++) {
                                            x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                            if (x == "Connecting") {
                                                rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                            }
                                        }
                                    }

                                    MonitorAVDDEployFunction()


                                } else {
                                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                                }
                            },
                            error: function() {
                                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            }
                        });

                    }
                }
            }
        }

        if (WhatAction == "ADDBULKASSNOW") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var SelTenNow = document.getElementById("ManageAssTenListNV").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                var BulkAssData = [];
                $("table#AllAsignmendTobeAddedTable tr").each(function() {
                    var rowDataArray = [];
                    var actualData = $(this).find('td');
                    if (actualData.length > 0) {
                        actualData.each(function() {
                            rowDataArray.push($(this).text());
                        });
                        BulkAssData.push(rowDataArray);
                    }
                });

                e.preventDefault();
                $.ajax({
                    url: '/CallAddBulkAssignment', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: true,
                    timeout: 50000,
                    data: {
                        'SelTenNow': SelTenNow,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey,
                        'BulkAssData': BulkAssData
                    },
                    success: function(data) {
                        if (data.message) { // That means if there is data available


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            document.getElementById("SuperNovaStatusID").style.color = "red";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        document.getElementById("SuperNovaStatusID").style.color = "red";
                    }
                });
            }
        }

        if (WhatAction == "ASSANDUNUSER") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var ThisAttr = document.getElementById("ForMultiStringID").innerHTML;

                var ThisUserID = ThisAttr
                var res = ThisUserID.split(":");
                var FinalUserIDNow = res[0];
                var FinalGroupNow = res[1];

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;
                var ThisTen = document.getElementById("ManageAssTenListNV").value;

                e.preventDefault();
                $.ajax({
                    url: '/AssignUnAssignSingleUSer', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: true,
                    timeout: 50000,
                    data: {
                        'AssResGroup': FinalGroupNow,
                        'AssValue': FinalUserIDNow,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey,
                        'ThisTen': ThisTen
                    },
                    success: function(data) {
                        if (data.message) { // That means if there is data available


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            document.getElementById("SuperNovaStatusID").style.color = "red";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        document.getElementById("SuperNovaStatusID").style.color = "red";
                    }
                });
            }
        }

        if (WhatAction == "QUICKADDSINGLEASS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var SelTenNow = document.getElementById("ManageAssTenListNV").value;
                var AssType = document.getElementById("QuickADDNewUsersAssignmentType").value;
                var AssAppGroup = document.getElementById("QuickAddAsAppGroupName").value;
                var AssResGroup = document.getElementById("QuickAssAddResGroupName").value;
                var AssValue = document.getElementById("QuickManuallyAddedAssN").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/AddSingleAssignment', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: true,
                    timeout: 50000,
                    data: {
                        'SelTenNow': SelTenNow,
                        'AssType': AssType,
                        'AssAppGroup': AssAppGroup,
                        'AssResGroup': AssResGroup,
                        'AssValue': AssValue,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) { // That means if there is data available


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            document.getElementById("SuperNovaStatusID").style.color = "red";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        document.getElementById("SuperNovaStatusID").style.color = "red";
                    }
                });
            }
        }

        if (WhatAction == "ADDSINGLEASS") {

            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                var SelTenNow = document.getElementById("ManageAssTenListNV").value;
                var AssType = document.getElementById("ADDNewUsersAssignmentType").value;
                var AssAppGroup = document.getElementById("AddAsAppGroupName").value;
                var AssResGroup = document.getElementById("AssAddResGroupName").value;
                var AssValue = document.getElementById("ManuallyAddedAssN").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                var TRPKey = document.getElementById("TRPKeyN").value;

                e.preventDefault();
                $.ajax({
                    url: '/AddSingleAssignment', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: true,
                    timeout: 50000,
                    data: {
                        'SelTenNow': SelTenNow,
                        'AssType': AssType,
                        'AssAppGroup': AssAppGroup,
                        'AssResGroup': AssResGroup,
                        'AssValue': AssValue,
                        'ThisLUser': FinalUserNameNow,
                        'TRPKey': TRPKey
                    },
                    success: function(data) {
                        if (data.message) { // That means if there is data available


                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                            document.getElementById("SuperNovaStatusID").style.color = "red";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        document.getElementById("SuperNovaStatusID").style.color = "red";
                    }
                });
            }
        }





    });
}
// END: CONFIRM DIA BOX

// START: SWITCH TO AVD MENUS:
{

    $("#MENUSwitchToPolManager").click(function(e) {

        if (document.getElementById("AVDPolicyManagerPane").style.display == "block") {} else {

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToPolManager").style.background = "#074157";

            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDPolicyManagerPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Policy Manager";

            var ThisVal = $('#AllAvaPolicyInPane option').length;
            if (ThisVal > 0) {} else {
                document.getElementById("RefAllPolicyButton").click();
            }

        }

    });

    $("#MENUSwitchToHostsMonitor").click(function(e) {

        if (document.getElementById("AVDHostMonitoring").style.display == "block") {} else {

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToHostsMonitor").style.background = "#074157";

            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDHostMonitoring").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Session Hosts Monitor";

            var MonVal = document.getElementById("MONTotActiveUsersF").innerHTML;
            if (MonVal == "0") {
                document.getElementById("MonSelSelTen").click();

            }

        }

    });

    $("#MENUSwitchToTenConfig").click(function(e) {

        if (document.getElementById("AVDHostMonitoring").style.display == "block") {} else {

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToTenConfig").style.background = "#074157";

            document.getElementById("ResetMenusNow").click();
            document.getElementById("ManageTenantsPage").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Tenant Configuration";
            document.getElementById("RefAllTenants").click();

        }

    });

    $("#MENUSwitchToActivePol").click(function(e) {

        if (document.getElementById("VMActivePoliciesPane").style.display == "block") {} else {

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToActivePol").style.background = "#074157";

            document.getElementById("ResetMenusNow").click();
            document.getElementById("VMActivePoliciesPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Host Pool Configuration";
            document.getElementById("ActivePolRefAllPolN").click();

        }

    });

    $("#MENUSwitchTo24HoursStatus").click(function(e) {

        if (document.getElementById("24HoursStatusPane").style.display == "block") {} else {

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchTo24HoursStatus").style.background = "#074157";

            document.getElementById("ResetMenusNow").click();
            document.getElementById("24HoursStatusPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "24 Hours Status";

            var CheckN = document.getElementById("24HoursMAXActiveUsers").innerHTML;
            if (CheckN == "0") {
                document.getElementById("24HoursSelTEnNNButton").click();
                document.getElementById("24HoursSelTwo").value = "TENANTWISE"
                    //document.getElementById("24ChartUpdateChartButton").click();

            }

        }

    });

    $("#MENUSwitchToSessManager").click(function(e) {

        if (document.getElementById("UserSessManagerPane").style.display == "block") {} else {

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToSessManager").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-00px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("UserSessManagerPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "User Sessions Manager";

            if (document.getElementById("SessTotActive").innerHTML == "0") {
                document.getElementById("SessManaAvaSelSwitchButton").click();
            }

        }

    });

    $("#MENUSwitchToAVDOptionsPane").click(function(e) {

        if (document.getElementById("AVDManagementOptionsPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToAVDOptionsPane").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDManagementOptionsPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "AVD Management Options";

            document.getElementById("ManOptRefAVDData").click();

        }


    });

    $("#MENUSwitchToptLog").click(function(e) {

        if (document.getElementById("OptLogActivityPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToptLog").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("OptLogActivityPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Operational Logs";

        }


    });

    $("#MENUSwitchToCostAnaLog").click(function(e) {


        document.getElementById("ResetAllColor").click();
        document.getElementById("MENUSwitchToCostAnaLog").style.background = "#074157";

        document.getElementById("ResetMenusNow").click();
        document.getElementById("AVDCostAnalyzerLogPane").style.display = "block";
        document.getElementById("SelectedAVDMenu").innerHTML = "Policy Agent Log";

        document.getElementById("GetAgentLogs").click();


    });
    $("#MENUSwitchToOptRBACLog").click(function(e) {

        //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";

        document.getElementById("ResetAllColor").click();
        document.getElementById("MENUSwitchToOptRBACLog").style.background = "#074157";

        document.getElementById("ResetMenusNow").click();
        document.getElementById("OptLogActivityPane").style.display = "block";
        document.getElementById("SelectedAVDMenu").innerHTML = "Operational Log";

        var ThisVal = $('#OptUsersListN option').length;
        if (ThisVal > 0) {} else {
            document.getElementById("RefOptUsersNNButton").click();
        }

    });
    $("#MENUSwitchToNotifyLog").click(function(e) {

        document.getElementById("ResetAllColor").click();
        document.getElementById("MENUSwitchToNotifyLog").style.background = "#074157";

        //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
        document.getElementById("ResetMenusNow").click();
        document.getElementById("AVDCostAnalyzerLogPane").style.display = "block";
        document.getElementById("SelectedAVDMenu").innerHTML = "Notification Agent Log";

        document.getElementById("GetAgentLogs").click();

    });
    $("#MENUSwitchToProfManager").click(function(e) {

        if (document.getElementById("ProfilesManPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToProfManager").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-00px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("ProfilesManPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "FSLogix Profiles Manager";

            if (document.getElementById("TotProfilesNowForSelServerAndShare").innerHTML == "0") {

                document.getElementById("RefListOfServersInProfMan").click();
                document.getElementById("ProfManaSwitchTenNN").click();

            }


        }

    });
    $("#MENUSwitchToAssManager").click(function(e) {

        if (document.getElementById("AVDAssignmentManPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToAssManager").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-00px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDAssignmentManPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Assignments Manager";

            if (document.getElementById("AssignmentPanelTotUsersN").innerHTML == "0") {
                document.getElementById("ManAssSwitchToSelTenNN").click();
            }


        }

    });

    $("#MENUSwitchToDepPools").click(function(e) {

        if (document.getElementById("DeplHostPoolsPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToDepPools").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("DeplHostPoolsPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Deploy Host Pools";

            document.getElementById("DEPLRefAllPoolTemps").click();
        }

    });

    $("#MENUSwitchToCostAnalyzer").click(function(e) {

        if (document.getElementById("CostAnalyzerPaneDiv").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToCostAnalyzer").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("CostAnalyzerPaneDiv").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Cost Analyzer";

            document.getElementById("CostAnaSwitchToTen").click();

        }

    });

    $("#MENUSwitchToDepHosts").click(function(e) {

        if (document.getElementById("DeplSessionHostsPane").style.display == "block") {} else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToDepHosts").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("DeplSessionHostsPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Deploy Session Hosts";

            document.getElementById("DEPLSessionHostRefTemplates").click();

        }

    });

    $("#MENUSwitchToTempManager").click(function(e) {

        if (document.getElementById("ManTemplateManagerPane").style.display == "block") {} else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToTempManager").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("ManTemplateManagerPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Templates Manager";

            var ThisVal = $('#AllAvaTempltesOpt option').length;
            if (ThisVal > 0) {} else {
                document.getElementById("RefAllTemplatesID").click();
            }

        }

    });

    $("#MENUSwitchToProfilesStatus").click(function(e) {

        var ThisMsg = "Action is reserved for use for future releases."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        var ProceedOrNot = "No"
        if (ProceedOrNot == "Yes") {

            if (document.getElementById("ProfileServersStatusPane").style.display == "block") {} else {

                document.getElementById("ResetAllColor").click();
                document.getElementById("MENUSwitchToProfilesStatus").style.background = "#074157";

                //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
                document.getElementById("ResetMenusNow").click();
                document.getElementById("ProfileServersStatusPane").style.display = "block";
                document.getElementById("SelectedAVDMenu").innerHTML = "Profile Servers";

                var RRCheck = document.getElementById("SelProfServerNN").innerHTML;
                var res = RRCheck.split(":");
                var ServerNameNow = res[1];

                if (ServerNameNow == "") {
                    //document.getElementById("ProfileRefProfileServersButton").click();

                    var ThisVal = $('#ProfileTenList option').length;
                    if (ThisVal > 0) {
                        //document.getElementById("OpenProfileServerBButton").click();
                    } else {
                        //document.getElementById("AddProfileServerButton").click();
                    }
                }
            }
        }
    });

    $("#MENUSwitchToImageManager").click(function(e) {

        if (document.getElementById("AVDAImageManagerPane").style.display == "block") {

        } else {

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToImageManager").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDAImageManagerPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "AVD Image Manager";

            document.getElementById("SwitchToImageManagerTen").click();

        }
    });

    $("#MENUSwitchToNotCenter").click(function(e) {

        if (document.getElementById("AVDNotAndActionCenterPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToNotCenter").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDNotAndActionCenterPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "AVD Notification Center";
        }
    });

    $("#MENUSwitchToAVDDeploy").click(function(e) {

        if (document.getElementById("SingleClickAVDDeployPane").style.display == "block") {

        } else {

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToAVDDeploy").style.background = "#074157";


            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("SingleClickAVDDeployPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "AVD Deployment";

            if (document.getElementById("SelTenantTotPoolTemplates").innerHTML == "0") {
                document.getElementById("DEPLAVDSelSelTenButton").click();
                document.getElementById("VerifyDepAttributesButton").click();

            }
        }

    });

    $("#MENUSwitchToRBACManager").click(function(e) {

        if (document.getElementById("AVDRBACManagerPane").style.display == "block") {} else {

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToRBACManager").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDRBACManagerPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "RBAC Manager";

            document.getElementById("RefAllRBACUsers").click();


        }
    });

    $("#MENUSwitchToScriptExecution").click(function(e) {

        if (document.getElementById("DeplScriptExecutionPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToScriptExecution").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("DeplScriptExecutionPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Execute Script";

            var ThisVal = $('#DEPLAllScriptTemplatesList option').length;
            if (ThisVal > 0) {} else {
                document.getElementById("DEPLRefAllScriptTemplates").click();
            }

        }

    });


    $("#MENUSwitchToDepFSLogixCOnfig").click(function(e) {

        if (document.getElementById("DEPLFSLogixTemplatesPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToDepFSLogixCOnfig").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("DEPLFSLogixTemplatesPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Deploy FSLogix Configuration";

            var ThisVal = $('#DEPLAllFSLogixTemplatesList option').length;
            if (ThisVal > 0) {} else {
                document.getElementById("DEPLFSLogixRefTemplatesButton").click();
            }

        }

    });

    $("#MENUSwitchToDepApps").click(function(e) {

        if (document.getElementById("DeplShareGalleryPane").style.display == "block") {

        } else {


            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToDepApps").style.background = "#074157";

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("DeplShareGalleryPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Deploy Applications";

            var ThisVal = $('#DEPLAllAppTemplatesHere option').length;
            if (ThisVal > 0) {} else {
                document.getElementById("DEPLAppTemplateRefAll").click();
            }

        }

    });

    $("#MENUSwitchToAVDComp").click(function(e) {

        if (document.getElementById("AVDRiskAndCompPane").style.display == "block") {

        } else {

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("AVDRiskAndCompPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "AVD Compliance";

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToAVDComp").style.background = "#074157";

        }

    });

    $("#MENUSwitchToHostsHealth").click(function(e) {

        if (document.getElementById("HostsHealthPane").style.display == "block") {

        } else {

            //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";
            document.getElementById("ResetMenusNow").click();
            document.getElementById("HostsHealthPane").style.display = "block";
            document.getElementById("SelectedAVDMenu").innerHTML = "Tenant Dashboard";

            document.getElementById("ResetAllColor").click();
            document.getElementById("MENUSwitchToHostsHealth").style.background = "#074157";

            if (document.getElementById("TotNumberOfHostsNow").innerHTML == "0") {
                document.getElementById("HOSTAvaSelTenButtonN").click();
            }

        }

    });

    $("#MENUSwitchToMultiTenDashboard").click(function(e) {


        var ThisMsg = "Action is reserved for use for future releases."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        var ProceedOrNot = "No"
        if (ProceedOrNot == "Yes") {


            if (document.getElementById("DashboardPane").style.display == "block") {} else {

                //document.getElementById("SwitchTenIDForAll").style.marginTop = "-90px";

                document.getElementById("ResetMenusNow").click();
                document.getElementById("DashboardPane").style.display = "block";
                document.getElementById("SelectedAVDMenu").innerHTML = "Multi-Tenant Dashboard";

                document.getElementById("ResetAllColor").click();
                document.getElementById("MENUSwitchToMultiTenDashboard").style.background = "#074157";

                if (document.getElementById("DASHITotHostPols").innerHTML == "0") {
                    document.getElementById("DASHSwitchToSelTen").click();
                }

            }
        }

    });


    // FOR RESETTING MENU
    $("#ResetMenusNow").click(function(e) {

        document.getElementById("24HoursStatusPane").style.display = "none";
        document.getElementById("Info_AVDRightPane").style.display = "none";
        document.getElementById("UserSessManagerPane").style.display = "none";
        document.getElementById("AVDManagementOptionsPane").style.display = "none";
        document.getElementById("AVDCostAnalyzerLogPane").style.display = "none";
        document.getElementById("AVDNotificationAgentLogPane").style.display = "none";
        document.getElementById("AVDOptLogPane").style.display = "none";
        document.getElementById("ProfilesManPane").style.display = "none";
        document.getElementById("AVDAssignmentManPane").style.display = "none";
        document.getElementById("DeplHostPoolsPane").style.display = "none";
        document.getElementById("DeplSessionHostsPane").style.display = "none";
        document.getElementById("ManTemplateManagerPane").style.display = "none";
        document.getElementById("ProfileServersStatusPane").style.display = "none";
        document.getElementById("NotificationCetnerPane").style.display = "none";
        document.getElementById("SingleClickAVDDeployPane").style.display = "none";
        document.getElementById("AVDRBACManagerPane").style.display = "none";
        document.getElementById("DeplShareGalleryPane").style.display = "none";
        document.getElementById("HostsHealthPane").style.display = "none";
        document.getElementById("DashboardPane").style.display = "none";
        document.getElementById("AVDPolicyManagerPane").style.display = "none";
        document.getElementById("AVDHostMonitoring").style.display = "none";
        document.getElementById("ManageTenantsPage").style.display = "none";
        document.getElementById("CostAnalyzerPaneDiv").style.display = "none";
        document.getElementById("OptLogActivityPane").style.display = "none";
        document.getElementById("AVDNotAndActionCenterPane").style.display = "none";
        document.getElementById("AVDRiskAndCompPane").style.display = "none";
        document.getElementById("AVDAImageManagerPane").style.display = "none";
        document.getElementById("DEPLFSLogixTemplatesPane").style.display = "none";
        document.getElementById("DeplScriptExecutionPane").style.display = "none";
        document.getElementById("VMActivePoliciesPane").style.display = "none";


    });



}
// END: SWITCH TO AVD MENUS:

// START: AVD INFO COLLECT
{


    $("#InfoSwitchToHostPools").click(function(e) {

        document.getElementById("ResetDivsNow").click();
        document.getElementById("ResetMenusNow").click();

        document.getElementById("Info_AVDRightPane").style.display = "block";
        document.getElementById("SelectedAVDMenu").innerHTML = "AVD Info & Status";
        document.getElementById("SelectedAVDPackItemNow").innerHTML = "AVD Host Pools";

        document.getElementById("InfoSwitchToHostPools").style.background = "rgb(7, 65, 87) none repeat scroll 0% 0%";
        document.getElementById("InfoSwitchToHostPools").style.width = "95%";
        document.getElementById("InfoSwitchToHostPools").style.borderRadius = "10px";

        document.getElementById("ButtonSwitchToAVDTen").click();

    });

    $("#InfoSwitchToStartMenu").click(function(e) {

        document.getElementById("ResetDivsNow").click();
        document.getElementById("ResetMenusNow").click();

        document.getElementById("Info_AVDRightPane").style.display = "block";

        document.getElementById("SelectedAVDMenu").innerHTML = "AVD Info & Status";
        document.getElementById("SelectedAVDPackItemNow").innerHTML = "AVD Start Menu Apps";

        document.getElementById("InfoSwitchToStartMenu").style.background = "rgb(7, 65, 87) none repeat scroll 0% 0%";
        document.getElementById("InfoSwitchToStartMenu").style.width = "95%";

        document.getElementById("ButtonSwitchToAVDTen").click();

    });

    $("#InfoSwitchToAppGroups").click(function(e) {

        document.getElementById("ResetDivsNow").click();
        document.getElementById("ResetMenusNow").click();

        document.getElementById("Info_AVDRightPane").style.display = "block";
        document.getElementById("SelectedAVDMenu").innerHTML = "AVD Info & Status";
        document.getElementById("SelectedAVDPackItemNow").innerHTML = "AVD Application Groups";

        document.getElementById("InfoSwitchToAppGroups").style.background = "rgb(7, 65, 87) none repeat scroll 0% 0%";
        document.getElementById("InfoSwitchToAppGroups").style.width = "95%";
        document.getElementById("InfoSwitchToAppGroups").style.borderRadius = "10px";

        document.getElementById("ButtonSwitchToAVDTen").click();

    });


    $("#InfoSwitchToWorkInfo").click(function(e) {

        document.getElementById("ResetDivsNow").click();
        document.getElementById("ResetMenusNow").click();

        document.getElementById("Info_AVDRightPane").style.display = "block";

        document.getElementById("SelectedAVDMenu").innerHTML = "AVD Info & Status";
        document.getElementById("SelectedAVDPackItemNow").innerHTML = "AVD Workspace Info";

        document.getElementById("InfoSwitchToWorkInfo").style.background = "rgb(7, 65, 87) none repeat scroll 0% 0%";
        document.getElementById("InfoSwitchToWorkInfo").style.width = "95%";
        document.getElementById("InfoSwitchToWorkInfo").style.borderRadius = "10px";

        document.getElementById("ButtonSwitchToAVDTen").click();
    });

    $("#InfoSwitchToSessHostInfo").click(function(e) {

        document.getElementById("ResetDivsNow").click();
        document.getElementById("ResetMenusNow").click();

        document.getElementById("Info_AVDRightPane").style.display = "block";

        document.getElementById("SelectedAVDMenu").innerHTML = "AVD Info & Status";
        document.getElementById("SelectedAVDPackItemNow").innerHTML = "AVD Session Hosts Info";

        document.getElementById("InfoSwitchToSessHostInfo").style.background = "rgb(7, 65, 87) none repeat scroll 0% 0%";
        document.getElementById("InfoSwitchToSessHostInfo").style.width = "95%";
        document.getElementById("InfoSwitchToSessHostInfo").style.borderRadius = "10px";

        document.getElementById("ButtonSwitchToAVDTen").click();
    });


    $("#InfoSwitchToHeartbeat").click(function(e) {

        document.getElementById("ResetDivsNow").click();
        document.getElementById("ResetMenusNow").click();

        document.getElementById("Info_AVDRightPane").style.display = "block";

        document.getElementById("SelectedAVDMenu").innerHTML = "AVD Info & Status";
        document.getElementById("SelectedAVDPackItemNow").innerHTML = "AVD Session Hosts Heartbeat and Update Status";

        document.getElementById("InfoSwitchToHeartbeat").style.background = "rgb(7, 65, 87) none repeat scroll 0% 0%";
        document.getElementById("InfoSwitchToHeartbeat").style.width = "95%";
        document.getElementById("InfoSwitchToHeartbeat").style.borderRadius = "10px";

        document.getElementById("ButtonSwitchToAVDTen").click();
    });

    $("#ResetDivsNow").click(function(e) {

        document.getElementById("InfoSwitchToStartMenu").style.border = "1px solid transparent";
        document.getElementById("InfoSwitchToStartMenu").style.background = "transparent";
        document.getElementById("InfoSwitchToAppGroups").style.border = "1px solid transparent";
        document.getElementById("InfoSwitchToAppGroups").style.background = "transparent";
        document.getElementById("InfoSwitchToWorkInfo").style.border = "1px solid transparent";
        document.getElementById("InfoSwitchToWorkInfo").style.background = "transparent";
        document.getElementById("InfoSwitchToSessHostInfo").style.border = "1px solid transparent";
        document.getElementById("InfoSwitchToSessHostInfo").style.background = "transparent";
        document.getElementById("InfoSwitchToHeartbeat").style.border = "1px solid transparent";
        document.getElementById("InfoSwitchToHeartbeat").style.background = "transparent";
        document.getElementById("InfoSwitchToHostPools").style.border = "1px solid transparent";
        document.getElementById("InfoSwitchToHostPools").style.background = "transparent";

        //document.getElementById("SwitchTenIDForAll").style.marginTop = "-00px";

        //var DivToRem = document.getElementById("AVDInfoTable");
        //DivToRem.remove();

    });

    function GetAVDInfoNowFunction(ThisCompleteData, ThisPackInfo) {

        document.getElementById("CollectingSelPackCircle").style.display = "none";

        var datatable = document.createElement("table");
        datatable.id = 'AVDInfoTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");
            var row = datatable.insertRow(-1);

            var CheckFRow = cells[0];

            if (CheckFRow == "LASTREFDATE") {
                var LastRefDate = cells[1];
                document.getElementById("AVDInfoLastRefDate").innerHTML = "Last Refresh: " + LastRefDate;
            }

            if (CheckFRow == "ENDOFDATA") {
                // Let timer run to collect                                                     
                document.getElementById("CollectingSelPackCircle").style.display = "none";

            } else {

                if (CheckFRow == "Application Group" || CheckFRow == "Name" || CheckFRow == "Display Name") {
                    for (var j = 0; j < cells.length; j++) {

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[j];

                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";

                    }
                } else {

                    if (CheckFRow == "LASTREFDATE") {} else {

                        for (var j = 0; j < cells.length; j++) {

                            var CheckIfBlank = cells[0]

                            if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[j];

                                if (cells[j] == "Not Receiving Heartbeat. Please check" || cells[j] == "Not Updated since last 10 Days. Please check") {
                                    cell.style.color = "#ee8907";
                                }

                            }

                        }

                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            if (ThisPackInfo == "AVD Host Pools" || ThisPackInfo == "AVD Application Groups") {

                                if (ThisPackInfo == "AVD Host Pools") {
                                    var ThisPoolName = cells[0];
                                    var ChangeSettNow = '<button id = ' + ThisPoolName + "_REMOVE" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="UpdatePoolSettingsFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Update Pool Settings</button>'
                                    var KPIAgentSettings = '<button id = ' + ThisPoolName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="UpdateKPIAgentSettings(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>KPI Agent Settings</button>'

                                    //var cell = row.insertCell(-1);
                                    //cell.innerHTML = ChangeSettNow;

                                    //var cell = row.insertCell(-1);
                                    //cell.innerHTML = KPIAgentSettings;
                                }
                                if (ThisPackInfo == "AVD Application Groups") {
                                    var UPNNew = "CC"
                                    var ChangeSettNow = '<button id = ' + UPNNew + "_REMOVE" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="UpdateGroupSettingsFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Update Group Settings</button>'
                                    var RemoveGroup = '<button id = ' + UPNNew + "_REMOVE" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="RemoveCurrentGroupFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Remove Group</button>'

                                    //var cell = row.insertCell(-1);
                                    //cell.innerHTML = ChangeSettNow;
                                    //var cell = row.insertCell(-1);
                                    //cell.innerHTML = RemoveGroup;
                                }


                            }

                            if (ThisPackInfo == "AVD Session Hosts Heartbeat and Update Status") {
                                var UPNNew = "CC"
                                var ChangeSettNow = '<button id = ' + UPNNew + "_REMOVE" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="PatchCurrentSessionHostFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Patch Session Host</button>'
                                    // var cell = row.insertCell(-1);
                                    // cell.innerHTML = ChangeSettNow;
                            }

                        }

                    }
                }

            }
        }

        var dtable = document.getElementById("InfoAVDTableDiv");
        dtable.innerHTML = "";
        dtable.appendChild(datatable);

        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
        document.getElementById("RefAllTaskRunningListButton").click();





    }
}
// END - AVD INFO COLLECT

// START: LOADING ALL TENANTS IN WVD PANE
{
    $("#RefAllAVDTenNow").click(function(e) {

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/LoadAllTenants', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: true,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) { // That means if there is data available
                    const columns = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14] // represents allowed column 1 and 3 in index form                                        

                    var CreateTempTens = document.getElementById("TemplateTenAppliesTo");
                    var options = document.querySelectorAll('#TemplateTenAppliesTo option');
                    options.forEach(o => o.remove());

                    var XAVDTenList = document.getElementById("AVDTempCreateAllTenList");
                    var options = document.querySelectorAll('#AVDTempCreateAllTenList option');
                    options.forEach(o => o.remove());

                    var LoginTens = document.getElementById("AllTensAtLogin");
                    var options = document.querySelectorAll('#AllTensAtLogin option');
                    options.forEach(o => o.remove());

                    var PolCondTenList = document.getElementById("SelectedPolPolTenant");
                    var options = document.querySelectorAll('#SelectedPolPolTenant option');
                    options.forEach(o => o.remove());

                    var AllPolTenList = document.getElementById("AllPoliciiesTenList");
                    var options = document.querySelectorAll('#AllPoliciiesTenList option');
                    options.forEach(o => o.remove());

                    var AllCaptureTens = document.getElementById("CaptureImageManTenList");
                    var options = document.querySelectorAll('#CaptureImageManTenList option');
                    options.forEach(o => o.remove());

                    var AllImageTens = document.getElementById("AVDImageManagerTenList");
                    var options = document.querySelectorAll('#AVDImageManagerTenList option');
                    options.forEach(o => o.remove());

                    var AllRiskTens = document.getElementById("AVDRiskAndCompTenList");
                    var options = document.querySelectorAll('#AVDRiskAndCompTenList option');
                    options.forEach(o => o.remove());

                    var AllNotActionTens = document.getElementById("NotAndActionTenList");
                    var options = document.querySelectorAll('#NotAndActionTenList option');
                    options.forEach(o => o.remove());

                    var ProfManTens = document.getElementById("ProfManagerTenListNH");
                    var options = document.querySelectorAll('#ProfManagerTenListNH option');
                    options.forEach(o => o.remove());

                    var AllMonTens = document.getElementById("MONAvaTenList");
                    var options = document.querySelectorAll('#MONAvaTenList option');
                    options.forEach(o => o.remove());

                    var AssTens = document.getElementById("ManageAssTenListNV");
                    var options = document.querySelectorAll('#ManageAssTenListNV option');
                    options.forEach(o => o.remove());

                    var ProfileTens = document.getElementById("SelectProfileServerTenantN");
                    var options = document.querySelectorAll('#SelectProfileServerTenantN option');
                    options.forEach(o => o.remove());

                    var CostTens = document.getElementById("CostAnalyzerTens");
                    var options = document.querySelectorAll('#CostAnalyzerTens option');
                    options.forEach(o => o.remove());

                    var NotTens = document.getElementById("NOTSetSelTenant");
                    var options = document.querySelectorAll('#NOTSetSelTenant option');
                    options.forEach(o => o.remove());

                    var xLeft = document.getElementById("AllAVDTensListed");
                    var options = document.querySelectorAll('#AllAVDTensListed option');
                    options.forEach(o => o.remove());

                    var DashTens = document.getElementById("DASHAvaTenListNS");
                    var options = document.querySelectorAll('#DASHAvaTenListNS option');
                    options.forEach(o => o.remove());

                    var HostHTens = document.getElementById("HOSTHAvaTenListN");
                    var options = document.querySelectorAll('#HOSTHAvaTenListN option');
                    options.forEach(o => o.remove());

                    var H24HoursTen = document.getElementById("H24HoursAvaTenListND");
                    var options = document.querySelectorAll('#H24HoursAvaTenListND option');
                    options.forEach(o => o.remove());

                    var AVDDeplTens = document.getElementById("DEPLAVDAvaTenListND");
                    var options = document.querySelectorAll('#DEPLAVDAvaTenListND option');
                    options.forEach(o => o.remove());

                    var SessMTenList = document.getElementById("SessManagerAavaTenListN");
                    var options = document.querySelectorAll('#SessManagerAavaTenListN option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split("#");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            var ThisStrNow = newcell;
                            var NewStrNow = ThisStrNow.substring(0, 3);

                            if (newcell == 'Unique Name' || NewStrNow == "EOI") {} else {
                                if (newcell == "" || newcell == null) {} else {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    DashTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    HostHTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    H24HoursTen.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AVDDeplTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    SessMTenList.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    CostTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ProfileTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AssTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllMonTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ProfManTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllNotActionTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllRiskTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllImageTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllCaptureTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllPolTenList.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    PolCondTenList.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    LoginTens.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    XAVDTenList.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    CreateTempTens.add(optionR);

                                }
                            }

                        }
                    }

                    var ThisTenSelected = document.getElementById("AllTensAtLogin").value
                    document.getElementById("AllAVDTensListed").value = ThisTenSelected;

                    var ThisTenSelected = document.getElementById("AllAVDTensListed").value;
                    document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + ThisTenSelected;

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    document.getElementById("SuperNovaStatusID").style.color = "red";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
            }
        });
    });
}
// END: LOADING ALL AVD TENANTS IN AVD PANE

// START: 24 HOURS COLLECT DATA
{

    $("#Collect24DatesButton").click(function(e) {

        var ThisTenant = document.getElementById("H24HoursAvaTenListND").value;
        var FinalTenSelected = ThisTenant;

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/Get24HoursDates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenant': FinalTenSelected,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) { // That means if there is data available

                    var xLeft = document.getElementById("24HoursSelONE");
                    var xPools = document.getElementById("24HoursSelTwo");
                    var xDuration = document.getElementById("24HoursSelThree");

                    $('#24HoursSelONE').empty();
                    $('#24HoursSelTwo').empty();
                    $('#24HoursSelThree').empty();

                    var optionRR = document.createElement("option");
                    optionRR.text = "Hourly";
                    xDuration.add(optionRR);

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var ThisDataNow = cells[1];

                            if (newcell == '24DATES') {
                                var optionR = document.createElement("option");
                                optionR.text = ThisDataNow;
                                xLeft.add(optionR);
                            }
                            if (newcell == 'HOSTPOOLS') {
                                var optionRT = document.createElement("option");
                                optionRT.text = ThisDataNow;
                                xPools.add(optionRT);
                            }

                        }
                    }


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    document.getElementById("SuperNovaStatusID").style.color = "red";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
            }
        });



    });

    $("#24ChartUpdateChartButton").click(function(e) {

        var InsertC = '<div id="RefAllCircleHAHA" style="width: 80%; display: block; /*! float: right; */ margin-right: 10px; margin-top: 7px;margin: 0;position: absolute;top: 50%;-ms-transform: translateY(-50%);transform: translateY(-50%);transition: translateX(-50%);display: flex;justify-content: center;"><i id="ssss" class="fas fa-circle-notch fa-spin" aria-hidden="true" style="margin-right: 7px;font-size: 50px;color: #13baf1;margin-left: 7px;float: left;text-shadow: none;"></i></div>'
        document.getElementById("24HoursActiveUserChartDIV").innerHTML = InsertC;
        document.getElementById("24HoursMiddleChart").innerHTML = InsertC;
        document.getElementById("24HoursBottomChart").innerHTML = InsertC;

        var ThisMsg = "Generating Chart. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "block";

        var ThisTenant = document.getElementById("H24HoursAvaTenListND").value;
        var FinalTenSelected = ThisTenant

        var DateSel = document.getElementById("24HoursSelONE").value;
        var ScopeSel = document.getElementById("24HoursSelTwo").value;
        var DurSel = document.getElementById("24HoursSelThree").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/Get24HoursData', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenant': FinalTenSelected,
                'DateSel': DateSel,
                'ScopeSel': ScopeSel,
                'DurSel': DurSel,
                'ThisUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = '24HoursTableOne'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableTwo = document.createElement("table");
                    datatableTwo.id = '24HoursTableTwo'
                    datatableTwo.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableThree = document.createElement("table");
                    datatableThree.id = '24HoursTableThree'
                    datatableThree.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckIfBlank = cells[0]

                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            if (CheckIfBlank == "ACTIVESESS") {
                                var row = datatable.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                            }

                            if (CheckIfBlank == "AVGSESS") {
                                var row = datatableTwo.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                            }

                            if (CheckIfBlank == "EXTRA") {
                                var row = datatableThree.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];

                            }

                            if (CheckIfBlank == "HOSTNUMBERS") {

                                var MaxActiveUsers = cells[1];
                                var MaxAVGUsers = cells[2];
                                var MaxHostsNeeded = cells[3];
                                var MaxExtraHosts = cells[4];

                                document.getElementById("24HoursMAXActiveUsers").innerHTML = MaxActiveUsers;
                                document.getElementById("24HoursMaxAvg").innerHTML = MaxAVGUsers;
                                document.getElementById("24HoursMaxHostsNeeded").innerHTML = MaxHostsNeeded;
                                document.getElementById("24HoursExtraTurnedOn").innerHTML = MaxExtraHosts;

                            }

                        }
                    }

                    var dtable = document.getElementById("24UserSessDatatDIV");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("24HoursMiddleData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableTwo);

                    var dtable = document.getElementById("24HoursBottomData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableThree);

                    document.getElementById("ShowUserSessChartButton").click();
                    document.getElementById("ShowMiddleChartButton").click();
                    document.getElementById("ShowBottomChartButton").click();

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    document.getElementById("GettingReadyID").style.display = "none";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }


            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                document.getElementById("GettingReadyID").style.display = "none";

            }
        });

    });

    $("#ShowUserSessDataButton").click(function(e) {

        document.getElementById("24HoursActiveUserChartDIV").style.display = "none";
        document.getElementById("24UserSessDatatDIV").style.display = "block";

    });

    $("#ShowMiddleDataButton").click(function(e) {

        document.getElementById("24HoursMiddleData").style.display = "block";
        document.getElementById("24HoursMiddleChart").style.display = "none";

    });

    $("#ShowBottomDataButton").click(function(e) {

        document.getElementById("24HoursBottomData").style.display = "block";
        document.getElementById("24HoursBottomChart").style.display = "none";

    });

    $("#ShowUserSessChartButton").click(function(e) {

        document.getElementById("24HoursActiveUserChartDIV").style.display = "block";
        document.getElementById("24UserSessDatatDIV").style.display = "none";

        Highcharts.chart('24HoursActiveUserChartDIV', {
            data: {
                table: '24HoursTableOne',
                startColumn: 1,
                endColumn: 2
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Active Users'
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });



    });

    $("#ShowMiddleChartButton").click(function(e) {

        document.getElementById("24HoursMiddleData").style.display = "none";
        document.getElementById("24HoursMiddleChart").style.display = "block";

        Highcharts.chart('24HoursMiddleChart', {
            data: {
                table: '24HoursTableTwo',
                startColumn: 1,
                endColumn: 2
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ""
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Average'
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });



    });

    $("#ShowBottomChartButton").click(function(e) {

        document.getElementById("24HoursBottomData").style.display = "none";
        document.getElementById("24HoursBottomChart").style.display = "block";

        Highcharts.chart('24HoursBottomChart', {
            data: {
                table: '24HoursTableThree',
                startColumn: 1,
                endColumn: 3
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: null
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });



    });


    function Remove_options() {
        $('#myColor24HoursSelONE')
            .empty()
    }

    function Remove_optionsTwo() {
        $('#myColor24HoursSelONE')
            .empty()
    }

}
// END: 24 HOURS COLLECT DATA

// START: SWITCH TO SELECTED TENANT
{
    $("#ButtonSwitchToAVDTen").click(function(e) {


        document.getElementById("CollectingSelPackCircle").style.display = "block";

        var SelectedMenuNow = document.getElementById("SelectedAVDPackItemNow").innerHTML;

        var ThisTenSelected = document.getElementById("AllAVDTensListed").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + ThisTenSelected;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckAVDInfoSingleFile', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTenSelected,
                'ThisLUser': FinalUserNameNow,
                'ThisPackName': SelectedMenuNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {
                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("CollectingSelPackCircle").style.display = "none";
                        }
                    } else {

                        if (SelectedMenuNow == "AVD Host Pools") {
                            var FetchInfoFor = "AVD Host Pools"
                            GetAVDInfoNowFunction(data.message, FetchInfoFor);
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingSelPackCircle").style.display = "none";

                        }
                        if (SelectedMenuNow == "AVD Start Menu Apps") {
                            var FetchInfoFor = "AVD Start Menu Apps"
                            GetAVDInfoNowFunction(data.message, FetchInfoFor);
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingSelPackCircle").style.display = "none";

                        }
                        if (SelectedMenuNow == "AVD Application Groups") {
                            var FetchInfoFor = "AVD Application Groups"
                            GetAVDInfoNowFunction(data.message, FetchInfoFor);
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingSelPackCircle").style.display = "none";

                        }
                        if (SelectedMenuNow == "AVD Application Group Users") {
                            var FetchInfoFor = "AVD Application Group Users"
                            GetAVDInfoNowFunction(data.message, FetchInfoFor);
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingSelPackCircle").style.display = "none";

                        }
                        if (SelectedMenuNow == "AVD Workspace Info") {
                            var FetchInfoFor = "AVD Workspace Info"
                            GetAVDInfoNowFunction(data.message, FetchInfoFor);
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingSelPackCircle").style.display = "none";

                        }
                        if (SelectedMenuNow == "AVD Session Hosts Info") {
                            var FetchInfoFor = "AVD Session Hosts Info"
                            GetAVDInfoNowFunction(data.message, FetchInfoFor);
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingSelPackCircle").style.display = "none";

                        }
                        if (SelectedMenuNow == "AVD Session Hosts Heartbeat and Update Status") {
                            var FetchInfoFor = "AVD Session Hosts Heartbeat and Update Status"
                            GetAVDInfoNowFunction(data.message, FetchInfoFor);
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();
                            document.getElementById("CollectingSelPackCircle").style.display = "none";
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#InfoRefUpdateButton").click(function(e) {

        document.getElementById("CollectingSelPackCircle").style.display = "block";

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("NotRunningC").style.display = "block";

            var ThisTen = document.getElementById("AllAVDTensListed").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var SelectedMenuNow = document.getElementById("SelectedAVDPackItemNow").innerHTML;
            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/RefAVDItems', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        if (SelectedMenuNow == "AVD Host Pools") {
                            document.getElementById("WhatToGetFromServer").innerHTML = "AVD Host Pools";
                        }
                        if (SelectedMenuNow == "AVD Start Menu Apps") {
                            document.getElementById("WhatToGetFromServer").innerHTML = "AVD Start Menu Apps";
                        }
                        if (SelectedMenuNow == "AVD Application Groups") {
                            document.getElementById("WhatToGetFromServer").innerHTML = "AVD Application Groups";
                        }
                        if (SelectedMenuNow == "AVD Workspace Info") {
                            document.getElementById("WhatToGetFromServer").innerHTML = "AVD Workspace Info";
                        }
                        if (SelectedMenuNow == "AVD Session Hosts Info") {
                            document.getElementById("WhatToGetFromServer").innerHTML = "AVD Session Hosts Info";
                        }
                        if (SelectedMenuNow == "AVD Session Hosts Heartbeat and Update Status") {
                            document.getElementById("WhatToGetFromServer").innerHTML = "AVD Session Hosts Heartbeat and Update Status";
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });






}
// END: SWITCH TO SELECTED TENANT

// START: MOVE AVD PANE LEFT AND RIGHT
{
    $("#MoveAVDLeftRight").click(function(e) {

        var TotW = document.getElementById("AVDFullMenuDiv").clientWidth;

        if (TotW < 45) {
            //document.getElementById('AVDFullMenuDiv').setAttribute("style", "width:342px");
            document.getElementById('AVDFullMenuDiv').style.width = "342px";
            document.getElementById('AllAVDMenusNow').style.display = "block";
            document.getElementById('AVDFullMenuDiv').style.minWidth = "342px";

            document.getElementById("OtherLeftOutIcons").style.display = "none";

            document.getElementById("NMoveClass").classList.add('ri-arrow-left-s-fill');
            document.getElementById("NMoveClass").classList.remove('ri-arrow-right-s-fill');

            if (document.getElementById("DashboardPane").style.display == "block") {
                document.getElementById("DASHTopShowChart").click();
                document.getElementById("DASHRightShowChart").click();
            }

        }
        if (TotW > 340) {
            //document.getElementById('AVDFullMenuDiv').setAttribute("style", "width:43px");
            document.getElementById('AVDFullMenuDiv').style.minWidth = "41px";
            document.getElementById('AVDFullMenuDiv').style.width = "41px";
            document.getElementById('AllAVDMenusNow').style.display = "none";

            document.getElementById("NMoveClass").classList.remove('ri-arrow-left-s-fill');
            document.getElementById("NMoveClass").classList.add('ri-arrow-right-s-fill');

            if (document.getElementById("DashboardPane").style.display == "block") {
                document.getElementById("DASHTopShowChart").click();
                document.getElementById("DASHRightShowChart").click();
            }

            document.getElementById("OtherLeftOutIcons").style.display = "block";

        }
    });

}
// END: MOVE AVD PANE LEFT AND RIGHT

// START: SEARCH IN AVD PANE
{

    $(document).ready(function() {
        $("#SearchForVMSizesInList").on("keyup", function() {
            var ThisValue = $(this).val().toLowerCase();
            document.getElementById("AVDSelVMSizeN").value.toLowerCase() = ThisValue;

        });
    });

    $(document).ready(function() {
        $("#ActivePolSearch").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#AVDActivePoliciesTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#SearchUsersInTheListNow").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#UsersGroupTableNow tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#SearchAllProfileHandles").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#ServerProfilesHandlesTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#SearchAllProfilesNNH").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#ServerProfilesTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#SearchInRiskAndCompItems").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#SecAndCompIssuesTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#SearchInAssignmentTableN").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#AssignmentTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#HHealthPoolSearchIH").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#HostPoolStatusTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#HSAllHostsSearch").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#SessionHostsStatusTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#DASHSearchOne").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#DashSessionHostsStatusTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#SearchInUserActionLog").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#UserActionLogTableN tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });


    $(document).ready(function() {
        $("#SearchHostsNowInMon").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#ActiveSessionHostsMonitoringTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#InfoSearchID").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#AVDInfoTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });

    $(document).ready(function() {
        $("#searchUserSessTable").on("keyup", function() {
            var value = $(this).val().toLowerCase();
            $("#SessionManagerTable tr").filter(function() {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });

    });

    $("#AVDBUnitName").on("keyup", function() {
        var value = $(this).val().toLowerCase();

        //"HOSTPOOL-$BusinessUnitName-PROD-001".ToLower()
        var PName = "HOSTPOOL-" + value + "-PROD-001";
        document.getElementById("AVDHostPoolNameN").value = (PName).toLowerCase();

        //"vm$BusinessUnitName".ToLower()
        var PName = "vm-" + value;
        document.getElementById("AVDVMPrefix").value = (PName).toLowerCase();

        // "RG-$BusinessUnitName-PROD-001".ToLower()
        var PName = "RG-" + value + "-PROD-001";
        document.getElementById("AVDVMResGroupN").value = (PName).toLowerCase();

        //"VNet-$BusinessUnitName-001".ToLower()
        var PName = "VNet-" + value + "-001";
        document.getElementById("AVDvNetNameN").value = (PName).toLowerCase();

        //"VNet-$BusinessUnitName-001".ToLower()
        var PName = "SubNet-" + value + "-001";
        document.getElementById("AVDSubNetNAmeN").value = (PName).toLowerCase();

        var PName = "RG-VNet-" + value + "-001";
        document.getElementById("AVDVNetResGroupND").value = (PName).toLowerCase();

    });

}
// END: SEARCH IN AVD PANE

// START: COLLECT SESSION MANAGER DATA
{
    $("#RefSessLiveData").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("NotRunningC").style.display = "block";

            document.getElementById("CollectingSessDetCircle").style.display = "block";

            var ThisTenant = document.getElementById("SessManagerAavaTenListN").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/UserSessionCall', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTenant': ThisTenant,
                    'ThisUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "SESSMANAGERITEMS";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });
        }
    });

    $("#SessFilterButtonN").click(function(e) {

        e.preventDefault()
        document.getElementById("MonSelSelTen").click();

    });

    $("#ResetSessFilterND").click(function(e) {

        e.preventDefault()
        document.getElementById("FiltMonNowListAA").value = "All Hosts";
        document.getElementById("MonSelSelTen").click();

    });


    function GetSessManagerDataNFunction(ThisCompleteData) {

        var ThisTenant = document.getElementById("SessManagerAavaTenListN").value;

        var datatable = document.createElement("table");
        datatable.id = 'SessionManagerTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        var totActive = 0;
        var totDiscon = 0;
        var totStale = 0;
        var totNormal = 0;

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");
            var row = datatable.insertRow(-1);

            var CheckFRow = cells[0];

            if (CheckFRow == "LASTREFDATE" || CheckFRow == "AVDACTIONSTATUS") {

                if (CheckFRow == "LASTREFDATE") {
                    document.getElementById("SessManagerLastRefDate").innerHTML = "Last Refreshed: " + cells[1];
                }
                if (CheckFRow == "AVDACTIONSTATUS") {
                    if (cells[1] == "Yes") {
                        document.getElementById("StaleEnabledOrNotForTenant").style.display = "none";
                    }
                    if (cells[1] == "No") {
                        document.getElementById("StaleEnabledOrNotForTenant").style.display = "block";
                    }
                }

            } else {

                if (CheckFRow == "ENDOFDATA") {
                    // Let timer run to collect                                            
                } else {

                    if (CheckFRow == "UserPrincipalName") {
                        for (var j = 0; j < cells.length; j++) {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }
                    } else {


                        var CheckIfBlank = cells[0]

                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            var UPNNew = cells[0];
                            var ADUserName = cells[1];
                            var CreateTime = cells[2];
                            var SessID = cells[3];
                            var PoolName = cells[4];
                            var SessHostName = cells[5];
                            var SessState = cells[6];
                            var URSGroup = cells[7];
                            var UHostStatus = cells[8];
                            var UAccType = cells[9];

                            if (SessState == "Removed") {

                            } else {


                                var ShadowAttr = UPNNew + ":" + SessID + ":" + SessHostName;
                                var MSGAttr = UPNNew + ":" + SessID + ":" + SessHostName + ":" + PoolName + ":" + URSGroup;

                                var ShadowSess = '<br><br><button id = ' + ShadowAttr + ' class="RCHover" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 0px; margin-top: 0px;outline:none;" onclick="SessShortActionShadowFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Shadow</button>'
                                var SendMSGToUser = '<button id = ' + MSGAttr + ' class="RCHover" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="SessShortActionMSGFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Msg</button>'
                                var SeeUserApp = '<button id = ' + UPNNew + "_SHADOW" + ' class="RCHover" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="SessShortActionFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>User Apps</button>'

                                var RemLogoffUser = localStorage.getItem("SESSManRemoveSingleUser");
                                if (RemLogoffUser == "Yes") {
                                    var RemoveUser = '<br><br><button id = ' + UPNNew + "_REMOVE_" + SessID + ' class="RCHover" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 0px; margin-top: 0px;outline:none;float:none;" onclick="SessShortActionFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Remove</button>'
                                    var LogOffUser = '<button id = ' + UPNNew + "_LOGOFF_" + SessID + ' class="RCHover" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:none;" onclick="SessShortActionFunction(id)"><i class="fas fa-user-minus" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Logoff</button>'
                                    var cell = row.insertCell(-1);

                                    if (SessState == "Disconnected") {
                                        cell.innerHTML = UPNNew + RemoveUser;
                                        cell.style.width = "250px";
                                    } else {
                                        cell.innerHTML = UPNNew + RemoveUser + LogOffUser;
                                        cell.style.width = "250px";
                                    }

                                }
                                if (RemLogoffUser == "No") {
                                    var RemoveUser = '<br><br><button id = ' + UPNNew + "_REMOVE_" + SessID + ' class="RCHover" disabled = true style="text-decoration:line-through;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 0px; margin-top: 0px;outline:none;float:none;" onclick="SessShortActionFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Remove</button>'
                                    var LogOffUser = '<button id = ' + UPNNew + "_LOGOFF_" + SessID + ' class="RCHover" disabled = true style="text-decoration:line-through;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:none;" onclick="SessShortActionFunction(id)"><i class="fas fa-user-minus" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Logoff</button>'
                                    var cell = row.insertCell(-1);

                                    if (SessState == "Disconnected") {
                                        cell.innerHTML = UPNNew + RemoveUser;
                                        cell.style.width = "250px";
                                    } else {
                                        cell.innerHTML = UPNNew + RemoveUser + LogOffUser;
                                        cell.style.width = "250px";
                                    }

                                }

                                var ShadowOrNot = localStorage.getItem("SESSManShadowSingleUser");
                                if (ShadowOrNot == "Yes") {
                                    var ShadowSess = '<br><br><button id = ' + ShadowAttr + ' class="RCHover" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 0px; margin-top: 0px;outline:none;" onclick="SessShortActionShadowFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Shadow</button>'
                                    var SendMSGToUser = '<button id = ' + MSGAttr + ' class="RCHover" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="SessShortActionMSGFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Msg</button>'
                                }
                                if (ShadowOrNot == "No") {
                                    var ShadowSess = '<br><br><button id = ' + ShadowAttr + ' class="RCHover" disabled = true style="text-decoration:line-through;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 0px; margin-top: 0px;outline:none;" onclick="SessShortActionShadowFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Shadow</button>'
                                    var SendMSGToUser = '<button id = ' + MSGAttr + ' class="RCHover" disabled = true style="text-decoration:line-through;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="SessShortActionMSGFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Msg</button>'
                                }

                                var cell = row.insertCell(-1);
                                cell.innerHTML = ADUserName;

                                var cell = row.insertCell(-1);
                                cell.innerHTML = CreateTime;

                                var cell = row.insertCell(-1);
                                cell.innerHTML = SessID;

                                var cell = row.insertCell(-1);
                                cell.innerHTML = PoolName;

                                var cell = row.insertCell(-1);
                                cell.innerHTML = SessHostName;

                                if (SessState == "Active") {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = SessState + ShadowSess + SendMSGToUser //+ SeeUserApp;
                                    cell.style.width = "250px";
                                    cell.style.fontWeight = "500";
                                    cell.style.color = "#02b302";
                                } else {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = SessState + "<br><br>" //+ SeeUserApp;
                                    cell.style.width = "250px";
                                    cell.style.fontWeight = "500";
                                    cell.style.color = "#b37e01";
                                }

                                var cell = row.insertCell(-1);
                                cell.innerHTML = URSGroup;

                                var cell = row.insertCell(-1);
                                cell.innerHTML = UHostStatus;

                                var cell = row.insertCell(-1);
                                cell.innerHTML = UAccType;

                                if (UAccType == "Normal") {
                                    cell.style.fontWeight = "500";
                                    cell.style.color = "#02b302";
                                }
                                if (UAccType == "Stale") {
                                    cell.style.fontWeight = "500";
                                    cell.style.color = "#b37e01";
                                }
                            }

                        }

                        var CheckUserStatus = cells[6];
                        var StaleOrNorm = cells[9];

                        if (CheckUserStatus == "Active") {
                            ++totActive;
                        }
                        if (CheckUserStatus == "Disconnected") {
                            ++totDiscon;
                        }
                        if (StaleOrNorm == "Normal") {
                            ++totNormal;
                        }
                        if (StaleOrNorm == "Stale") {
                            ++totStale;
                        }

                    }
                }
            }
        }

        var dtable = document.getElementById("UserSessDetailsDiv");
        dtable.innerHTML = "";
        dtable.appendChild(datatable);

        document.getElementById("SessTotActive").innerHTML = totActive;
        document.getElementById("SessTotDisconnected").innerHTML = totDiscon;
        document.getElementById("SessTotNormal").innerHTML = totNormal;
        document.getElementById("SessTotStale").innerHTML = totStale;




    }

    function SessShortActionMSGFunction(ThisIDNow) {

        //var MSGAttr = UPNNew + ":" + SessID + ":" + SessHostName+":"+PoolName+":"+URSGroup;

        var ThisUserID = ThisIDNow
        var res = ThisUserID.split(":");
        var UserID = res[0];
        var SessID = res[1];
        var SessHostName = res[2];
        var UserPoolName = res[3];
        var UserRSGroup = res[4];

        document.getElementById("SendMSGToUsersBoxMod").style.display = "block";

        document.getElementById("MSGToUserUPN").innerHTML = UserID;
        document.getElementById("MSGToUserPool").innerHTML = UserPoolName;
        document.getElementById("MSGToUserRSGroup").innerHTML = UserRSGroup;
        document.getElementById("MSGToUserSessID").innerHTML = SessID;
        document.getElementById("MSGToUserHostName").innerHTML = SessHostName;

    }

    $("#SendMsgToUserButtonNND").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = 'Send Messsage to User?'
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ACTIONSENDMSGTOUSER";
        document.getElementById("ForMultiStringID").innerHTML = ThisUserID;


    });

    $("#SESSACTShadowSessO").click(function(e) {

        var UserID = document.getElementById("UPNOrADUserNameValue").value;
        var SessID = document.getElementById("QuickSessID").innerHTML;
        var SessHostName = document.getElementById("QuickSessionHostName").innerHTML;

        document.getElementById("ShadowSessModN").style.display = "block";

        document.getElementById("SHADOWNewUPNOfUser").innerHTML = UserID;
        document.getElementById("SHADOWNEWSessHost").innerHTML = SessHostName;
        document.getElementById("ShadowNewSessIDN").innerHTML = SessID;
        document.getElementById("SHADOWNewSessState").innerHTML = "Active";

        document.getElementById("SelectedShadowModeN").value = "With Permission"
            //mstsc.exe /shadow:$CurSessID /v:$SessHost /control /noConsentPrompt
        var FinalCommand = "mstsc.exe /shadow:" + SessID + " /v:" + SessHostName + " /control"
        document.getElementById("FinalCommandToExecute").innerHTML = FinalCommand;


    });

    function SessShortActionShadowFunction(ThisIDNow) {

        //bthomas@Trugreenmail.Com:364:rg-wvd-4-3.Corp.TgInternal.Com

        var UserID = document.getElementById("UPNOrADUserNameValue").value;
        var SessID = document.getElementById("QuickSessID").innerHTML;
        var SessHostName = document.getElementById("QuickSessionHostName").innerHTML;

        document.getElementById("ShadowSessModN").style.display = "block";

        var res = ThisIDNow.split(":");
        var UserID = res[0];
        var SessID = res[1];
        var SessHostName = res[2];

        document.getElementById("SHADOWNewUPNOfUser").innerHTML = UserID;
        document.getElementById("SHADOWNEWSessHost").innerHTML = SessHostName;
        document.getElementById("ShadowNewSessIDN").innerHTML = SessID;
        document.getElementById("SHADOWNewSessState").innerHTML = "Active";

        document.getElementById("SelectedShadowModeN").value = "With Permission"
            //mstsc.exe /shadow:$CurSessID /v:$SessHost /control /noConsentPrompt
        var FinalCommand = "mstsc.exe /shadow:" + SessID + " /v:" + SessHostName + " /control"
        document.getElementById("FinalCommandToExecute").innerHTML = FinalCommand;


    }

    function ChangeShadowCommand() {


        var SessID = document.getElementById("SHADOWNEWSessHost").innerHTML;
        var SessHostName = document.getElementById("ShadowNewSessIDN").innerHTML;

        var SelShadowType = document.getElementById("SelectedShadowModeN").value;
        if (SelShadowType == "With Permission") {
            var FinalCommand = "mstsc.exe /shadow:" + SessID + " /v:" + SessHostName + " /control"
            document.getElementById("FinalCommandToExecute").innerHTML = FinalCommand;
        } else {
            var FinalCommand = "mstsc.exe /shadow:" + SessID + " /v:" + SessHostName + " /control /noConsentPrompt"
            document.getElementById("FinalCommandToExecute").innerHTML = FinalCommand;

        }

    }


    function SessShortActionFunction(ThisIDNow) {

        var ThisUserID = ThisIDNow
        var res = ThisUserID.split("_");
        var FinalUserIDNow = res[0];
        var FinalActionNow = res[1];
        var SessIDNow = res[2];

        if (FinalActionNow == "REMOVE" || FinalActionNow == "LOGOFF") {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = 'Are you sure you want to ' + FinalActionNow + " User Principal Name: " + FinalUserIDNow
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "REMOVELOGOFF";
            document.getElementById("ForMultiStringID").innerHTML = ThisUserID;

        }

        if (FinalActionNow == "MSG") {

            var ThisMsg = "Action is not production ready yet."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        }


    }

    $("#SESSACTRemoveSessO").click(function(e) {

        var ThisIDNow = document.getElementById("UPNOrADUserNameValue").value;
        var ThisUserID = ThisIDNow
        var FinalUserIDNow = ThisUserID;
        var FinalActionNow = "REMOVE";

        if (FinalActionNow == "REMOVE") {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = 'Are you sure you want to ' + FinalActionNow + " User Principal Name: " + FinalUserIDNow
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "REMOVELOGOFF";
            document.getElementById("ForMultiStringID").innerHTML = ThisUserID;

        }

    });

    $("#SESSACTForceLogoffO").click(function(e) {

        var ThisIDNow = document.getElementById("UPNOrADUserNameValue").value;
        var ThisUserID = ThisIDNow
        var FinalUserIDNow = ThisUserID;
        var FinalActionNow = "LOGOFF";

        if (FinalActionNow == "LOGOFF") {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = 'Are you sure you want to ' + FinalActionNow + " User Principal Name: " + FinalUserIDNow
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "REMOVELOGOFF";
            document.getElementById("ForMultiStringID").innerHTML = ThisUserID;

        }

    });


    $("#SessACTLunhcQuickACT").click(function(e) {

        document.getElementById("SessManQuickAction").style.display = "block";

    });

    $("#CloseQuickActModal").click(function(e) {

        document.getElementById("SessManQuickAction").style.display = "none";

    });

    $("#SessCheckSessStatusID").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var ThisTenant = document.getElementById("SessManagerAavaTenListN").value;
            var UPNOrADUserName = document.getElementById("UPNOrADUserName").value;
            var ActValueNow = document.getElementById("UPNOrADUserNameValue").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            document.getElementById("CheckingUserActStatusCircle").style.display = "block";

            var TRPKey = document.getElementById("TRPKeyN").value;

            e.preventDefault()
            $.ajax({
                url: '/SessQuickActionCall', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTenant': ThisTenant,
                    'UPNOrADUserName': UPNOrADUserName,
                    'ActValueNow': ActValueNow,
                    'ThisUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        GetQuickActionFileFunction()

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });


    function GetQuickActionFileFunction() {

        document.getElementById("CheckingUserActStatusCircle").style.display = "block";

        var myTimerQuickAction = setInterval(function() { FuncCollectQActionData() }, 1000);

        function FuncCollectQActionData() {

            var datatable = document.createElement("table");
            datatable.id = 'FileHandleTableNow'
            datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/GetQuickActionFile', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");

                            var CheckFRow = cells[0];
                            var ValueNow = cells[1];

                            if (CheckFRow == "ENDOFDATA") {
                                // Let timer run to collect                         
                                clearInterval(myTimerQuickAction); // Clear Timer here to ensure it doesn't run once again and then append below data
                                document.getElementById("CheckingUserActStatusCircle").style.display = "none";
                            }

                            if (CheckFRow == "FILEHANDLES") {

                                var row = datatable.insertRow(-1);

                                if (ValueNow == "Client IP") {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                } else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];
                                }

                            } else {

                                if (CheckFRow == "USERSTATE") {
                                    document.getElementById("ACTQuickSessState").innerHTML = ValueNow;
                                }
                                if (CheckFRow == "HOSTPOOL") {
                                    document.getElementById("QuickHostPool").innerHTML = ValueNow;
                                }
                                if (CheckFRow == "USERCONSTATE") {
                                    document.getElementById("QuickSessionState").innerHTML = ValueNow;
                                }
                                if (CheckFRow == "USERHOST") {
                                    document.getElementById("QuickSessionHostName").innerHTML = ValueNow;
                                }
                                if (CheckFRow == "HOSTSTATUS") {
                                    document.getElementById("QuickHostStatusN").innerHTML = ValueNow;
                                }
                                if (CheckFRow == "SESSID") {
                                    document.getElementById("QuickSessID").innerHTML = ValueNow;
                                }
                            }

                        }

                        var dtable = document.getElementById("ProfileHandlesTableDiv");
                        dtable.innerHTML = "";
                        dtable.appendChild(datatable);


                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    clearInterval(myTimerSessionManager); // Clear Timer here to ensure it doesn't run once again and then append below data
                    document.getElementById("CheckingUserActStatusCircle").style.display = "none";
                }
            });

        }
    }

    $("#SessACTLogoffDisconnected").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Log Off All Disconnected Sessions?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "LOGOFFALLDISCON";

    });

    $("#SessACTRemoveDisconnected").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Remove All Disconnected Sessions?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVEALLDISCON";

    });

    $("#SessACTRemoveStaleSess").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Remove All Stale Sessions?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVEALLSTALE";

    });

    function CallLogoffRemoveStaleFunction(WhatToDoNow) {

        var ThisTenant = document.getElementById("SessManagerAavaTenListN").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CALLUserTOPAction', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: true,
            timeout: 50000,
            data: {
                'ThisTenant': ThisTenant,
                'ThisUser': FinalUserNameNow,
                'WhatToDoNow': WhatToDoNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {
                    //changes by Davit: start
                    var checkText = "";
                    if (WhatToDoNow == "Remove All Disconnected Sessions" ||
                        WhatToDoNow == "Logging Off All Disconnected Sessions") {
                        checkText = "Disconnected"
                    } else if (WhatToDoNow == "Remove All Stale Sessions") {
                        checkText = "Stale"
                    }

                    var tablenew, rowsnew, i, x, y, shouldSwitch;
                    tablenew = document.getElementById("SessionManagerTable");
                    rowsnew = tablenew.rows;
                    for (i = 0; i < rowsnew.length; i++) {
                        if (rowsnew[i] && rowsnew[i].getElementsByTagName("TD") && rowsnew[i].getElementsByTagName("TD")[6]) {
                            var FinalToCheck = rowsnew[i].getElementsByTagName("TD")[6].innerText;
                            // TODO need to check each user
                            if (FinalToCheck.indexOf(checkText) > -1) {
                                if (WhatToDoNow == "Logging Off All Disconnected Sessions") {
                                    rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "LOGGED OFF";
                                    rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                                } else {
                                    jQuery(rowsnew[i]).remove();
                                }

                                // rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "REMOVED";
                                // rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                            }
                        }
                    }
                    //changes by Davit: end
                    /*
                    if (WhatToDoNow == "Logging Off All Disconnected Sessions") {
                        var tablenew, rowsnew, i, x, y, shouldSwitch;
                        tablenew = document.getElementById("SessionManagerTable");
                        rowsnew = tablenew.rows;
                        for (i = 1; i < (rowsnew.length); i++) {

                            //<td style="width: 250px; font-weight: 500; color: rgb(179, 126, 1);">Disconnected<br></br>

                            x = rowsnew[i].getElementsByTagName("TD")[6].innerHTML;
                            var RCNew = x.split(">");
                            var RCNewOne = RCNew.split("<");
                            var FinalToCheck = RCNewOne[0];

                            if (FinalToCheck == "Disconnected") {
                                rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "LOGGED OFF";
                                rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                            }
                        }
                    }
                    if (WhatToDoNow == "Remove All Disconnected Sessions") {
                        var tablenew, rowsnew, i, x, y, shouldSwitch;
                        tablenew = document.getElementById("SessionManagerTable");
                        rowsnew = tablenew.rows;
                        for (i = 1; i < (rowsnew.length); i++) {

                            //<td style="width: 250px; font-weight: 500; color: rgb(179, 126, 1);">Disconnected<br></br>

                            x = rowsnew[i].getElementsByTagName("TD")[6].innerHTML;
                            var RCNew = x.split(">");
                            var RCNewOne = RCNew.split("<");
                            var FinalToCheck = RCNewOne[0];

                            if (FinalToCheck == "Disconnected") {
                                rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "REMOVED";
                                rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                            }
                        }
                    }
                    if (WhatToDoNow == "Remove All Stale Sessions") {
                        var tablenew, rowsnew, i, x, y, shouldSwitch;
                        tablenew = document.getElementById("SessionManagerTable");
                        rowsnew = tablenew.rows;
                        for (i = 1; i < (rowsnew.length); i++) {

                            //<td style="width: 250px; font-weight: 500; color: rgb(179, 126, 1);">Disconnected<br></br>

                            FinalToCheck = rowsnew[i].getElementsByTagName("TD")[9].innerHTML;
                            if (FinalToCheck == "Stale") {
                                rowsnew[i].getElementsByTagName("TD")[9].innerHTML = "REMOVED";
                                rowsnew[i].getElementsByTagName("TD")[9].style.color = "Red";
                            }
                        }
                    }
                    */


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });



    }


}
// END: COLLECT SESSION MANAGER DATA

// START: AVD MENU EXPAND/COLLAPSE
{
    $("#AVDShowDashPane").click(function(e) {

        if (document.getElementById("MENUDashItems").style.display == "block") {
            document.getElementById("MENUDashItems").style.display = "none";
        } else {
            document.getElementById("MENUDashItems").style.display = "block";
        }


        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

    });




    $("#AVDShowInfoPane").click(function(e) {

        if (document.getElementById("MENUInfoItems").style.display == "block") {
            document.getElementById("MENUInfoItems").style.display = "none";
        } else {
            document.getElementById("MENUInfoItems").style.display = "block";
        }

        document.getElementById("MENUDashItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

    });




    $("#AVDShowManagePane").click(function(e) {

        if (document.getElementById("MENUManagerItems").style.display == "block") {
            document.getElementById("MENUManagerItems").style.display = "none";
        } else {
            document.getElementById("MENUManagerItems").style.display = "block";
        }

        document.getElementById("MENUDashItems").style.display = "none";
        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

    });



    $("#AVDShowManagementPane").click(function(e) {

        if (document.getElementById("MENUManagementItems").style.display == "block") {
            document.getElementById("MENUManagementItems").style.display = "none";
        } else {
            document.getElementById("MENUManagementItems").style.display = "block";
        }

        document.getElementById("MENUDashItems").style.display = "none";
        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

    });




    $("#AVDShowAnalyzerPane").click(function(e) {

        if (document.getElementById("MENUAnalyzerItems").style.display == "block") {
            document.getElementById("MENUAnalyzerItems").style.display = "none";
        } else {
            document.getElementById("MENUAnalyzerItems").style.display = "block";
        }

        document.getElementById("MENUDashItems").style.display = "none";
        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

    });



    $("#AVDShowSettingsPane").click(function(e) {

        if (document.getElementById("MENUSettingsItems").style.display == "block") {
            document.getElementById("MENUSettingsItems").style.display = "none";
        } else {
            document.getElementById("MENUSettingsItems").style.display = "block";
        }

        document.getElementById("MENUDashItems").style.display = "none";
        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

    });

    $("#AVDShowLogsPane").click(function(e) {

        if (document.getElementById("MENULogItems").style.display == "block") {
            document.getElementById("MENULogItems").style.display = "none";
        } else {
            document.getElementById("MENULogItems").style.display = "block";
        }

        document.getElementById("MENUDashItems").style.display = "none";
        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

    });

    $("#AVDShowDeployPane").click(function(e) {

        if (document.getElementById("MENUDeployItems").style.display == "block") {
            document.getElementById("MENUDeployItems").style.display = "none";
        } else {
            document.getElementById("MENUDeployItems").style.display = "block";
        }

        document.getElementById("MENUDashItems").style.display = "none";
        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";


    });
}
// END: AVD MENU EXPAND/COLLAPSE


// START: ACTIVE POLICIES PANE
{

    $("#SaveActivePolNow").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Save Host Pool Settings?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "SAVEACTPOLICIES";

    });

    $("#ResetAllPolNowD").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Reset Active Policies?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "RESETACTPOLICIES";

    });


    $("#CloseModifyPolicyForSelTenMod").click(function(e) {

        document.getElementById("ModifyPolicyForSelPoolNow").style.display = "none";

    });

    $("#ActivePolRefAllPolN").click(function(e) {

        var datatable = document.createElement("table");
        datatable.id = 'AVDActivePoliciesTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var InsertC = '<div id="RefAllCircleHAHA" style="width: 80%; display: block; /*! float: right; */ margin-right: 10px; margin-top: 7px;margin: 0;position: absolute;top: 50%;-ms-transform: translateY(-50%);transform: translateY(-50%);transition: translateX(-50%);display: flex;justify-content: center;"><i id="ssss" class="fas fa-circle-notch fa-spin" aria-hidden="true" style="margin-right: 7px;font-size: 50px;color: #13baf1;margin-left: 7px;float: left;text-shadow: none;"></i></div>'
        document.getElementById("AllActivePoliciesDivNs").innerHTML = InsertC;
        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CallGetAllActivePolicies', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        var CheckFRow = cells[0];

                        if (CheckFRow == "Tenant Name") {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[0];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[2];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[3];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[4];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[5];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[6];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = "Push KPI Agent";
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = "KPI Agent Settings";
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        } else {

                            if (CheckFRow == "0" || CheckFRow == "1" || CheckFRow == "2" || CheckFRow == "3") {} else {

                                var CheckIfBlank = cells[0]

                                if (CheckIfBlank == "" || CheckIfBlank == null) {

                                } else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];

                                    if (cells[2] == "Not Configured") {
                                        cell.style.color = "red";
                                    } else {
                                        cell.style.color = "green";
                                    }

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[4];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[5];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[6];

                                    ThisPoolName = cells[1] + ":" + cells[0];
                                    var PushKPIAgentNowWW = '<button id = ' + ThisPoolName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:none;" onclick="PushKPIAgentFunctionNow(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Push KPIAgent</button>'
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = PushKPIAgentNowWW;

                                    var KPIAgentSettings = '<button id = ' + ThisPoolName + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:none;" onclick="UpdateKPIAgentSettings(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>KPI Agent Settings</button>'
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = KPIAgentSettings;


                                }
                            }

                        }

                    }

                    var dtable = document.getElementById("AllActivePoliciesDivNs");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var tableRT = document.getElementById('AVDActivePoliciesTable');
                    var cells = tableRT.getElementsByTagName('td');
                    for (var i = 0; i < cells.length; i++) {
                        // Take each cell
                        var cell = cells[i];
                        // do something on onclick event for cell
                        cell.onclick = function() {
                            // Get the row id where the cell exists

                            var rowId = this.parentNode.rowIndex;
                            var rowsNotSelected = tableRT.getElementsByTagName('tr');
                            for (var row = 0; row < rowsNotSelected.length; row++) {
                                rowsNotSelected[row].style.color = "#666666";
                                rowsNotSelected[row].style.background = "white";
                                rowsNotSelected[row].classList.remove('selected');
                            }
                            var rowSelected = tableRT.getElementsByTagName('tr')[rowId];
                            rowSelected.style.color = "black";
                            rowSelected.style.background = "#B1EDFF";
                            rowSelected.className += "selected";

                            var TenName = rowSelected.cells[0].innerHTML;
                            var TenPoolName = rowSelected.cells[1].innerHTML;
                            var TenPoolCurrentPolicy = rowSelected.cells[2].innerHTML;
                            var PoolCurrentTimeZone = rowSelected.cells[3].innerHTML;
                            var PoolOPT = rowSelected.cells[4].innerHTML;
                            var PoolOPTZip = rowSelected.cells[5].innerHTML;
                            var PoolLimitVal = rowSelected.cells[6].innerHTML;

                            if (document.getElementById("KPIAgentSettingsPane").style.display == "block") {

                            } else {

                                document.getElementById("ModifyPolicyForSelPoolNow").style.display = "block";

                                document.getElementById("ActivePoliciesModifyTenName").innerHTML = TenName;
                                document.getElementById("ActivePoliciesModifyPoolName").innerHTML = TenPoolName;
                                document.getElementById("ActivePoliciesCurrentPolicyName").innerHTML = TenPoolCurrentPolicy;
                                document.getElementById("HostPoolSettingAVDOpt").value = PoolOPT;
                                document.getElementById("AVDOptiForPoolZipPath").value = PoolOPTZip;
                                document.getElementById("HostPoolLimitValue").value = PoolLimitVal;

                                var TRPKey = document.getElementById("TRPKeyN").value;
                                $.ajax({
                                    url: '/LoadAllVMPolicies', // This tells server which Route to use OKAYYYY
                                    type: 'POST',
                                    async: false,
                                    timeout: 50000,
                                    data: {
                                        'TRPKey': TRPKey
                                    },
                                    success: function(data) {
                                        if (data.message) {

                                            var xLeft = document.getElementById("ActivePoliciesAllActivePolForSelPool");
                                            var options = document.querySelectorAll('#ActivePoliciesAllActivePolForSelPool option');
                                            options.forEach(o => o.remove());

                                            let res = data.message.replaceAll('"', "");

                                            var rows = res.split("\n");
                                            for (var i = 0; i < rows.length; i++) {
                                                var cells = rows[i].split(",");
                                                if (cells.length > 1) {

                                                    var newcell = cells[0];
                                                    var rUName = cells[0];
                                                    var CheckPol = cells[1];

                                                    if (CheckPol == 'POLSETTINGS') {
                                                        var optionR = document.createElement("option");
                                                        optionR.text = newcell;
                                                        xLeft.add(optionR);
                                                    }
                                                }
                                            }

                                            var optionR = document.createElement("option");
                                            optionR.text = "Not Configured";
                                            xLeft.add(optionR);


                                        } else {
                                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                                        }
                                    },
                                    error: function() {
                                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                                    }
                                });

                                document.getElementById("ActivePoliciesAllActivePolForSelPool").value = TenPoolCurrentPolicy;
                                document.getElementById("HostPoolTimeZone").value = PoolCurrentTimeZone;
                            }

                        }
                    }




                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#ModifyActivePolicyForPoolNowButton").click(function(e) {

        e.preventDefault()

        var ThisVal = document.getElementById("ActivePoliciesAllActivePolForSelPool").value;
        var ThisTimeZone = document.getElementById("HostPoolTimeZone").value;

        var ThisTen = document.getElementById("ActivePoliciesModifyTenName").innerHTML;
        var ThisPool = document.getElementById("ActivePoliciesModifyPoolName").innerHTML;

        var ThisOptEnaOrDis = document.getElementById("HostPoolSettingAVDOpt").value;
        var ThisOptPath = document.getElementById("AVDOptiForPoolZipPath").value;

        var PoolLimitVal = document.getElementById("HostPoolLimitValue").value;

        var table, rows, i, x;
        table = document.getElementById("AVDActivePoliciesTable");
        rows = table.rows;
        for (i = 1; i < (rows.length - 1); i++) {

            var TableTenName = rows[i].getElementsByTagName("TD")[0].innerHTML;
            var TablePoolName = rows[i].getElementsByTagName("TD")[1].innerHTML;

            if (TableTenName == ThisTen) {
                if (TablePoolName == ThisPool) {
                    rows[i].getElementsByTagName("TD")[2].innerHTML = ThisVal;
                    rows[i].getElementsByTagName("TD")[3].innerHTML = ThisTimeZone;
                    rows[i].getElementsByTagName("TD")[4].innerHTML = ThisOptEnaOrDis;
                    rows[i].getElementsByTagName("TD")[5].innerHTML = ThisOptPath;
                    rows[i].getElementsByTagName("TD")[6].innerHTML = PoolLimitVal;

                    if (ThisVal == "Not Configured") {
                        rows[i].getElementsByTagName("TD")[2].style.color = "red";
                    } else {
                        rows[i].getElementsByTagName("TD")[2].style.color = "green";
                    }

                }
            }
        }

        document.getElementById("ModifyPolicyForSelPoolNow").style.display = "none";


    });


}
// END: COLLECT AVD MANAGEMENT OPTIONS




// START: COLLECT AVD MANAGEMENT OPTIONS
{

    $("#ManOptSaveData").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Save SuperNova Options?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "SAVEAVDOPT";

    });


    $("#CloseAVDSettingsModal").click(function(e) {

        document.getElementById("ModifyAVDOptionsModal").style.display = "none";

    });

    $("#ManOptRefAVDData").click(function(e) {

        var InsertC = '<div id="RefAllCircleHAHA" style="width: 80%; display: block; /*! float: right; */ margin-right: 10px; margin-top: 7px;margin: 0;position: absolute;top: 50%;-ms-transform: translateY(-50%);transform: translateY(-50%);transition: translateX(-50%);display: flex;justify-content: center;"><i id="ssss" class="fas fa-circle-notch fa-spin" aria-hidden="true" style="margin-right: 7px;font-size: 50px;color: #13baf1;margin-left: 7px;float: left;text-shadow: none;"></i></div>'
        document.getElementById("WVDManOptionsResultDiv").innerHTML = InsertC;

        var TRPKey = document.getElementById("TRPKeyN").value;

        var datatable = document.createElement("table");
        datatable.id = 'AVDOptionsTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        $.ajax({
            url: '/GetAVDManOptions', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        var CheckFRow = cells[0];

                        if (CheckFRow == "Item") {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[0];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[2];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        } else {

                            var CheckIfBlank = cells[0]
                            val3Opt = cells[2];

                            if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[0];
                                if (CheckIfBlank == "Background Refresh Interval" || CheckIfBlank == "AVD Background Refresh Options" || CheckIfBlank == "AVD Manager Options" || CheckIfBlank == "Cost Analyzer Options" || CheckIfBlank == "AVD Notification Center Options" || CheckIfBlank == "AVD Policy Agent Options") {
                                    cell.style.background = "aliceblue";
                                    cell.style.fontSize = "13px";
                                    cell.style.fontWeight = "600";
                                }

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                if (val3Opt == "Enabled") {
                                    cell.style.color = "green";
                                }
                                if (val3Opt == "Disabled") {
                                    cell.style.color = "#ff6000";
                                }

                            }


                        }

                    }

                    var dtable = document.getElementById("WVDManOptionsResultDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var tableRT = document.getElementById('AVDOptionsTable');
                    var cells = tableRT.getElementsByTagName('td');
                    for (var i = 0; i < cells.length; i++) {
                        // Take each cell
                        var cell = cells[i];
                        // do something on onclick event for cell
                        cell.onclick = function() {
                            // Get the row id where the cell exists

                            var rowId = this.parentNode.rowIndex;
                            var rowsNotSelected = tableRT.getElementsByTagName('tr');
                            for (var row = 0; row < rowsNotSelected.length; row++) {
                                rowsNotSelected[row].style.color = "#666666";
                                rowsNotSelected[row].style.background = "white";
                                rowsNotSelected[row].classList.remove('selected');
                            }
                            var rowSelected = tableRT.getElementsByTagName('tr')[rowId];
                            rowSelected.style.color = "black";
                            rowSelected.style.background = "#B1EDFF";
                            rowSelected.className += "selected";

                            var SettingValue = rowSelected.cells[2].innerHTML;
                            var SettingName = rowSelected.cells[1].innerHTML;

                            if (SettingName == "" || SettingName == "User Activity Logging:Write to Azure Log Analytics" || SettingName == "User Activity LoggingLevel:Write to CloudNova Machine" || SettingName == "" || SettingName == "Log Cost Analyzer Data Every" || SettingName == "AVD Notification Center Agent Processing Interval Every" || SettingName == "AVD Policy Agent Processing Interval Every" || SettingName == "Archive Cost Analyzer Data Every Month") {

                            } else {

                                document.getElementById("ModifyAVDOptionsModal").style.display = "block";

                                document.getElementById("AVDOptionSettingValues").value = SettingValue;
                                document.getElementById("AVDSettingNameNN").innerHTML = SettingName;
                            }

                        }
                    }




                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

        document.getElementById("ManOptRefAllAgentsStatus").click();

    });

    $("#ModifyAVDSettingButton").click(function(e) {

        e.preventDefault()

        var ThisVal = document.getElementById("AVDOptionSettingValues").value;

        var CheckSetting = document.getElementById("AVDSettingNameNN").innerHTML;

        var table, rows, i, x;
        table = document.getElementById("AVDOptionsTable");
        rows = table.rows;
        for (i = 1; i < (rows.length - 1); i++) {

            ThisSettingName = rows[i].getElementsByTagName("TD")[1].innerHTML;

            if (ThisSettingName == CheckSetting) {

                rows[i].getElementsByTagName("TD")[2].innerHTML = ThisVal;

                if (ThisVal == "Enabled") {
                    rows[i].getElementsByTagName("TD")[2].style.color = "green";
                } else {
                    rows[i].getElementsByTagName("TD")[2].style.color = "#ff6000";
                }
            }
        }

        document.getElementById("ModifyAVDOptionsModal").style.display = "none";


    });


}
// END: COLLECT AVD MANAGEMENT OPTIONS

// START: AGENT LOGS COLLECT
{

    $("#GetAgentLogs").click(function(e) {

        var InsertC = '<div id="RefAllCircleHAHA" style="width: 80%; display: block; /*! float: right; */ margin-right: 10px; margin-top: 7px;margin: 0;position: absolute;top: 50%;-ms-transform: translateY(-50%);transform: translateY(-50%);transition: translateX(-50%);display: flex;justify-content: center;"><i id="ssss" class="fas fa-circle-notch fa-spin" aria-hidden="true" style="margin-right: 7px;font-size: 50px;color: #13baf1;margin-left: 7px;float: left;text-shadow: none;"></i></div>'
        document.getElementById("AVDLogForAgentsDiv").innerHTML = InsertC;

        var ThisLogName = document.getElementById("SelectedAVDMenu").innerHTML;
        var TRPKey = document.getElementById("TRPKeyN").value;

        var datatable = document.createElement("table");
        datatable.id = 'AVDLogTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        $.ajax({
            url: '/GetAVDLogs', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'LogName': ThisLogName,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        var CheckFRow = cells[0];

                        if (CheckFRow == "" || CheckFRow == null) {

                        } else {
                            if (ThisLogName == "Policy Agent Log") {

                                if (CheckFRow == "Tenant" || CheckFRow == "Date and Time" || CheckFRow == "Policy") {
                                    for (var j = 0; j < cells.length; j++) {

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];

                                        cell.style.backgroundColor = "white";
                                        cell.style.color = "#066d95";
                                        cell.style.textAlign = "left";
                                        cell.style.letterSpacing = "0px";
                                        cell.style.fontWeight = "600";
                                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                        cell.style.position = "sticky";
                                        cell.style.zIndex = "22";
                                        cell.style.top = "0px";
                                        cell.style.fontSize = "12px";
                                        cell.style.fontFamily = "Calibri";

                                    }
                                } else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[4];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[5];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[6];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[7];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[8];
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[9];

                                }

                            } else {

                                if (CheckFRow == "Tenant" || CheckFRow == "Date and Time" || CheckFRow == "Policy") {
                                    for (var j = 0; j < cells.length; j++) {

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];

                                        cell.style.backgroundColor = "white";
                                        cell.style.color = "#066d95";
                                        cell.style.textAlign = "left";
                                        cell.style.letterSpacing = "0px";
                                        cell.style.fontWeight = "600";
                                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                        cell.style.position = "sticky";
                                        cell.style.zIndex = "22";
                                        cell.style.top = "0px";
                                        cell.style.fontSize = "12px";
                                        cell.style.fontFamily = "Calibri";

                                    }
                                } else {

                                    for (var j = 0; j < cells.length; j++) {

                                        var CheckIfBlank = cells[0]
                                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                                            var cell = row.insertCell(-1);
                                            cell.innerHTML = cells[j];

                                        }

                                    }
                                }


                            }
                        }
                    }

                    var dtable = document.getElementById("AVDLogForAgentsDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);



                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });



    });


    $("#ExportAssignmentsForTenID").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Export Assignments?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "EXPORTASSIGNMENTSNOW";

        }
    });

    $("#ExportCostLogs").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Export Cost Log Activities?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "EXPORTCOSTLOG";

        }
    });

    $("#ClearCostLogsButton").click(function(e) {

        var ThisLog = document.getElementById("SelectedAVDMenu").innerHTML;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to clear " + ThisLog + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CLEARCOSTLOGS";

    });
}

// START: FOR ALL FUNCTIONS NOTIFICATION PANEL
{
    $("#CloseNotifyModal").click(function(e) {

        document.getElementById("AddNewNotificationPanel").style.display = "none";

    });

    $("#CreateNewNotificationID").click(function(e) {

        document.getElementById("AddNewNotificationPanel").style.display = "block";

        $.ajax({
            url: '/LoadAllTenants', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("NotifySelToTenant");
                    var options = document.querySelectorAll('#NotifySelToTenant option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split("#");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'Unique Name') {} else {
                                if (newcell == "" || newcell == null) {} else {
                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    function NotifySelNotifyTypeFunction() {

        var SelNotifyNow = document.getElementById("NotifySelNotifyType").value;

        $.ajax({
            url: '/LoadAllNotificationTypes', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisSelType': SelNotifyNow
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("NotifySelSupportedType");
                    var options = document.querySelectorAll('#NotifySelSupportedType option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split("#");
                        if (cells.length > 1) {

                            var newcell = cells[3];
                            var AppendThis = cells[4];

                            if (AppendThis == "NName") {} else {

                                if (SelNotifyNow == "AVD Mailer") {
                                    if (newcell == 'WVD Notification') {} else {
                                        if (newcell == "" || newcell == null) {} else {
                                            var optionR = document.createElement("option");
                                            optionR.text = AppendThis;
                                            xLeft.add(optionR);
                                        }
                                    }
                                }

                                if (SelNotifyNow == "AVD Notification") {

                                    if (newcell == 'WVD Mailer') {} else {
                                        if (newcell == "" || newcell == null) {} else {
                                            var optionR = document.createElement("option");
                                            optionR.text = AppendThis;
                                            xLeft.add(optionR);
                                        }
                                    }
                                }

                            }

                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });



    }

    function NotifySelToTenantFunction() {

        var TempTenName = document.getElementById("NotifySelToTenant").value;
        alert(TempTenName);

        $.ajax({
            url: '/LoadTenPools', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenNow': TempTenName
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("NotifySelNotifySelHostPool");
                    var options = document.querySelectorAll('#NotifySelNotifySelHostPool option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'HostPool') {} else {
                                if (newcell == "" || newcell == null) {} else {
                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    }

    function GetNotificationSelectedPoolsNow() {

        var TempTenName = document.getElementById("NOTSetSelTenant").value;

        $.ajax({
            url: '/LoadTenPools', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenNow': TempTenName
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("NOTSetSelPoolN");
                    var options = document.querySelectorAll('#NOTSetSelPoolN option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'HostPool') {} else {
                                if (newcell == "" || newcell == null) {} else {
                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    }

    $("#CreateNewNotificationNowButton").click(function(e) {
        // Create Template Here

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Create Notification?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CREATENOT";

    });

}
// END: FOR ALL FUNCTIONS NOTIFICATION PANEL


// START: TEMPLATE CREATION AND ALL OTHER
{


    $("#AVDFetchAllAzLocations").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("CollectTenAllLocsCircleS").style.display = "block";

            var ThisTen = document.getElementById("AVDTempCreateAllTenList").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];
            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/RefAllTenLocations', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        //alert(data.message);

                        //GetAllTenLocationsNowFunction()

                        document.getElementById("WhatToGetFromServer").innerHTML = "GETALLTENLOCATIONS";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });


    $("#CreateAVDTempButton").click(function(e) {
        document.getElementById("CreateNewAVDTempPane").style.display = "block";

        document.getElementById("AVDTempSelONE").click();
        GetAllTenLocationsNowFunction()

    });

    $("#CloseAVDCreTempModal").click(function(e) {
        document.getElementById("CreateNewAVDTempPane").style.display = "none";
    });


    $("#CloseTempModal").click(function(e) {
        document.getElementById("AddNewTemplateModal").style.display = "none";
    });

    $("#CreateNewTempID").click(function(e) {
        document.getElementById("AddNewTemplateModal").style.display = "block";

        document.getElementById("SelTempHostPool").click();

    });

    $("#SelTempEmailOne").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "Email Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempEmailOne").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "none";
        document.getElementById("SelectHostPoolColTwo").style.display = "none";

        document.getElementById("SelectTenantAppliesToONE").style.display = "none";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "none";

        document.getElementById("ApplyNamingConventionONE").style.display = "none";
        document.getElementById("ApplyNamingConventionTWO").style.display = "none";

    });

    $("#SelTempHostPool").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "Host Pool Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempHostPool").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "none";
        document.getElementById("SelectHostPoolColTwo").style.display = "none";

        document.getElementById("SelectTenantAppliesToONE").style.display = "block";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "block";

        document.getElementById("ApplyNamingConventionONE").style.display = "block";
        document.getElementById("ApplyNamingConventionTWO").style.display = "block";

    });

    $("#SelTempSessionHost").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "Session Host Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempSessionHost").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "block";
        document.getElementById("SelectHostPoolColTwo").style.display = "block";

        document.getElementById("SelectTenantAppliesToONE").style.display = "block";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "block";

        document.getElementById("ApplyNamingConventionONE").style.display = "block";
        document.getElementById("ApplyNamingConventionTWO").style.display = "block";

        document.getElementById("AddHostsForaPool").checked = false;



    });
    $("#SelTempFSLogix").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "FSLogix Configuration Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempFSLogix").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "block";
        document.getElementById("SelectHostPoolColTwo").style.display = "block";

        document.getElementById("SelectTenantAppliesToONE").style.display = "block";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "block";

        document.getElementById("ApplyNamingConventionONE").style.display = "none";
        document.getElementById("ApplyNamingConventionTWO").style.display = "none";


    });
    $("#SelTempAssignment").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "Assignment Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempAssignment").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "none";
        document.getElementById("SelectHostPoolColTwo").style.display = "none";

        document.getElementById("SelectTenantAppliesToONE").style.display = "none";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "none";

        document.getElementById("ApplyNamingConventionONE").style.display = "none";
        document.getElementById("ApplyNamingConventionTWO").style.display = "none";


    });
    $("#SelTempScript").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "Script Execution Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempScript").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "block";
        document.getElementById("SelectHostPoolColTwo").style.display = "block";

        document.getElementById("SelectTenantAppliesToONE").style.display = "block";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "block";

        document.getElementById("ApplyNamingConventionONE").style.display = "none";
        document.getElementById("ApplyNamingConventionTWO").style.display = "none";


    });
    $("#SelTempApplication").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "Application Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempApplication").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "block";
        document.getElementById("SelectHostPoolColTwo").style.display = "block";

        document.getElementById("SelectTenantAppliesToONE").style.display = "block";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "block";

        document.getElementById("ApplyNamingConventionONE").style.display = "none";
        document.getElementById("ApplyNamingConventionTWO").style.display = "none";


    });
    $("#SelTempSharedGallery").click(function(e) {

        document.getElementById("SelTempType").innerHTML = "Shared Gallery Template";

        document.getElementById("ResetAllColor").click();
        document.getElementById("SelTempSharedGallery").style.background = "black";

        document.getElementById("SelectHostPoolColOne").style.display = "none";
        document.getElementById("SelectHostPoolColTwo").style.display = "none";

        document.getElementById("SelectTenantAppliesToONE").style.display = "block";
        document.getElementById("SelectTenantAppliesToTWO").style.display = "block";

        document.getElementById("ApplyNamingConventionONE").style.display = "block";
        document.getElementById("ApplyNamingConventionTWO").style.display = "block";


    });

    $("#ResetAllColor").click(function(e) {

        document.getElementById("SelTempHostPool").style.background = "#0597c4";
        document.getElementById("SelTempSessionHost").style.background = "#0597c4";
        document.getElementById("SelTempFSLogix").style.background = "#0597c4";
        document.getElementById("SelTempAssignment").style.background = "#0597c4";
        document.getElementById("SelTempScript").style.background = "#0597c4";
        document.getElementById("SelTempApplication").style.background = "#0597c4";
        document.getElementById("SelTempSharedGallery").style.background = "#0597c4";
        document.getElementById("AVDTempSelONE").style.background = "#0597c4";
        document.getElementById("AVDTempSelTWO").style.background = "#0597c4";
        document.getElementById("AVDTempSelTHREE").style.background = "#0597c4";
        document.getElementById("AVDTempSelFOUR").style.background = "#0597c4";
        document.getElementById("AVDTempSelFIVE").style.background = "#0597c4";
        document.getElementById("SelTempEmailOne").style.background = "#0597c4";

        document.getElementById("MENUSwitchToMultiTenDashboard").style.background = "transparent";
        document.getElementById("MENUSwitchToMultiTenDashboard").style.border = "none";

        document.getElementById("MENUSwitchToMultiTenDashboard").style.background = "transparent";
        document.getElementById("MENUSwitchToMultiTenDashboard").style.border = "none";

        document.getElementById("MENUSwitchToHostsHealth").style.background = "transparent";
        document.getElementById("MENUSwitchToHostsHealth").style.border = "none";

        document.getElementById("MENUSwitchToMultiTenDashboard").style.background = "transparent";
        document.getElementById("MENUSwitchToMultiTenDashboard").style.border = "none";

        document.getElementById("MENUSwitchToHostsMonitor").style.background = "transparent";
        document.getElementById("MENUSwitchToHostsMonitor").style.border = "none";

        document.getElementById("MENUSwitchToProfilesStatus").style.background = "transparent";
        document.getElementById("MENUSwitchToProfilesStatus").style.border = "none";

        document.getElementById("MENUSwitchToAVDComp").style.background = "transparent";
        document.getElementById("MENUSwitchToAVDComp").style.border = "none";

        document.getElementById("MENUSwitchToRBACManager").style.background = "transparent";
        document.getElementById("MENUSwitchToRBACManager").style.border = "none";

        document.getElementById("MENUSwitchToPolManager").style.background = "transparent";
        document.getElementById("MENUSwitchToPolManager").style.border = "none";

        document.getElementById("MENUSwitchToNotCenter").style.background = "transparent";
        document.getElementById("MENUSwitchToNotCenter").style.border = "none";

        document.getElementById("MENUSwitchToImageManager").style.background = "transparent";
        document.getElementById("MENUSwitchToImageManager").style.border = "none";

        document.getElementById("MENUSwitchToTempManager").style.background = "transparent";
        document.getElementById("MENUSwitchToTempManager").style.border = "none";

        document.getElementById("MENUSwitchToSessManager").style.background = "transparent";
        document.getElementById("MENUSwitchToSessManager").style.border = "none";

        document.getElementById("MENUSwitchToProfManager").style.background = "transparent";
        document.getElementById("MENUSwitchToProfManager").style.border = "none";

        document.getElementById("MENUSwitchToAssManager").style.background = "transparent";
        document.getElementById("MENUSwitchToAssManager").style.border = "none";

        document.getElementById("MENUSwitchToDepApps").style.background = "transparent";
        document.getElementById("MENUSwitchToDepApps").style.border = "none";

        document.getElementById("MENUSwitchToAVDDeploy").style.background = "transparent";
        document.getElementById("MENUSwitchToAVDDeploy").style.border = "none";

        document.getElementById("MENUSwitchToAVDOptionsPane").style.background = "transparent";
        document.getElementById("MENUSwitchToAVDOptionsPane").style.border = "none";

        document.getElementById("MENUSwitchToCostAnaLog").style.background = "transparent";
        document.getElementById("MENUSwitchToCostAnaLog").style.border = "none";

        document.getElementById("MENUSwitchToNotifyLog").style.background = "transparent";
        document.getElementById("MENUSwitchToNotifyLog").style.border = "none";

        document.getElementById("MENUSwitchTo24HoursStatus").style.background = "transparent";
        document.getElementById("MENUSwitchTo24HoursStatus").style.border = "none";

        document.getElementById("MENUSwitchToPolManager").style.background = "transparent";
        document.getElementById("MENUSwitchToPolManager").style.border = "none";

        document.getElementById("MENUSwitchToHostsMonitor").style.background = "transparent";
        document.getElementById("MENUSwitchToHostsMonitor").style.border = "none";

        document.getElementById("MENUSwitchToTenConfig").style.background = "transparent";
        document.getElementById("MENUSwitchToTenConfig").style.border = "none";

        document.getElementById("MENUSwitchToCostAnalyzer").style.background = "transparent";
        document.getElementById("MENUSwitchToCostAnalyzer").style.border = "none";

        document.getElementById("MENUSwitchToOptRBACLog").style.background = "transparent";
        document.getElementById("MENUSwitchToOptRBACLog").style.border = "none";

        document.getElementById("MENUSwitchToAVDComp").style.background = "transparent";
        document.getElementById("MENUSwitchToAVDComp").style.border = "none";

        document.getElementById("MENUSwitchToImageManager").style.background = "transparent";
        document.getElementById("MENUSwitchToImageManager").style.border = "none";

        document.getElementById("MENUSwitchToDepFSLogixCOnfig").style.background = "transparent";
        document.getElementById("MENUSwitchToDepFSLogixCOnfig").style.border = "none";

        document.getElementById("MENUSwitchToScriptExecution").style.background = "transparent";
        document.getElementById("MENUSwitchToScriptExecution").style.border = "none";

        document.getElementById("MENUSwitchToActivePol").style.background = "transparent";
        document.getElementById("MENUSwitchToActivePol").style.border = "none";

    });



    $("#CreateTemplateButtonNow").click(function(e) {
        // Create Template Here

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Create Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CREATETEMPLATE";

    });

    function GetAllHostPoolsForPolCreation() {

        var TempTenName = document.getElementById("AllPoliciiesTenList").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadTenPools', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenNow': TempTenName,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var AllPolPools = document.getElementById("AllPoliciesTenSelHostPool");
                    var options = document.querySelectorAll('#AllPoliciesTenSelHostPool option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'HostPool') {} else {
                                if (newcell == "" || newcell == null) {} else {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllPolPools.add(optionR);
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    }

    function GetAllHostPoolsForTenant() {

        var TempTenName = document.getElementById("TemplateTenAppliesTo").value;
        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadTenPools', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenNow': TempTenName,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var AllPolCondPools = document.getElementById("SelectedPolPolHostPool");
                    var options = document.querySelectorAll('#SelectedPolPolHostPool option');
                    options.forEach(o => o.remove());

                    var AllPolPools = document.getElementById("AllPoliciesTenSelHostPool");
                    var options = document.querySelectorAll('#AllPoliciesTenSelHostPool option');
                    options.forEach(o => o.remove());

                    var xLeft = document.getElementById("TemplateHostPoolAppliesTo");
                    var options = document.querySelectorAll('#TemplateHostPoolAppliesTo option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'HostPool') {} else {
                                if (newcell == "" || newcell == null) {} else {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllPolPools.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllPolCondPools.add(optionR);

                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    }

    function GetAllHostPoolsUnderPolicy() {

        var TempTenName = document.getElementById("SelectedPolPolTenant").value;
        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadTenPools', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenNow': TempTenName,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var AllPolCondPools = document.getElementById("SelectedPolPolHostPool");
                    var options = document.querySelectorAll('#SelectedPolPolHostPool option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'HostPool') {} else {
                                if (newcell == "" || newcell == null) {} else {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AllPolCondPools.add(optionR);

                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    }

    function GetAllTenLocationsNowFunction() {

        document.getElementById("CollectTenAllLocsCircleS").style.display = "block";

        var TempTenName = document.getElementById("AVDTempCreateAllTenList").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAVDTenLocations', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenNow': TempTenName,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {

                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("CollectTenAllLocsCircleS").style.display = "none";
                        }
                    } else {
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("RefAllTaskRunningListButton").click();


                        var xLeft = document.getElementById("AVDAzureLocation");
                        var options = document.querySelectorAll('#AVDAzureLocation option');
                        options.forEach(o => o.remove());

                        var ForPoolsTemplate = document.getElementById("OPTHostPoolAllLocs");
                        var options = document.querySelectorAll('#OPTHostPoolAllLocs option');
                        options.forEach(o => o.remove());

                        let res = data.message.replaceAll('"', "");

                        var rows = res.split("\n");
                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            if (cells.length > 1) {

                                var newcell = cells[0];

                                if (newcell == "" || newcell == null) {} else {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ForPoolsTemplate.add(optionR);

                                }

                            }
                        }

                        document.getElementById("CollectTenAllLocsCircleS").style.display = "none";

                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    }

    $("#RefAllTemplatesID").click(function(e) {

        var ProceedOrNot = "Yes";

        var ThisSelNow = document.getElementById("OpenedTempName").innerHTML;
        var res = ThisSelNow.split(":");
        var Value1 = res[0];
        var Value2 = res[1];
        if (Value2 == "" || Value2 == null) {
            ProceedOrNot = "Yes"
        } else {
            ProceedOrNot = "No"
        }
        ProceedOrNot = "Yes"

        if (ProceedOrNot == "Yes") {

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        var xLeft = document.getElementById("AllAvaTempltesOpt");
                        var options = document.querySelectorAll('#AllAvaTempltesOpt option');
                        options.forEach(o => o.remove());

                        let res = data.message.replaceAll('"', "");

                        var rows = res.split("\n");
                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            if (cells.length > 1) {

                                var newcell = cells[0] + ":" + cells[3];
                                var rUName = cells[0];

                                if (rUName == 'TemplateName') {} else {
                                    if (rUName == "" || rUName == null) {} else {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });
        }

    });



    $("#OpenSelTemplateNowThisID").click(function(e) {

        var ThisMsg = "Opening Template. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var SelTempNow = document.getElementById("AllAvaTempltesOpt").value;

        var res = SelTempNow.split(":");
        var FinalSelTempNow = res[0];
        var FinalTypeNow = res[1];

        document.getElementById("OpenedTempName").innerHTML = "Selected Template: " + FinalSelTempNow;
        document.getElementById("OpenedTempType").innerHTML = "Template Type: " + FinalTypeNow;

        if (FinalTypeNow == "EmailTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "none";
            document.getElementById("TemplateSessionHostPane").style.display = "none";
            document.getElementById("TemplateFSLogixPane").style.display = "none";
            document.getElementById("TemplateImagePane").style.display = "none";
            document.getElementById("TemplateScripTempPane").style.display = "none";
            document.getElementById("TemplateAssignmentTempPane").style.display = "none";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "none";
            document.getElementById("TemplateEmailSPane").style.display = "block";

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        var CopyFromEmailTemplateTo = document.getElementById("CopyFromEmailTemplateTo");
                        var options = document.querySelectorAll('#CopyFromEmailTemplateTo option');
                        options.forEach(o => o.remove());

                        let res = data.message.replaceAll('"', "");

                        var rows = res.split("\n");
                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            if (cells.length > 1) {

                                var newcell = cells[0];
                                var rUName = cells[0];
                                var CheckTType = cells[3];

                                if (rUName == 'TemplateName') {} else {
                                    if (rUName == "" || rUName == null) {} else {

                                        if (CheckTType == "EmailTemplate") {

                                            var optionR = document.createElement("option");
                                            optionR.text = newcell;
                                            CopyFromEmailTemplateTo.add(optionR);

                                        }
                                    }
                                }
                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });



        }

        if (FinalTypeNow == "HostPoolTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "block";
            document.getElementById("TemplateSessionHostPane").style.display = "none";
            document.getElementById("TemplateFSLogixPane").style.display = "none";
            document.getElementById("TemplateImagePane").style.display = "none";
            document.getElementById("TemplateScripTempPane").style.display = "none";
            document.getElementById("TemplateAssignmentTempPane").style.display = "none";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "none";
            document.getElementById("TemplateEmailSPane").style.display = "none";
        }

        if (FinalTypeNow == "SessionHostTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "none";
            document.getElementById("TemplateSessionHostPane").style.display = "block";
            document.getElementById("TemplateFSLogixPane").style.display = "none";
            document.getElementById("TemplateImagePane").style.display = "none";
            document.getElementById("TemplateScripTempPane").style.display = "none";
            document.getElementById("TemplateAssignmentTempPane").style.display = "none";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "none";
            document.getElementById("TemplateEmailSPane").style.display = "none";

        }
        if (FinalTypeNow == "ImageTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "none";
            document.getElementById("TemplateSessionHostPane").style.display = "none";
            document.getElementById("TemplateFSLogixPane").style.display = "none";
            document.getElementById("TemplateImagePane").style.display = "block";
            document.getElementById("TemplateScripTempPane").style.display = "none";
            document.getElementById("TemplateAssignmentTempPane").style.display = "none";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "none";
            document.getElementById("TemplateEmailSPane").style.display = "none";
        }
        if (FinalTypeNow == "FSLogixTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "none";
            document.getElementById("TemplateSessionHostPane").style.display = "none";
            document.getElementById("TemplateFSLogixPane").style.display = "block";
            document.getElementById("TemplateImagePane").style.display = "none";
            document.getElementById("TemplateScripTempPane").style.display = "none";
            document.getElementById("TemplateAssignmentTempPane").style.display = "none";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "none";
            document.getElementById("TemplateEmailSPane").style.display = "none";

        }
        if (FinalTypeNow == "ScriptTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "none";
            document.getElementById("TemplateSessionHostPane").style.display = "none";
            document.getElementById("TemplateFSLogixPane").style.display = "none";
            document.getElementById("TemplateImagePane").style.display = "none";
            document.getElementById("TemplateScripTempPane").style.display = "block";
            document.getElementById("TemplateAssignmentTempPane").style.display = "none";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "none";
            document.getElementById("TemplateEmailSPane").style.display = "none";

        }
        if (FinalTypeNow == "AssignmentTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "none";
            document.getElementById("TemplateSessionHostPane").style.display = "none";
            document.getElementById("TemplateFSLogixPane").style.display = "none";
            document.getElementById("TemplateImagePane").style.display = "none";
            document.getElementById("TemplateScripTempPane").style.display = "none";
            document.getElementById("TemplateAssignmentTempPane").style.display = "block";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "none";
            document.getElementById("TemplateEmailSPane").style.display = "none";

        }
        if (FinalTypeNow == "AppTemplate") {
            document.getElementById("TemplateHostPoolPane").style.display = "none";
            document.getElementById("TemplateSessionHostPane").style.display = "none";
            document.getElementById("TemplateFSLogixPane").style.display = "none";
            document.getElementById("TemplateImagePane").style.display = "none";
            document.getElementById("TemplateScripTempPane").style.display = "none";
            document.getElementById("TemplateAssignmentTempPane").style.display = "none";
            document.getElementById("TemplateAppTemplatePaneD").style.display = "block";
            document.getElementById("TemplateEmailSPane").style.display = "none";

        }

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/LoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': FinalSelTempNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'TemplateAttrTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableImages = document.createElement("table");
                    datatableImages.id = 'TenImagesTableNow'
                    datatableImages.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckFRow == "TENIMAGES" || CheckFRow == "LOCATIONS") {

                            if (CheckFRow == "TENIMAGES") {

                                var row = datatableImages.insertRow(-1);

                                if (CheckSRow == "Image Name") {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[4];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";


                                } else {

                                    if (CheckFRow == "" || CheckFRow == null) {

                                    } else {

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[1];

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[2];

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[4];

                                    }

                                }

                            }
                        } else {

                            var row = datatable.insertRow(-1);
                            if (CheckFRow == "Parameter" || CheckFRow == "Assignment Name") {
                                for (var j = 0; j < cells.length; j++) {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[j];

                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    if (CheckFRow == "Parameter") {
                                        cell.style.minWidth = "280px";
                                        cell.style.maxWidth = "280px";
                                    }
                                    if (CheckFRow == "Value") {
                                        cell.style.minWidth = "400px";
                                        cell.style.maxWidth = "400px";
                                    }

                                }
                            } else {

                                if (CheckFRow == "" || CheckFRow == null) {

                                } else {

                                    if (FinalTypeNow == "FSLogixTemplate") {

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[0];
                                        cell.style.background = "#f7f7f7";
                                        cell.style.fontWeight = "500";
                                        cell.spellcheck = "false";

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[1];
                                        cell.style.background = "white";
                                        cell.contentEditable = "true";
                                        cell.spellcheck = "false";

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[2];
                                        cell.style.background = "#f7f7f7";
                                        cell.contentEditable = "true";

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[3];
                                        cell.style.background = "#f7f7f7";
                                        cell.contentEditable = "true";

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[4];
                                        cell.style.background = "#f7f7f7";

                                    }

                                    if (FinalTypeNow == "SessionHostTemplate" || FinalTypeNow == "HostPoolTemplate" || FinalTypeNow == "ImageTemplate" || FinalTypeNow == "ScriptTemplate" || FinalTypeNow == "AppTemplate" || FinalTypeNow == "EmailTemplate") {

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[0];
                                        cell.style.background = "#f7f7f7";
                                        cell.style.fontWeight = "500";
                                        cell.spellcheck = "false";

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[1];
                                        cell.style.background = "white";
                                        cell.contentEditable = "true";
                                        cell.spellcheck = "false";
                                        cell.style.minWidth = "400px";
                                        cell.style.maxWidth = "400px";

                                        if (FinalTypeNow == "SessionHostTemplatesssss") {

                                            if (cells[0] == "Administrator Password") {
                                                var ShowPassButton = '<button id = ' + ShadowAttr + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="SessShortActionShadowFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Show Password</button>'
                                            }
                                        }

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[2];
                                        cell.style.background = "#f7f7f7";


                                    }

                                    if (FinalTypeNow == "AssignmentTemplate") {

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[0];
                                        cell.style.background = "#f7f7f7";
                                        cell.style.fontWeight = "500";
                                        cell.contentEditable = "true";
                                        cell.spellcheck = "false";

                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[1];
                                        cell.style.background = "white";
                                        cell.contentEditable = "true";
                                        cell.spellcheck = "false";


                                    }

                                    if (FinalTypeNow == "SessionHostTemplate") {

                                        var CheckThisAttr = cells[0];
                                        var ThisAttrValue = cells[1];

                                        if (CheckThisAttr == "Host Pool Location") {
                                            var ThisTextNow = "Select VM Size for Location: " + ThisAttrValue;
                                            document.getElementById("SelVMSizeForLocSel").innerHTML = ThisTextNow;
                                        }
                                    }

                                    if (FinalTypeNow == "EmailTemplate") {

                                        var CheckThisAttr = cells[0];
                                        var ThisAttrValue = cells[1];

                                        if (CheckThisAttr == "Email To") {
                                            document.getElementById("EmailTempEmailToATTR").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "SMTP Server") {
                                            document.getElementById("EmailSTMPServerATTR").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "SMTP Port") {
                                            document.getElementById("EmailSMTPPortATTR").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "Use SSL") {
                                            document.getElementById("EmailUseSSLOrNotATTR").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "Sender Email") {
                                            document.getElementById("EmailSenderEmailATTR").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "Sender Username") {
                                            document.getElementById("EmailSenderUserNameATTR").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "Sender Password") {
                                            document.getElementById("EmailSenderPasswordATTR").value = ThisAttrValue;
                                        }


                                    }

                                    if (FinalTypeNow == "HostPoolTemplate") {

                                        var CheckThisAttr = cells[0];
                                        var ThisAttrValue = cells[1];

                                        if (CheckThisAttr == "Host Pool Type") {
                                            document.getElementById("OPTTempPoolType").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "Host Pool Location") {
                                            document.getElementById("OPTHostPoolAllLocs").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "Load Balancing Mechanism") {
                                            document.getElementById("OPTHostPoolBalMech").value = ThisAttrValue;
                                        }
                                        if (CheckThisAttr == "Maximum Sessions Limit") {
                                            document.getElementById("MaxSessLimitID").value = ThisAttrValue;
                                        }
                                    }


                                }

                            }

                        }
                    }

                    var dtable = document.getElementById("SelTempParaDivData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("AllTenImagesNow");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableImages);

                    var tableRT = document.getElementById('TenImagesTableNow');
                    var cells = tableRT.getElementsByTagName('td');
                    for (var i = 0; i < cells.length; i++) {
                        // Take each cell
                        var cell = cells[i];
                        // do something on onclick event for cell
                        cell.onclick = function() {
                            // Get the row id where the cell exists

                            var rowId = this.parentNode.rowIndex;
                            var rowsNotSelected = tableRT.getElementsByTagName('tr');
                            for (var row = 0; row < rowsNotSelected.length; row++) {
                                rowsNotSelected[row].style.color = "#666666";
                                rowsNotSelected[row].style.background = "white";
                                rowsNotSelected[row].classList.remove('selected');
                            }
                            var rowSelected = tableRT.getElementsByTagName('tr')[rowId];
                            rowSelected.style.color = "black";
                            rowSelected.style.background = "#B1EDFF";
                            rowSelected.className += "selected";
                            var ImageID = rowSelected.cells[2].innerHTML;
                            document.getElementById("SelectedImageIDforTenN").innerHTML = ImageID;
                        }
                    }

                    if (FinalTypeNow == "FSLogixTemplate") {
                        var tableRTc = document.getElementById('TemplateAttrTable');
                        var cells = tableRTc.getElementsByTagName('td');
                        for (var i = 0; i < cells.length; i++) {
                            // Take each cell
                            var cell = cells[i];
                            // do something on onclick event for cell
                            cell.onclick = function() {
                                // Get the row id where the cell exists

                                var rowId = this.parentNode.rowIndex;
                                var rowsNotSelected = tableRTc.getElementsByTagName('tr');
                                for (var row = 0; row < rowsNotSelected.length; row++) {
                                    rowsNotSelected[row].style.color = "#666666";
                                    rowsNotSelected[row].style.background = "white";
                                    rowsNotSelected[row].classList.remove('selected');
                                }

                                var rowSelected = tableRTc.getElementsByTagName('tr')[rowId];
                                rowSelected.style.color = "black";
                                rowSelected.style.background = "#B1EDFF";
                                rowSelected.className += "selected";

                                var ThisToRemove = rowSelected.cells[0].innerHTML;
                                document.getElementById("SelectedImageIDforTenN").innerHTML = ThisToRemove;
                            }
                        }



                    }



                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });


    $("#RefAndAllImagesNow").click(function(e) {

        document.getElementById("CollectImagesCircle").style.display = "block";

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            var table, rows, i, x, y, ThisTenNow;
            table = document.getElementById("TemplateAttrTable");
            rows = table.rows;
            for (i = 0; i < (rows.length); i++) {

                x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                finaltennow = rows[i].getElementsByTagName("TD")[1].innerHTML;
                if (x == "Applies To Tenant") {
                    ThisTenNow = finaltennow;
                }
            }

            var TRPKey = document.getElementById("TRPKeyN").value;

            e.preventDefault();
            $.ajax({
                url: '/GetHostTemplateImagesFile', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTenNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {
                        if (data.message == "FileNotFound") {

                            if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                                document.getElementById("CollectImagesCircle").style.display = "none";
                            }
                        } else {
                            GetAllImagesNowFunction(data.message)
                            document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                            document.getElementById("RefAllTaskRunningListButton").click();

                            document.getElementById("CollectImagesCircle").style.display = "none";

                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });

    $("#FetchAllImagesNow").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("CollectImagesCircle").style.display = "block";

            var SelTempNow = document.getElementById("AllAvaTempltesOpt").value;

            var res = SelTempNow.split(":");
            var FinalSelTempNow = res[0];
            var FinalTypeNow = res[1];

            var TRPKey = document.getElementById("TRPKeyN").value;

            e.preventDefault();
            $.ajax({
                url: '/FetchAllImages', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'SelTempNow': FinalSelTempNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "FETCHIMAGES";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });

    function GetAllImagesNowFunction(ThisCompleteData) {

        document.getElementById("CollectImagesCircle").style.display = "block";

        var datatableImages = document.createElement("table");
        datatableImages.id = 'TenImagesTableNow'
        datatableImages.setAttribute('class', 'SummaryTableClassforAzBilling');

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");

            var CheckFRow = cells[0];
            var CheckSRow = cells[0];

            var row = datatableImages.insertRow(-1);

            if (CheckSRow == "Image Name") {

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[0];
                cell.style.backgroundColor = "white";
                cell.style.color = "#066d95";
                cell.style.textAlign = "left";
                cell.style.letterSpacing = "0px";
                cell.style.fontWeight = "600";
                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                cell.style.position = "sticky";
                cell.style.zIndex = "22";
                cell.style.top = "0px";
                cell.style.fontSize = "12px";
                cell.style.fontFamily = "Calibri";

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[1];
                cell.style.backgroundColor = "white";
                cell.style.color = "#066d95";
                cell.style.textAlign = "left";
                cell.style.letterSpacing = "0px";
                cell.style.fontWeight = "600";
                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                cell.style.position = "sticky";
                cell.style.zIndex = "22";
                cell.style.top = "0px";
                cell.style.fontSize = "12px";
                cell.style.fontFamily = "Calibri";

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[3];
                cell.style.backgroundColor = "white";
                cell.style.color = "#066d95";
                cell.style.textAlign = "left";
                cell.style.letterSpacing = "0px";
                cell.style.fontWeight = "600";
                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                cell.style.position = "sticky";
                cell.style.zIndex = "22";
                cell.style.top = "0px";
                cell.style.fontSize = "12px";
                cell.style.fontFamily = "Calibri";


            } else {

                if (CheckFRow == "" || CheckFRow == null) {

                } else {

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[0];

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[1];

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[3];

                }

            }

        }

        var dtable = document.getElementById("AllTenImagesNow");
        dtable.innerHTML = "";
        dtable.appendChild(datatableImages);

        document.getElementById("CollectImagesCircle").style.display = "none";

        var tableRT = document.getElementById('TenImagesTableNow');
        var cells = tableRT.getElementsByTagName('td');
        for (var i = 0; i < cells.length; i++) {
            // Take each cell
            var cell = cells[i];
            // do something on onclick event for cell
            cell.onclick = function() {
                // Get the row id where the cell exists

                var rowId = this.parentNode.rowIndex;
                var rowsNotSelected = tableRT.getElementsByTagName('tr');
                for (var row = 0; row < rowsNotSelected.length; row++) {
                    rowsNotSelected[row].style.color = "#666666";
                    rowsNotSelected[row].style.background = "white";
                    rowsNotSelected[row].classList.remove('selected');
                }
                var rowSelected = tableRT.getElementsByTagName('tr')[rowId];
                rowSelected.style.color = "black";
                rowSelected.style.background = "#B1EDFF";
                rowSelected.className += "selected";

                var ImageID = rowSelected.cells[2].innerHTML;
                document.getElementById("SelectedImageIDforTenN").innerHTML = ImageID;
            }
        }

        document.getElementById("CollectImagesCircle").style.display = "none";

    }

    $("#ApplySelectedImageToTemp").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Apply Selected Image to Session Host Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "APPLYIMAGENOW";

    });

    $("#AppPoolSettingsID").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Apply Pool Settings to Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "APPLYHOSTPOOLSET";

    });

    $("#AppAppSettingsForTSel").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Apply Application Settings to Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "APPLYAPPSETTOTEMP";

    });

    $("#AddNewFSLogixEntNow").click(function(e) {

        var Param = document.getElementById("EnterRegEntryNameFLD").value;
        var PropType = document.getElementById("FSLogixPropTypeH").value;
        var PropValue = document.getElementById("EntFSLogixPropValueHere").value;
        var RegLocation = document.getElementById("FSLogixEntRegLocationN").value;

        var table = document.getElementById("TemplateAttrTable");
        var row = table.insertRow(-1);

        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);

        cell1.innerHTML = Param;
        cell2.innerHTML = PropType;
        cell3.innerHTML = PropValue;
        cell4.innerHTML = RegLocation;

    });

    $("#AddAssAddToListButton").click(function(e) {

        var assvalue = document.getElementById("AddAssAssignmentValue").value;
        var asstype = document.getElementById("AddAssAssTypeNow").value;
        var AssAppGroupName = document.getElementById("AssAssignmentAppGroupNRD").value;
        var AssResGroupName = document.getElementById("AddAssignmentResGroupND").value;

        var FinalItem = asstype + ":" + AssAppGroupName + ":" + AssResGroupName;

        var table = document.getElementById("TemplateAttrTable");
        var row = table.insertRow(-1);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        cell1.innerHTML = assvalue;
        cell1.style.contentEditable = true;
        cell2.innerHTML = FinalItem;
        cell2.style.contentEditable = true;

    });

    $("#ApplyScriptSettingsButton").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Apply Script settings to Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "APPLYSCRIPTSET";

    });
    $("#SaveCurTemplte").click(function(e) {

        var AllOk = "Ok"

        var SelTempNow = document.getElementById("AllAvaTempltesOpt").value;
        var res = SelTempNow.split(":");
        var FinalSelTempNow = res[0];
        var FinalTypeNow = res[1];

        if (FinalTypeNow == "SessionHostTemplatessssss") {

            var table, rows, i, x, y, shouldSwitch;
            table = document.getElementById("TemplateAttrTable");
            rows = table.rows;
            for (i = 1; i < (rows.length - 1); i++) {

                x = rows[i].getElementsByTagName("TD")[1].innerHTML;

                if (x == null || x == "" || x == "BLANK") {

                    rows[i].getElementsByTagName("TD")[1].style.color = "red";
                    rows[i].getElementsByTagName("TD")[1].innerHTML = "BLANK";
                    AllOk = "NotOk"
                }
            }
        }

        if (AllOk == "NotOk") {
            var ThisMsg = "Error: Some fields are blank in Session Host Template."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }
        }

        if (AllOk == "Ok") {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Save Template Attributes?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "SAVETEMPATTR";
        }

    });

    $("#UpdateCurTempID").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "The process will collect Session Host values to be filled in the Host Template. Update Info?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "UPDATEINFO";

    });

    $("#UpdateCurTempID").click(function(e) {

        var SelTempNow = document.getElementById("AllAvaTempltesOpt").value;
        var res = SelTempNow.split(":");
        var FinalTypeNow = res[1];

        if (FinalTypeNow == "SessionHostTemplate") {

            // Update here.

        } else {

            var ThisMsg = "Action is applicable to Session Host Templates"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        }

    });


    $("#AVDTempSelONE").click(function(e) {

        document.getElementById("SelAVDScreenType").innerHTML = "Host Pool & Business Unit";

        document.getElementById("ResetAllColor").click();
        document.getElementById("AVDTempSelONE").style.background = "black";

        document.getElementById("AVDSCreenOne").style.display = "block";
        document.getElementById("AVDSCreenTwo").style.display = "none";
        document.getElementById("AVDSCreenThree").style.display = "none";
        document.getElementById("AVDSCreenFour").style.display = "none";
        document.getElementById("AVDSCreenFive").style.display = "none";

    });

    $("#AVDTempSelTWO").click(function(e) {

        document.getElementById("SelAVDScreenType").innerHTML = "Session Host Virtual Machines";

        document.getElementById("ResetAllColor").click();
        document.getElementById("AVDTempSelTWO").style.background = "black";

        document.getElementById("AVDSCreenOne").style.display = "none";
        document.getElementById("AVDSCreenTwo").style.display = "block";
        document.getElementById("AVDSCreenThree").style.display = "none";
        document.getElementById("AVDSCreenFour").style.display = "none";
        document.getElementById("AVDSCreenFive").style.display = "none";

        CheckFileSizeNowFunction()

    });

    $("#AVDTempSelTHREE").click(function(e) {

        document.getElementById("SelAVDScreenType").innerHTML = "Session Hosts Image";

        document.getElementById("ResetAllColor").click();
        document.getElementById("AVDTempSelTHREE").style.background = "black";

        document.getElementById("AVDSCreenOne").style.display = "none";
        document.getElementById("AVDSCreenTwo").style.display = "none";
        document.getElementById("AVDSCreenThree").style.display = "none";
        document.getElementById("AVDSCreenFour").style.display = "block";
        document.getElementById("AVDSCreenFive").style.display = "none";

        DiskImageSelOrNotFunction()
        AVDTemplateAllFetchImages()

    });

    $("#AVDTempSelFOUR").click(function(e) {

        document.getElementById("SelAVDScreenType").innerHTML = "Session Hosts Networking";

        document.getElementById("ResetAllColor").click();
        document.getElementById("AVDTempSelFOUR").style.background = "black";

        document.getElementById("AVDSCreenOne").style.display = "none";
        document.getElementById("AVDSCreenTwo").style.display = "none";
        document.getElementById("AVDSCreenThree").style.display = "block";
        document.getElementById("AVDSCreenFour").style.display = "none";
        document.getElementById("AVDSCreenFive").style.display = "none";

        document.getElementById("AVDvNetAddressSpaceN").value = "10.0.0.0/16";
        document.getElementById("AVDSubNetAddressSpaceN").value = "10.0.0.0/24";


    });

    $("#AVDTempSelFIVE").click(function(e) {

        document.getElementById("SelAVDScreenType").innerHTML = "Other Settings";

        document.getElementById("ResetAllColor").click();
        document.getElementById("AVDTempSelFIVE").style.background = "black";

        document.getElementById("AVDSCreenOne").style.display = "none";
        document.getElementById("AVDSCreenTwo").style.display = "none";
        document.getElementById("AVDSCreenThree").style.display = "none";
        document.getElementById("AVDSCreenFour").style.display = "none";
        document.getElementById("AVDSCreenFive").style.display = "block";

    });

    $("#GetAllVMSForSelLoc").click(function(e) {

        document.getElementById("CollectVMSizesCircleN").style.display = "block";

        var ThisLoc = document.getElementById("AVDAzureLocation").value;
        var ThisTenant = document.getElementById("AVDTempCreateAllTenList").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/GetAllVMSForSelLoc', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'VMSForLoc': ThisLoc,
                'ThisTenant': ThisTenant,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    document.getElementById("WhatToGetFromServer").innerHTML = "COLLECTVMSIZES";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    function CheckFileSizeNowFunction() {

        var ThisLoc = document.getElementById("AVDAzureLocation").value;
        var ThisTenant = document.getElementById("AVDTempCreateAllTenList").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CallCheckVMSizeFileStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'VMSForLoc': ThisLoc,
                'ThisTenant': ThisTenant,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {

                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("CollectVMSizesCircleN").style.display = "none";
                        }

                    } else {
                        AppendVMSizesNow(data.message)
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("RefAllTaskRunningListButton").click();

                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                        document.getElementById("CollectVMSizesCircleN").style.display = "none";

                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    }

    function AppendVMSizesNow(ThisCompleteData) {
        document.getElementById("CollectVMSizesCircleN").style.display = "block";

        var ThisMsg = "Refreshing VM Sizes in Location. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var xLeft = document.getElementById("AVDSelVMSizeN");
        var options = document.querySelectorAll('#AVDSelVMSizeN option');
        options.forEach(o => o.remove());

        let res = ThisCompleteData.replaceAll('"', "");

        var rows = res.split("\n");
        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");
            if (cells.length > 1) {

                var newcell = cells[0];

                var optionR = document.createElement("option");
                optionR.text = newcell;
                xLeft.add(optionR);

            }
        }

    }

    $("#CreateAVDTempNowA").click(function(e) {
        // Create Template Here

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Create AVD Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CREATEAVDTEMPLATE";


    });


}
// END: TEMPLATE CREATION AND ALL OTHER

// START: ASSIGNMENT PANEL
{

    function UnAssignOrAssignUserFunction(ThisIDNow) {

        var ThisUserID = ThisIDNow
        var res = ThisUserID.split(":");
        var FinalUserIDNow = res[0];
        var FinalGroupNow = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to UnAssign User from Application Group: " + FinalUserIDNow + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ASSANDUNUSER";
        document.getElementById("ForMultiStringID").innerHTML = ThisIDNow;

    }

    $("#RemoveSelAssID").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {


        }
    });

    $("#ExportAssignmentsForTenID").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {


        }
    });

    $("#FilterAssignmentsID").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {


        }
    });

    $("#CheckAssVDIStatus").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {


        }
    });

    $("#QuickAssRemAssignment").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Assignment will be removed from the Application Group?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "QUICKUNASSIGNUSER";

    });

    $("#QuickAssAddAssignment").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Add Assignment and assign to the Application Group?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "QUICKADDSINGLEASS";

    });

    $("#AddSingleAssignmentButton").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Add Assignments and assign to the Application Group?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ADDBULKASSNOW";

    });


    $("#AddNewAssNow").click(function(e) {

        document.getElementById("AddNewAssignmentsPanel").style.display = "block";

        var WhenToLoad = "SINGLE"
        FuncLoadAppGroupAndResGroupsForAssignments(WhenToLoad)

    });

    function FuncLoadAppGroupAndResGroupsForAssignments(WhenToLoad) {

        var SelTenNow = document.getElementById("ManageAssTenListNV").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadTenAppGroups', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: true,
            timeout: 50000,
            data: {
                'SelTenNow': SelTenNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) { // That means if there is data available

                    if (WhenToLoad == "SWITCH") {
                        var xLeft = document.getElementById("QuickAddAsAppGroupName");
                        var options = document.querySelectorAll('#QuickAddAsAppGroupName option');
                        options.forEach(o => o.remove());
                    }
                    if (WhenToLoad == "SINGLE") {
                        var xLeft = document.getElementById("AddAsAppGroupName");
                        var options = document.querySelectorAll('#AddAsAppGroupName option');
                        options.forEach(o => o.remove());
                    }


                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'AppGroup') {} else {
                                if (newcell == "" || newcell == null) {} else {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);

                                }
                            }

                        }
                    }


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    document.getElementById("SuperNovaStatusID").style.color = "red";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
            }
        });


        $.ajax({
            url: '/LoadTenResGroups', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: true,
            timeout: 50000,
            data: {
                'SelTenNow': SelTenNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) { // That means if there is data available

                    if (WhenToLoad == "SWITCH") {

                        var xLeft = document.getElementById("QuickAssAddResGroupName");
                        var options = document.querySelectorAll('#QuickAssAddResGroupName option');
                        options.forEach(o => o.remove());

                    } else {

                        var xLeft = document.getElementById("AssAddResGroupName");
                        var options = document.querySelectorAll('#AssAddResGroupName option');
                        options.forEach(o => o.remove());
                    }

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == 'ResGroup') {} else {
                                if (newcell == "" || newcell == null) {} else {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);

                                }
                            }

                        }
                    }


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    document.getElementById("SuperNovaStatusID").style.color = "red";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
            }
        });


    }

    $("#CloseAssignmentModal").click(function(e) {

        document.getElementById("AddNewAssignmentsPanel").style.display = "none";

    });

    $("#ManAssSwitchToSelTenNN").click(function(e) {


        document.getElementById("CollectingAssCircle").style.display = "block";

        var SelTen = document.getElementById("ManageAssTenListNV").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        var ThisTen = document.getElementById("ManageAssTenListNV").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckTenAssignmentFile', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {
                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("CollectingAssCircle").style.display = "none";
                        }

                    } else {
                        document.getElementById("RefAllTaskRunningListButton").click();
                        GetUserAssignmentDataFunction(data.message)
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("CollectingAssCircle").style.display = "none";
                    }


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    function GetUserAssignmentDataFunction(ThisCompleteData) {
        // Check Status here and load logs

        var TotAssUsers = 0;
        var TotAssGroups = 0;
        var TotVDIJoined = 0;
        var TotVDINotJoined = 0;

        var datatable = document.createElement("table");
        datatable.id = 'AssignmentTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");
            var row = datatable.insertRow(-1);

            var CheckFRow = cells[0];

            if (CheckFRow == "ENDOFDATA") {

            } else {

                if (CheckFRow == "Display Name") {
                    for (var j = 0; j < cells.length; j++) {

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[j];

                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";

                    }
                } else {

                    var CheckIfBlank = cells[0]

                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                        UPNNew = cells[1];
                        ResGroup = cells[4];

                        var UnAssignUser = '<button id = ' + UPNNew + ":" + ResGroup + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; float:right;margin-top: 0px;outline:none;" onclick="UnAssignOrAssignUserFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>UnAssign</button>'
                        var ShowUsers = '<button id = ' + cells[6] + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="ShowUsersForGroupFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Show Users</button>'
                        var CheckVDIStatus = '<button id = ' + UPNNew + "_UNASSIGN" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="CheckVDIStatusForUSer(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Check VDI Status</button>'

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[0] + UnAssignUser;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[1];

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[2];

                        if (cells[3] == "Group") {
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[3] + ShowUsers;
                            ++TotAssGroups;
                        } else {
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[3];
                            ++TotAssUsers;
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[4];

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[5] + CheckVDIStatus;
                        if (cells[5] == "Joined") {
                            cell.style.color = "green";
                            ++TotVDIJoined;

                        }
                        if (cells[5] == "Not Joined") {
                            cell.style.color = "rgb(249, 99, 25)";
                            ++TotVDINotJoined;
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[6];

                    }
                }

            }
        }

        var dtable = document.getElementById("AVDAssResultDIV");
        dtable.innerHTML = "";
        dtable.appendChild(datatable);

        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

        var WhenToLoad = "SWITCH"
        FuncLoadAppGroupAndResGroupsForAssignments(WhenToLoad)

        document.getElementById("AssignmentPanelTotUsersN").innerHTML = TotAssUsers;
        document.getElementById("AssignmentPanelTotGroupsN").innerHTML = TotAssGroups;
        document.getElementById("AssignmentPanelTotVDIJoinedUser").innerHTML = TotVDIJoined;
        document.getElementById("AssignmentPanelTotVDINotJoinedUsersN").innerHTML = TotVDINotJoined;

    }

    $("#RefAllAssignmentsID").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("NotRunningC").style.display = "block";

            document.getElementById("CollectingAssCircle").style.display = "block";

            var ThisTen = document.getElementById("ManageAssTenListNV").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/RefAssignmentItems', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "ASSIGNMENTITEMS";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });




}

// END: ASSIGNMENT PANEL

// START: DEPlOYMENT HOST POOL
{

    $("#DEPLRefAllPoolTemps").click(function(e) {

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("DEPLAllAvaPoolTemplates");
                    var options = document.querySelectorAll('#DEPLAllAvaPoolTemplates option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {
                                    if (CheckTType == "HostPoolTemplate") {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLOpenSelHostPoolTemplate").click(function(e) {

        var SelTempNow = document.getElementById("DEPLAllAvaPoolTemplates").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        document.getElementById("SelTempAVDNow").innerHTML = "Template Attributes: " + SelTempNow;
        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/DEPLLoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': SelTempNow,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'DeplHostPoolAttrTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableHostPool = document.createElement("table");
                    datatableHostPool.id = 'DeplHostPoolDeplLog'
                    datatableHostPool.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];

                        if (CheckFRow == "DEPLLOG") {

                            if (cells[1] == "ENDOFDATA") {

                            } else {

                                var row = datatableHostPool.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.background = "white";

                                if (cells[1] == "Phase-1-Connecting" || cells[1] == "Phase-2-Deploying") {
                                    cell.style.background = "aliceblue";
                                    cell.style.fontWeight = "700";
                                }

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.background = "white";

                                if (cells[1] == "Phase-1-Connecting" || cells[1] == "Phase-2-Deploying") {
                                    cell.style.background = "aliceblue";
                                    cell.style.fontWeight = "700";
                                }
                            }

                        } else {

                            var row = datatable.insertRow(-1);

                            if (CheckFRow == "Parameter") {
                                for (var j = 0; j < cells.length; j++) {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[j];

                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                }
                            } else {

                                if (cells[0] == "" || cells[0] == null) {} else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    cell.style.background = "#f7f7f7";
                                    cell.style.fontWeight = "500";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.background = "white";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.background = "#f7f7f7";
                                }
                            }

                        }




                    }

                    var dtable = document.getElementById("DEPLHostPoolTempAttrDIV");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableHostPool);

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#DeplHostPoolNOWBUTTON").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to start the deployment of Host Pool"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "DEPLOYHOSTPOOL";

    });

    function checkHostPoolDeplStatus() {
        // Check Status here and load logs

        document.getElementById("DEPLHosPoolStatusONE").style.display = "block";

        var myTimerHostPoolStatus = setInterval(function() { FuncGetHostPoolDeplStatus() }, 5000);

        function FuncGetHostPoolDeplStatus() {

            var datatable = document.createElement("table");
            datatable.id = 'HostPoolDeplStatusTable'
            datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

            var PoolTemplateName = document.getElementById("DEPLAllAvaPoolTemplates").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            $.ajax({
                url: '/GetHostPoolDeplLog', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'PoolTempName': PoolTemplateName,
                    'ThisUser': FinalUserNameNow
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            var row = datatable.insertRow(-1);

                            var CheckFRow = cells[0];

                            if (CheckFRow == "ENDOFDATA") {

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";
                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                                clearInterval(myTimerHostPoolStatus); // Clear Timer here to ensure it doesn't run once again and then append below data
                                document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                            } else {

                                if (CheckFRow == "Phase-1-Connecting") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "block";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "none";

                                }
                                if (CheckFRow == "Phase-2-Deploying") {

                                    document.getElementById("DEPLHosPoolStatusONE").style.display = "none";
                                    document.getElementById("DEPLHosPoolStatusTWO").style.display = "block";
                                }

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";

                                        if (cells[1] == "Phase-1-Connecting" || cells[1] == "Phase-2-Deploying") {
                                            cell.style.background = "aliceblue";
                                            cell.style.fontWeight = "700";
                                        }

                                    }
                                }

                                var dtable = document.getElementById("DEPLHostPoolProcessingLogDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });


        }




    }

}
// END: DEPlOYMENT HOST POOL

// START: DEPlOYMENT SESSION HOST
{


    $("#DEPLHostDeplNow").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to start the deployment of Session Hosts from Template"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "DEPLSESSHOST";

    });

    function checkSessHostDeplStatus() {
        // Check Status here and load logs

        document.getElementById("HostDeplCircleNN").style.display = "block";

        var myTimerSessHostStatus = setInterval(function() { FuncGetSessHostDeplStatus() }, 5000);

        function FuncGetSessHostDeplStatus() {

            var datatable = document.createElement("table");
            datatable.id = 'SessHostDeplStatusTable'
            datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

            var HostTemplateName = document.getElementById("DEPLHostAllAvaTemplates").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            $.ajax({
                url: '/GetSessHostDeplLog', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'HostTemplate': HostTemplateName,
                    'ThisUser': FinalUserNameNow
                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            var row = datatable.insertRow(-1);

                            var CheckFRow = cells[0];

                            if (CheckFRow == "ENDOFDATA") {

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";
                                    }
                                }

                                var dtable = document.getElementById("DEPLHostProcLogBelowDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                                clearInterval(myTimerSessHostStatus); // Clear Timer here to ensure it doesn't run once again and then append below data
                                document.getElementById("HostDeplCircleNN").style.display = "none";


                            } else {

                                for (var j = 0; j < cells.length; j++) {
                                    var CheckIfBlank = cells[0]
                                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[j];
                                        cell.style.background = "white";

                                        if (cells[1] == "Phase-1-Connecting" || cells[1] == "Phase-2-Deploying") {
                                            cell.style.background = "aliceblue";
                                            cell.style.fontWeight = "700";
                                        }

                                    }
                                }

                                var dtable = document.getElementById("DEPLHostProcLogBelowDIV");
                                dtable.innerHTML = "";
                                dtable.appendChild(datatable);

                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });


        }




    }


    $("#DEPLSessionHostRefTemplates").click(function(e) {

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("DEPLHostAllAvaTemplates");
                    var options = document.querySelectorAll('#DEPLHostAllAvaTemplates option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {
                                    if (CheckTType == "SessionHostTemplate") {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    $("#DEPLHostOpenSelTemplate").click(function(e) {

        var SelTempNow = document.getElementById("DEPLHostAllAvaTemplates").value;

        document.getElementById("DEPLHostSelTempAttributesID").innerHTML = "Template Attributes: " + SelTempNow;
        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/DEPLLoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': SelTempNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'DeplHostTemplateAttrTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableStatus = document.createElement("table");
                    datatableStatus.id = 'DeplHostsStatusTable'
                    datatableStatus.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];

                        if (CheckFRow == "HOSTSTATUS") {

                            var row = datatableStatus.insertRow(-1);

                            var CheckTRow = cells[1];

                            if (CheckTRow == "Host Name") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";


                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];

                            }

                        } else {

                            var row = datatable.insertRow(-1);

                            if (CheckFRow == "Parameter") {
                                for (var j = 0; j < cells.length; j++) {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[j];

                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                }
                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[0];
                                cell.style.background = "#f7f7f7";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.background = "white";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.background = "#f7f7f7";

                            }

                        }




                    }

                    var dtable = document.getElementById("DeplHostTempAttributesDATADiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("DEPLHostHostNumbersDataDIV");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableStatus);


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

}
// END: DEPlOYMENT HOST POOL

// START: NEW AVD DEPLOYMENT FUNCTIONS
{

    $("#AVDRefTemplaterNumbers").click(function(e) {

        var SelTenant = document.getElementById("DEPLAVDAvaTenListND").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/AVDDeployLoadAllDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTenant': SelTenant,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xUID = document.getElementById("SelUIdentifierN");
                    var options = document.querySelectorAll('#SelUIdentifierN option');
                    options.forEach(o => o.remove());

                    var xLeft = document.getElementById("AVDDeploySelectedHostPoolTemplate");
                    var options = document.querySelectorAll('#AVDDeploySelectedHostPoolTemplate option');
                    options.forEach(o => o.remove());

                    var xLeftTwo = document.getElementById("AVDDeploySelectedImageTemplate");
                    var optionsTwo = document.querySelectorAll('#AVDDeploySelectedImageTemplate option');
                    optionsTwo.forEach(o => o.remove());

                    var xLeftThree = document.getElementById("AVDDeploySelectedHostTemplate");
                    var optionsThree = document.querySelectorAll('#AVDDeploySelectedHostTemplate option');
                    optionsThree.forEach(o => o.remove());

                    var xLeftFour = document.getElementById("AVDDeploySelectedFSLogixTemplate");
                    var optionsFour = document.querySelectorAll('#AVDDeploySelectedFSLogixTemplate option');
                    optionsFour.forEach(o => o.remove());

                    var xLeftFive = document.getElementById("AVDDeploySelectedScriptTemplate");
                    var optionsFive = document.querySelectorAll('#AVDDeploySelectedScriptTemplate option');
                    optionsFive.forEach(o => o.remove());

                    var xLeftSix = document.getElementById("AVDSelectedAssTemplateNowN");
                    var optionsFive = document.querySelectorAll('#AVDSelectedAssTemplateNowN option');
                    optionsFive.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];

                            if (newcell == "AVDDEPNUMBER" || newcell == "TENUID") {

                                if (newcell == "AVDDEPNUMBER") {

                                    var TotHostPoolTemplates = cells[1];
                                    var TotImageTemplates = cells[2];
                                    var TotHostTemplates = cells[3];
                                    var TotFSLogixTemplates = cells[4];

                                    document.getElementById("SelTenantTotPoolTemplates").innerHTML = TotHostPoolTemplates;
                                    document.getElementById("SelTenantTotImageTemplates").innerHTML = TotImageTemplates;
                                    document.getElementById("SelTenantTotHostTemplates").innerHTML = TotHostTemplates;
                                    document.getElementById("SelTenantTotFSLogixTemplates").innerHTML = TotFSLogixTemplates;
                                }

                                if (newcell == "TENUID") {

                                    var optionR = document.createElement("option");
                                    optionR.text = cells[1];
                                    xUID.add(optionR);
                                }


                            } else {

                                var rUName = cells[0];
                                var CheckTType = cells[3];
                                var AppTenant = cells[1];

                                if (rUName == 'TemplateName') {} else {
                                    if (rUName == "" || rUName == null) {} else {

                                        if (CheckTType == "HostPoolTemplate") {
                                            if (AppTenant == SelTenant) {
                                                var optionR = document.createElement("option");
                                                optionR.text = newcell;
                                                xLeft.add(optionR);
                                            }
                                        }

                                        if (CheckTType == "ImageTemplate") {
                                            if (AppTenant == SelTenant) {
                                                var optionR = document.createElement("option");
                                                optionR.text = newcell;
                                                xLeftTwo.add(optionR);
                                            }
                                        }

                                        if (CheckTType == "SessionHostTemplate") {
                                            if (AppTenant == SelTenant) {
                                                var optionR = document.createElement("option");
                                                optionR.text = newcell;
                                                xLeftThree.add(optionR);
                                            }
                                        }

                                        if (CheckTType == "FSLogixTemplate") {
                                            var optionR = document.createElement("option");
                                            optionR.text = newcell;
                                            xLeftFour.add(optionR);
                                        }
                                        if (CheckTType == "ScriptTemplate") {
                                            var optionR = document.createElement("option");
                                            optionR.text = newcell;
                                            xLeftFive.add(optionR);
                                        }
                                        if (CheckTType == "AssignmentTemplate") {
                                            var optionR = document.createElement("option");
                                            optionR.text = newcell;
                                            xLeftSix.add(optionR);
                                        }


                                    }

                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });
    });

    $("#GoLogUpDown").click(function(e) {

        if (document.getElementById("DeplHostPoolTempDataTWOUpRef").style.display == "none") {
            document.getElementById("DeplHostPoolTempDataTWOUpRef").style.display = "block";
        } else {
            document.getElementById("DeplHostPoolTempDataTWOUpRef").style.display = "none";
        }


    });

    $("#RefAvdDeplLogNButton").click(function(e) {

        //document.getElementById("SelIdentifierButtonNo").click();

    });


    $("#SelIdentifierButtonNo").click(function(e) {

        var SelUIdentifierN = document.getElementById("SelUIdentifierN").value;

        var SelTempNN = SelUIdentifierN + "_HostPool_Template"
        document.getElementById("AVDDeploySelectedHostPoolTemplate").value = SelTempNN;

        var SelTempNN = SelUIdentifierN + "_Image_Template"
        document.getElementById("AVDDeploySelectedImageTemplate").value = SelTempNN;

        var SelTempNN = SelUIdentifierN + "_SessionHost_Template"
        document.getElementById("AVDDeploySelectedHostTemplate").value = SelTempNN;

        var SelTempNN = SelUIdentifierN + "_FSLogix_Template"
        document.getElementById("AVDDeploySelectedFSLogixTemplate").value = SelTempNN;

        var SelTempNN = SelUIdentifierN + "_Script_Template"
        document.getElementById("AVDDeploySelectedScriptTemplate").value = SelTempNN;

        var SelTempNN = SelUIdentifierN + "_Assignment_Template"
        document.getElementById("AVDSelectedAssTemplateNowN").value = SelTempNN;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        document.getElementById("VerifyDepAttributesButton").click();


    });


    $("#VerifyDepAttributesButton").click(function(e) {

        document.getElementById("LoadingDeplTempForSelTenCircleTwo").style.display = "block";

        var SelHostPoolTemplate = document.getElementById("AVDDeploySelectedHostPoolTemplate").value;
        var SelImageTemplate = document.getElementById("AVDDeploySelectedImageTemplate").value;
        var SelSessionHostTemplate = document.getElementById("AVDDeploySelectedHostTemplate").value;
        var SelFSLogixTemplate = document.getElementById("AVDDeploySelectedFSLogixTemplate").value;
        var SelScriptTemplate = document.getElementById("AVDDeploySelectedScriptTemplate").value;
        var MultiThreadDepMode = document.getElementById("MultiThreadDepIsOff").checked;

        var DeployHostPoolORNot = "No";
        if (document.getElementById("AVDDeploySelectedHostPoolTempalteAndProcess").checked == true) {
            var DeployHostPoolORNot = "Yes";
        }
        var DeployImageOrNot = "No";
        if (document.getElementById("AVDDeploySelectedImageTempAndProcess").checked == true) {
            var DeployImageOrNot = "Yes";
        }
        var DeploySessionHostsOrNot = "No";
        if (document.getElementById("AVDDeploySelectedHostTemplateAndProcess").checked == true) {
            var DeploySessionHostsOrNot = "Yes";
        }
        var DeployFSLogixOrNot = "No";
        if (document.getElementById("AVDDeploySelectFSLogixTempAndProcess").checked == true) {
            var DeployFSLogixOrNot = "Yes";
        }
        var DeployScriptOrNot = "No";
        if (document.getElementById("AVDDeploySelectScriptTempAndProcess").checked == true) {
            var DeployScriptOrNot = "Yes";
        }
        var ProcessAssTemplateOrNot = "No";
        if (document.getElementById("AVDDeploySelectAssTemplateAndProcess").checked == true) {
            var ProcessAssTemplateOrNot = "Yes";
        }

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var UniID = document.getElementById("SelUIdentifierN").value;

        var TRPKey = document.getElementById("TRPKeyN").value;
        $.ajax({
            url: '/AVDDeployVerifyTemplate', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'HostPoolTemplate': SelHostPoolTemplate,
                'ImageTemplate': SelImageTemplate,
                'SessionHostTemplate': SelSessionHostTemplate,
                'FSLogixTemplate': SelFSLogixTemplate,
                'ScriptTemplate': SelScriptTemplate,
                'DeployHostPoolORNot': DeployHostPoolORNot,
                'DeployImageOrNot': DeployImageOrNot,
                'DeploySessionHostsOrNot': DeploySessionHostsOrNot,
                'DeployFSLogixOrNot': DeployFSLogixOrNot,
                'DeployScriptOrNot': DeployScriptOrNot,
                'ProcessAssTemplateOrNot': ProcessAssTemplateOrNot,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey,
                'UniID': UniID,
                'MultiThreadDep': MultiThreadDepMode
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'VerifiedTemplateAttrTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableHStataus = document.createElement("table");
                    datatableHStataus.id = 'AVDHostStatusTable'
                    datatableHStataus.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {

                        var cells = rows[i].split(",");

                        var FCellValue = cells[0];

                        if (FCellValue == "") {

                        } else {

                            if (FCellValue == "HOSTSTATUS") {

                                var CheckFirstV = cells[1];

                                var row = datatableHStataus.insertRow(-1);

                                if (CheckFirstV == "Host Name") {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";
                                    cell.style.width = "170px";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[4];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";


                                } else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[3];

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[4];


                                }


                            } else {

                                var row = datatable.insertRow(-1);

                                if (FCellValue == "Attribute") {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";
                                    cell.style.width = "170px";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.backgroundColor = "white";
                                    cell.style.color = "#066d95";
                                    cell.style.textAlign = "left";
                                    cell.style.letterSpacing = "0px";
                                    cell.style.fontWeight = "600";
                                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                    cell.style.position = "sticky";
                                    cell.style.zIndex = "22";
                                    cell.style.top = "0px";
                                    cell.style.fontSize = "12px";
                                    cell.style.fontFamily = "Calibri";


                                } else {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[0];
                                    cell.style.background = "white";

                                    if (cells[0] == "MultiThreading Deployment" || cells[0] == "Connecting" || cells[0] == "Deploying Host Pool?" || cells[0] == "Deploying Image?" || cells[0] == "Deploying Session Hosts?" || cells[0] == "Deploying FSLogix Config?" || cells[0] == "Deploying Script?" || cells[0] == "Process Assignments?") {
                                        cell.style.background = "#f7f7f7";
                                        cell.style.fontWeight = "600";
                                    }

                                    var FaGreen = '<i class="fa fa-check" style="font-size:15px;color: #07d507;" aria-hidden="true"></i>'
                                    var FaRed = '<i class="fa fa-close" style="font-size:15px;color: red;" aria-hidden="true"></i>'
                                    if (cells[1] == "YES" || cells[1] == "NO" || cells[1] == "ON" || cells[1] == "OFF") {
                                        if (cells[1] == "YES" || cells[1] == "ON") {
                                            var cell = row.insertCell(-1);
                                            cell.innerHTML = FaGreen;
                                            cell.style.background = "#f7f7f7";
                                        }
                                        if (cells[1] == "NO" || cells[1] == "OFF") {
                                            var cell = row.insertCell(-1);
                                            cell.innerHTML = FaRed;
                                            cell.style.background = "#f7f7f7";
                                        }


                                    } else {
                                        var cell = row.insertCell(-1);
                                        cell.innerHTML = cells[1];
                                        cell.style.background = "white";
                                    }

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.background = "white";

                                }
                            }
                        }
                    }

                    var dtable = document.getElementById("AVDDeployVerifiedTempAttributesDIV");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("AVDDeployAllHostDeplAtrData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableHStataus);

                    document.getElementById("LoadingDeplTempForSelTenCircleTwo").style.display = "none";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });


    $("#StartAVDDeployNow").click(function(e) {

        //document.getElementById("VerifyDepAttributesButton").click();

        var table, rowshost, t, IsBlank;
        table = document.getElementById("VerifiedTemplateAttrTable");
        rowshost = table.rows;
        for (t = 1; t < (rowshost.length - 1); t++) {

            x = rowshost[t].getElementsByTagName("TD")[1].innerHTML;

            if (x.trim() == "" || x.trim() == null) {
                IsBlank = "Yes"
            }
        }

        if (IsBlank == "Yes") {
            var ThisMsg = "Some of the fileds are blank in Template. Please check..."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }
        } else {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Start AVD Deployment using selected AVD Templates? Please ensure entered parameters are correct for each Template."
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "STARTAVDDEPLOY";
        }
    });

    function MonitorAVDDEployFunction() {
        // Check Status here and load logs

        var GlobalAVDDeplMonitor = setInterval(function() { AVDMonitorFunctionCheckDeplStatus() }, 300000);

        function AVDMonitorFunctionCheckDeplStatus() {

            var tablenew, rowsnew, i, x, y, shouldSwitch;
            tablenew = document.getElementById("VerifiedTemplateAttrTable");
            rowsnew = tablenew.rows;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;
            var UIDNow = document.getElementById("SelUIdentifierN").value;

            $.ajax({
                url: '/GetAVDDeployLog', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisUser': FinalUserNameNow,
                    'ThisUIDNow': UIDNow,
                    'TRPKey': TRPKey

                },
                success: function(data) {
                    if (data.message) {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var r = 0; r < rows.length; r++) {
                            var cells = rows[r].split(",");

                            var CheckFRow = cells[0];

                            if (CheckFRow == "SESSHOSTSTATUS") {

                                var ThisHostName = cells[1];
                                var ThisHostStatus = cells[2];

                                if (ThisHostStatus == "Deploying") {
                                    var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'
                                }
                                if (ThisHostStatus == "Deployed") {
                                    var ThisAttrDepStatus = '<i class="far fa-check-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                                }
                                if (ThisHostStatus == "Failed") {
                                    var ThisAttrDepStatus = '<i class="fas fa-exclamation-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                                }

                                var table, rowshost, t, x;
                                table = document.getElementById("AVDHostStatusTable");
                                rowshost = table.rows;
                                for (t = 1; t < (rowshost.length - 1); t++) {

                                    x = rowshost[t].getElementsByTagName("TD")[0].innerHTML;
                                    if (x == ThisHostName) {
                                        rowshost[t].getElementsByTagName("TD")[3].innerHTML = ThisAttrDepStatus;
                                    }
                                }


                            } else {

                                var ThisAttr = cells[0];
                                var CheckDepStatus = cells[1];

                                if (CheckDepStatus == "Working") {
                                    var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'
                                }
                                if (CheckDepStatus == "Done") {
                                    var ThisAttrDepStatus = '<i class="far fa-check-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                                }
                                if (CheckDepStatus == "Failed") {
                                    var ThisAttrDepStatus = '<i class="fas fa-exclamation-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                                }

                                if (ThisAttr == "FAILEDNOW") {
                                    clearInterval(GlobalAVDDeplMonitor);
                                }
                                if (ThisAttr == "COMPLETED") {
                                    clearInterval(GlobalAVDDeplMonitor);
                                }

                                if (ThisAttr == "Connecting") {
                                    for (i = 1; i < (rowsnew.length - 1); i++) {
                                        x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                        if (x == "Connecting") {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                        }
                                    }
                                }

                                if (ThisAttr == "Deploying Host Pool?") {
                                    for (i = 1; i < (rowsnew.length - 1); i++) {
                                        x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                        if (x == "Deploying Host Pool?") {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                        }
                                    }
                                }

                                if (ThisAttr == "Deploying Image?") {
                                    for (i = 1; i < (rowsnew.length - 1); i++) {
                                        x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                        if (x == "Deploying Image?") {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                        }
                                    }
                                }

                                if (ThisAttr == "Deploying Session Hosts?") {
                                    for (i = 1; i < (rowsnew.length - 1); i++) {
                                        x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                        if (x == "Deploying Session Hosts?") {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                        }
                                    }
                                }

                                if (ThisAttr == "Deploying FSLogix Config?") {
                                    for (i = 1; i < (rowsnew.length - 1); i++) {
                                        x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                        if (x == "Deploying FSLogix Config?") {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                        }
                                    }
                                }

                                if (ThisAttr == "Deploying Script?") {
                                    for (i = 1; i < (rowsnew.length - 1); i++) {
                                        x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                        if (x == "Deploying Script?") {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                        }
                                    }
                                }

                                if (ThisAttr == "Process Assignments?") {
                                    for (i = 1; i < (rowsnew.length - 1); i++) {
                                        x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                        if (x == "Process Assignments?") {
                                            rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                        }
                                    }
                                }



                            }

                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        clearInterval(GlobalAVDDeplMonitor);

                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    clearInterval(GlobalAVDDeplMonitor);
                }
            });


        }

    }

    function MonitorScriptExecutionFunction() {
        // Check Status here and load logs

        clearInterval(GlobalScriptExecutionMonitor);
        var GlobalScriptExecutionMonitor = setInterval(function() { ScriptExecutionMonitorStatus() }, 300000);

        function ScriptExecutionMonitorStatus() {

            document.getElementById("RefAllScriptHostsNow").click();

        }

    }

}
// END: NEW AVD DEPLOYMENT FUNCTIONS

function CheckAVDDeployingStatusForAll() {

    var tablenew, rowsnew, i, x, y, shouldSwitch;
    tablenew = document.getElementById("VerifiedTemplateAttrTable");
    rowsnew = tablenew.rows;

    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
    var res = ThisLUserNow.split("@");
    var FinalUserNameNow = res[0];

    var TRPKey = document.getElementById("TRPKeyN").value;
    var UIDNow = document.getElementById("SelUIdentifierN").value;

    $.ajax({
        url: '/GetAVDDeployLog', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisUser': FinalUserNameNow,
            'ThisUIDNow': UIDNow,
            'TRPKey': TRPKey

        },
        success: function(data) {
            if (data.message) {

                let res = data.message.replaceAll('"', "");
                var rows = res.split("\n");

                for (var r = 0; r < rows.length; r++) {
                    var cells = rows[r].split(",");

                    var CheckFRow = cells[0];

                    if (CheckFRow == "SESSHOSTSTATUS") {

                        var ThisHostName = cells[1];
                        var ThisHostStatus = cells[2];

                        if (ThisHostStatus == "Deploying") {
                            var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'
                        }
                        if (ThisHostStatus == "Deployed") {
                            var ThisAttrDepStatus = '<i class="far fa-check-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                        }
                        if (ThisHostStatus == "Failed") {
                            var ThisAttrDepStatus = '<i class="fas fa-exclamation-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                        }

                        var table, rowshost, t, x;
                        table = document.getElementById("AVDHostStatusTable");
                        rowshost = table.rows;
                        for (t = 1; t < (rowshost.length - 1); t++) {

                            x = rowshost[t].getElementsByTagName("TD")[0].innerHTML;
                            if (x == ThisHostName) {
                                rowshost[t].getElementsByTagName("TD")[3].innerHTML = ThisAttrDepStatus;
                            }
                        }


                    } else {

                        var ThisAttr = cells[0];
                        var CheckDepStatus = cells[1];

                        if (CheckDepStatus == "Working") {
                            var ThisAttrDepStatus = '<i class="fa fa-spinner fa-spin" aria-hidden="true" style="color: red;font-size:12px; margin-right: 5px;"></i>'
                        }
                        if (CheckDepStatus == "Done") {
                            var ThisAttrDepStatus = '<i class="far fa-check-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                        }
                        if (CheckDepStatus == "Failed") {
                            var ThisAttrDepStatus = '<i class="fas fa-exclamation-circle" aria-hidden="true" style="color: green;margin-right: 5px;font-size:12px;"></i>'
                        }

                        if (ThisAttr == "Connecting") {
                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == "Connecting") {
                                    rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }

                        if (ThisAttr == "Deploying Host Pool?") {
                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == "Deploying Host Pool?") {
                                    rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }

                        if (ThisAttr == "Deploying Image?") {
                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == "Deploying Image?") {
                                    rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }

                        if (ThisAttr == "Deploying Session Hosts?") {
                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == "Deploying Session Hosts?") {
                                    rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }

                        if (ThisAttr == "Deploying FSLogix Config?") {
                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == "Deploying FSLogix Config?") {
                                    rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }

                        if (ThisAttr == "Deploying Script?") {
                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == "Deploying Script?") {
                                    rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }

                        if (ThisAttr == "Process Assignments?") {
                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == "Process Assignments?") {
                                    rowsnew[i].getElementsByTagName("TD")[2].innerHTML = ThisAttrDepStatus;
                                }
                            }
                        }



                    }

                }







            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                clearInterval(GlobalAVDDeplMonitor);

            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            clearInterval(GlobalAVDDeplMonitor);
        }
    });


}

// START: ALL RBAC MANAGER FUNCTIONS
{


    $("#ResetTasksForSelUser").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to reset Tasks for User?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "RESETTASK";

    });

    $("#SaveTasksForUsers").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Save Tasks for RBAC User?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "SAVETASK";

    });


    $("#CloseModifyTaskModal").click(function(e) {

        document.getElementById("ModifyATaskModal").style.display = "none";
    });


    $("#CreateNewRBACUser").click(function(e) {

        document.getElementById("AddNewRBACUserModal").style.display = "block";
        var AzureRBACLoginStatus = "Disabled";

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckRBACLoginOpt', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[1];
                        if (CheckFRow == "RBAC Manager Log In:Allow Azure AD Login for RBAC Users") {
                            AzureRBACLoginStatus = cells[2];
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

        if (AzureRBACLoginStatus == "Enabled") {
            document.getElementById("AzureADLoginMsg").style.display = "block";
        }
        if (AzureRBACLoginStatus == "Disabled") {
            document.getElementById("AzureADLoginMsg").style.display = "none";
        }



    });
    $("#CloseRBACModal").click(function(e) {

        document.getElementById("AddNewRBACUserModal").style.display = "none";
    });

    $("#AddRBACUserNowButton").click(function(e) {

        var ThisIDNow = document.getElementById("RBACUserNamefld").value;
        var ThisPassNow = document.getElementById("RBACUserPassNow").value;
        var ThisCPassNow = document.getElementById("RBACUserConfirmPass").value;

        var ProceedOrNot = "Yes"
        if (ThisIDNow == null) {
            var ThisMsg = "Please provide input to all values..."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }
            ProceedOrNot = "No"
        }

        if (ProceedOrNot == "Yes") {
            if (ThisPassNow == ThisCPassNow) {} else {
                var ThisMsg = "Passwords do not match..."
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }
                ProceedOrNot = "No"
            }
        }

        if (ProceedOrNot == "Yes") {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Create RBAC User?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "CREATERBACUSER";
        }

    });

    $("#RefAllRBACUsers").click(function(e) {

        var ProceedOrNot = "Yes";

        if (ProceedOrNot == "Yes") {

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/LoadRBACUsers', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        var xLeft = document.getElementById("AllRBACUsersList");
                        var options = document.querySelectorAll('#AllRBACUsersList option');
                        options.forEach(o => o.remove());

                        let res = data.message.replaceAll('"', "");

                        var rows = res.split("\n");
                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            if (cells.length > 1) {

                                var newcell = cells[0] + ":" + cells[3];
                                var rUName = cells[0];

                                if (rUName == 'UserName') {} else {
                                    if (rUName == "" || rUName == null) {} else {
                                        var optionR = document.createElement("option");
                                        optionR.text = rUName;
                                        xLeft.add(optionR);
                                    }
                                }
                            }
                        }


                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });

    $("#OpenRBACUserID").click(function(e) {

        var ThisMsg = "Fetching RBAC User Tasks. Please wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var RBACUserNow = document.getElementById("AllRBACUsersList").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        document.getElementById("ThisOpenedRBACUsers").innerHTML = "Selected User:" + RBACUserNow;
        document.getElementById("ThisOpenedRBACUserType").innerHTML = "User Type:" + RBACUserNow;

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/LoadRBACUserTasks', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelRBACUser': RBACUserNow,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'RBACUserTasksTableN'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    var datatableTenAndPool = document.createElement("table");
                    datatableTenAndPool.id = 'RBACUserTasksTableForTenAndPoolN'
                    datatableTenAndPool.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    var TotTasksAssigned = 0
                    var TotTasksUnAssigned = 0

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[1];
                        var CheckSRow = cells[1];
                        var CheckWhatRow = cells[0];

                        if (CheckWhatRow == "RBACTASKS") {

                            var row = datatable.insertRow(-1);
                            if (CheckFRow == "User Name") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";
                                cell.style.width = "150px";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[5];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";
                                cell.style.width = "77px";


                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.background = "#f7f7f7";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.background = "white";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.background = "white";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.background = "white";
                                cell.style.fontWeight = "500";

                                if (cells[4] == "Task Is Available") {
                                    cell.style.color = "green";
                                    ++TotTasksAssigned
                                } else {
                                    cell.style.color = "#ff6000";
                                    ++TotTasksUnAssigned
                                }

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[5];
                                cell.style.background = "white";
                                cell.style.fontWeight = "500";

                            }

                        }

                        if (CheckWhatRow == "USERTENANDPOOLS") {

                            var row = datatableTenAndPool.insertRow(-1);
                            if (CheckFRow == "User Name") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                            } else {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.background = "#f7f7f7";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.background = "white";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                cell.style.background = "white";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];
                                cell.style.background = "white";
                                cell.style.fontWeight = "500";

                                if (cells[4] == "Available") {
                                    cell.style.color = "green";
                                } else {
                                    cell.style.color = "#ff6000";
                                }

                            }

                        }

                    }

                    var dtable = document.getElementById("SelRBACUserData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var dtable = document.getElementById("AvaTenAndPoolsForSelUserDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatableTenAndPool);

                    document.getElementById("TotTasksAssignedN").innerHTML = TotTasksAssigned;
                    document.getElementById("TotTasksAssignedN").style.fontSize = "22px";
                    document.getElementById("TotTasksAssignedN").style.color = "green";

                    document.getElementById("TotTasksUnAssignedN").innerHTML = TotTasksUnAssigned;
                    document.getElementById("TotTasksUnAssignedN").style.fontSize = "22px";
                    document.getElementById("TotTasksUnAssignedN").style.color = "#ff6000";

                    var tableRT = document.getElementById('RBACUserTasksTableN');
                    var cells = tableRT.getElementsByTagName('td');
                    for (var i = 0; i < cells.length; i++) {
                        // Take each cell
                        var cell = cells[i];
                        // do something on onclick event for cell
                        cell.onclick = function() {
                            // Get the row id where the cell exists

                            var rowId = this.parentNode.rowIndex;
                            var rowsNotSelected = tableRT.getElementsByTagName('tr');
                            for (var row = 0; row < rowsNotSelected.length; row++) {
                                rowsNotSelected[row].style.color = "#666666";
                                rowsNotSelected[row].style.background = "white";
                                rowsNotSelected[row].classList.remove('selected');
                            }

                            var rowSelected = tableRT.getElementsByTagName('tr')[rowId];
                            rowSelected.style.color = "black";
                            rowSelected.style.background = "#B1EDFF";
                            rowSelected.className += "selected";

                            var ThisTaskAvaNow = rowSelected.cells[3].innerHTML;

                            if (ThisTaskAvaNow == "Task Is Available") {
                                rowSelected.cells[3].innerHTML = "Task Is Not Available"
                                rowSelected.cells[3].style.color = "#ff6000";

                            } else {
                                rowSelected.cells[3].innerHTML = "Task Is Available"
                                rowSelected.cells[3].style.color = "green";
                            }

                            document.getElementById("UpdateTasksNumberNow").click();

                            // ModifyRBACTaskNowForUserFunction(ThisUserNow, ThisTenantNow, ThisTaskNow, ThisTaskAvaNow, ThisTaskTypeNow)

                        }
                    }

                    var tableRTpools = document.getElementById('RBACUserTasksTableForTenAndPoolN');
                    var cells = tableRTpools.getElementsByTagName('td');
                    for (var i = 0; i < cells.length; i++) {
                        // Take each cell
                        var cell = cells[i];
                        // do something on onclick event for cell
                        cell.onclick = function() {
                            // Get the row id where the cell exists

                            var rowId = this.parentNode.rowIndex;
                            var rowsNotSelected = tableRTpools.getElementsByTagName('tr');
                            for (var row = 0; row < rowsNotSelected.length; row++) {
                                rowsNotSelected[row].style.color = "#666666";
                                rowsNotSelected[row].style.background = "white";
                                rowsNotSelected[row].classList.remove('selected');
                            }

                            var rowSelected = tableRTpools.getElementsByTagName('tr')[rowId];
                            rowSelected.style.color = "black";
                            rowSelected.style.background = "#B1EDFF";
                            rowSelected.className += "selected";

                            var ThisTaskAvaNow = rowSelected.cells[3].innerHTML;

                            if (ThisTaskAvaNow == "Available") {
                                rowSelected.cells[3].innerHTML = "Not Available"
                                rowSelected.cells[3].style.color = "#ff6000";

                            } else {
                                rowSelected.cells[3].innerHTML = "Available"
                                rowSelected.cells[3].style.color = "green";

                            }

                            // ModifyRBACTaskNowForUserFunction(ThisUserNow, ThisTenantNow, ThisTaskNow, ThisTaskAvaNow, ThisTaskTypeNow)

                        }
                    }

                    document.getElementById("UpdateTasksNumberNow").click();
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    function ModifyRBACTaskNowForUserFunction(ThisUserNow, ThisTenantNow, ThisTaskNow, ThisTaskAvaNow, ThisTaskTypeNow) {

        document.getElementById("ModifyATaskModal").style.display = "block";

        document.getElementById("ModifyUserName").innerHTML = ThisUserNow;
        document.getElementById("ModifyTenantName").innerHTML = ThisTenantNow;
        document.getElementById("CurrentTaskForUser").innerHTML = ThisTaskNow;
        document.getElementById("CurrentTakAvaN").innerHTML = ThisTaskAvaNow;
        document.getElementById("CurrentTaskType").innerHTML = ThisTaskTypeNow;

        document.getElementById("TaskAvaOrNotForUserSelect").value = ThisTaskAvaNow;

    }

    $("#AssignAllTasksForUser").click(function(e) {

        e.preventDefault()

        var ThisVal = document.getElementById("TaskAvaOrNotForUserSelect").value;

        var TotTasksNow = 0

        var table, rows, i, x;
        table = document.getElementById("RBACUserTasksTableN");
        rows = table.rows;
        for (i = 0; i < (rows.length); i++) {

            x = rows[i].getElementsByTagName("TD")[3].innerHTML = "Task Is Available"
            rows[i].getElementsByTagName("TD")[3].style.color = "green";
            ++TotTasksNow;
        }

        document.getElementById("TotTasksAssignedN").innerHTML = TotTasksNow;
        document.getElementById("TotTasksAssignedN").style.fontSize = "22px";
        document.getElementById("TotTasksAssignedN").style.color = "green";

        document.getElementById("TotTasksUnAssignedN").innerHTML = "0";
        document.getElementById("TotTasksUnAssignedN").style.fontSize = "22px";
        document.getElementById("TotTasksUnAssignedN").style.color = "#ff6000";


    });

    $("#UpdateTasksNumberNow").click(function(e) {

        e.preventDefault()

        var TotATasks = 0
        var TotUnTasks = 0

        var table, rows, i, x;
        table = document.getElementById("RBACUserTasksTableN");
        rows = table.rows;
        for (i = 0; i < (rows.length); i++) {

            x = rows[i].getElementsByTagName("TD")[3].innerHTML
            if (x == "Task Is Available") {
                ++TotATasks
            }
            if (x == "Task Is Not Available") {
                ++TotUnTasks
            }
        }

        document.getElementById("TotTasksAssignedN").innerHTML = TotATasks;
        document.getElementById("TotTasksAssignedN").style.fontSize = "22px";
        document.getElementById("TotTasksAssignedN").style.color = "green";

        document.getElementById("TotTasksUnAssignedN").innerHTML = TotUnTasks;
        document.getElementById("TotTasksUnAssignedN").style.fontSize = "22px";
        document.getElementById("TotTasksUnAssignedN").style.color = "#ff6000";

    });

    $("#UnAssignAllTasksButton").click(function(e) {

        e.preventDefault()
        var TotTasksNow = 0

        var ThisVal = document.getElementById("TaskAvaOrNotForUserSelect").value;

        var table, rows, i, x;
        table = document.getElementById("RBACUserTasksTableN");
        rows = table.rows;
        for (i = 0; i < (rows.length); i++) {

            x = rows[i].getElementsByTagName("TD")[3].innerHTML = "Task Is Not Available"
            rows[i].getElementsByTagName("TD")[3].style.color = "#ff6000";
            ++TotTasksNow;
        }

        document.getElementById("TotTasksAssignedN").innerHTML = "0";
        document.getElementById("TotTasksAssignedN").style.fontSize = "22px";
        document.getElementById("TotTasksAssignedN").style.color = "green";

        document.getElementById("TotTasksUnAssignedN").innerHTML = TotTasksNow;
        document.getElementById("TotTasksUnAssignedN").style.fontSize = "22px";
        document.getElementById("TotTasksUnAssignedN").style.color = "#ff6000";

    });

    $("#ModifySelTaskNowButtonN").click(function(e) {

        e.preventDefault()

        var ThisVal = document.getElementById("TaskAvaOrNotForUserSelect").value;

        var xUser = document.getElementById("ModifyUserName").innerHTML;
        var xTenant = document.getElementById("ModifyTenantName").innerHTML;
        var xTaskName = document.getElementById("CurrentTaskForUser").innerHTML;

        var table, rows, i, x;
        table = document.getElementById("RBACUserTasksTableN");
        rows = table.rows;
        for (i = 1; i < (rows.length - 1); i++) {

            UserNameNow = rows[i].getElementsByTagName("TD")[0].innerHTML;
            TenNameNow = rows[i].getElementsByTagName("TD")[1].innerHTML;
            TaskNameNow = rows[i].getElementsByTagName("TD")[2].innerHTML;

            if (UserNameNow == xUser && TenNameNow == xTenant && TaskNameNow == xTaskName) {
                rows[i].getElementsByTagName("TD")[3].innerHTML = ThisVal;
                if (ThisVal == "Task Is Available") {
                    rows[i].getElementsByTagName("TD")[3].style.color = "green";
                } else {
                    rows[i].getElementsByTagName("TD")[3].style.color = "#ff6000";
                }
            }
        }

        document.getElementById("ModifyATaskModal").style.display = "none";


    });



}
// END: ALL RBAC MANAGER FUNCTIONS

// START: ALL HOSTS HEALTH TASKS
{

    $("#HostHealthGoLeftRightArrow").click(function(e) {

        //if (document.getElementById("HostsStatusRightDiv").style.clientWidth < 11) {
        //   document.getElementById("HostsStatusRightDiv").style.width = "36%"
        //} else {
        //    document.getElementById("HostsStatusRightDiv").style.width = "10%"
        // }

    });

    $("#RefHostsHealth").click(function(e) {

        document.getElementById("CollectingHostsStatusCircle").style.display = "block";

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("NotRunningC").style.display = "block";

            document.getElementById("SwitchToHostPoolsStatusNN").click();

            var ThisTen = document.getElementById("HOSTHAvaTenListN").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/RefHostsHealth', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey,
                    'userId': userId
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "HOSTHEALTHITEMS";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });

    $("#CheckVMHStatus").click(function(e) {


        var ProceedOrNot = "No"

        var ThisMsg = "Please use Refresh Host Health..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        if (ProceedOrNot == "Yes") {


            var DemoOrNot = document.getElementById("DOrNot").innerHTML;
            if (DemoOrNot == "DEMO") {
                var ThisMsg = "Task is not available in Demo Mode!"
                document.getElementById("FootMessageID").innerHTML = ThisMsg;
                document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                document.getElementById("GettingReadyID").style.display = "none";
                var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

                function FunctionFooterDIV() {
                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    clearInterval(MyTimerFooter);
                }

            } else {

                document.getElementById("NotRunningC").style.display = "block";

                var ThisTen = document.getElementById("HOSTHAvaTenListN").value;

                var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
                var res = ThisLUserNow.split("@");
                var FinalUserNameNow = res[0];

                $.ajax({
                    url: '/RefHostHealthVMStatus', // This tells server which Route to use OKAYYYY
                    type: 'POST',
                    async: false,
                    timeout: 50000,
                    data: {
                        'ThisTen': ThisTen,
                        'ThisLUser': FinalUserNameNow
                    },
                    success: function(data) {
                        if (data.message) {




                        } else {
                            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                        }
                    },
                    error: function() {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                });

            }
        }
    });

    $("#TurnOnAllVMsButtonN").click(function(e) {

        ThisTen = document.getElementById("HOSTHAvaTenListN").value;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to turn on all Session Hosts in selected Tenant : " + ThisTen + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var ThisDataS = "NONE" + ":" + "NONE" + ":" + ThisTen;
        var FinalHostActionNow = ThisDataS + ":TURNONALLHOSTSINTEN"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    });

    $("#TurnOffAllVMsButtonN").click(function(e) {

        ThisTen = document.getElementById("HOSTHAvaTenListN").value;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to turn OFF all Session Hosts in selected Tenant : " + ThisTen + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var ThisDataS = "NONE" + ":" + "NONE" + ":" + ThisTen;
        var FinalHostActionNow = ThisDataS + ":TURNOFFALLHOSTSINTEN"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;


    });

    $("#TurnOffSelectedHostsInGrid").click(function(e) {

        var TotHostsNow = 0
        var table, rows, i, x, y, shouldSwitch;
        table = document.getElementById("SessionHostsStatusTable");
        rows = table.rows;
        for (i = 1; i < (rows.length); i++) {

            //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
            x = rows[i].getElementsByTagName("TD")[0].innerHTML;

            var ThisNow = x.split('"');
            var ThisIDNow = ThisNow[1];
            var CheckThisHost = document.getElementById(ThisIDNow).checked;
            if (CheckThisHost == true) {
                ++TotHostsNow;
            }
        }

        if (TotHostsNow == 0) {
            var ThisMsg = "Please select Hosts in Grid...."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";

            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            ThisTen = document.getElementById("HOSTHAvaTenListN").value;

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to turn Off Selected Session Hosts?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

            var ThisDataS = "NONE" + ":" + "NONE" + ":" + ThisTen;
            var FinalHostActionNow = ThisDataS + ":TURNOFFSELECTEDHOSTS"
            document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;
        }

    });

    $("#TurnOnSelectedHostsInGridNow").click(function(e) {

        var TotHostsNow = 0
        var table, rows, i, x, y, shouldSwitch;
        table = document.getElementById("SessionHostsStatusTable");
        rows = table.rows;
        for (i = 1; i < (rows.length); i++) {

            //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
            x = rows[i].getElementsByTagName("TD")[0].innerHTML;

            var ThisNow = x.split('"');
            var ThisIDNow = ThisNow[1];
            var CheckThisHost = document.getElementById(ThisIDNow).checked;
            if (CheckThisHost == true) {
                ++TotHostsNow;
            }
        }

        if (TotHostsNow == 0) {
            var ThisMsg = "Please select Hosts in Grid...."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";

            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            ThisTen = document.getElementById("HOSTHAvaTenListN").value;

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to turn On Selected Session Hosts?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

            var ThisDataS = "NONE" + ":" + "NONE" + ":" + ThisTen;
            var FinalHostActionNow = ThisDataS + ":TURNONSELECTEDHOSTS"
            document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;
        }

    });

    $("#RemoveDrainModeVMsButton").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {



        }
    });

    $("#SetDrainModeForAllVMsButton").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {


        }
    });

    function GetHostsHealthStatusFunction(ThisCompleteData) {
        // Check Status here and load logs

        //var InsertC = '<div id="RefAllCircleHAHA" style="width: 80%; display: block; /*! float: right; */ margin-right: 10px; margin-top: 7px;margin: 0;position: absolute;top: 50%;-ms-transform: translateY(-50%);transform: translateY(-50%);transition: translateX(-50%);display: flex;justify-content: center;"><i id="ssss" class="fas fa-circle-notch fa-spin" aria-hidden="true" style="margin-right: 7px;font-size: 50px;color: #13baf1;margin-left: 7px;float: left;text-shadow: none;"></i></div>'
        //document.getElementById("HostsStatusPerPoolResultDiv").innerHTML = InsertC;
        //document.getElementById("AllHostsAttrStatusDIV").innerHTML = InsertC;                

        var datatableTwo = document.createElement("table");
        datatableTwo.id = 'UsersPerHourDataTable'
        datatableTwo.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatable = document.createElement("table");
        datatable.id = 'HostPoolStatusTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableHosts = document.createElement("table");
        datatableHosts.id = 'SessionHostsStatusTable'
        datatableHosts.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableAlerts = document.createElement("table");
        datatableAlerts.id = 'SessionHostsAlertsTable'
        datatableAlerts.setAttribute('class', 'SummaryTableClassforAzBilling');

        const PoolCols = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
        const HostCols = [1, 2, 3, 4, 5, 6, 7, 8, 9]

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");

            var CheckFRow = cells[0];
            var CheckSRow = cells[1];

            if (CheckFRow == "LASTREFDATE") {

                document.getElementById("HostLastRefDate").innerHTML = "Last Refresh: " + cells[1];
            }

            if (CheckFRow == "POOLSTATUS") {
                var row = datatable.insertRow(-1);

                if (CheckSRow == "Host Pool") {

                    var CheckIfBlank = cells[0]
                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[1];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.textAlign = "left";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[2];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.textAlign = "center";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[3];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.width = "80px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[4];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.width = "80px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[5];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.width = "80px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[6];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";
                        cell.style.width = "80px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[7];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[8];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[9];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[10];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[11];
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = "Host Template";
                        cell.style.backgroundColor = "white";
                        cell.style.color = "#066d95";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "600";
                        cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                        cell.style.position = "sticky";
                        cell.style.zIndex = "22";
                        cell.style.top = "0px";
                        cell.style.fontSize = "12px";
                        cell.style.fontFamily = "Calibri";


                    }


                } else {

                    var HostPool = cells[1];
                    var TotHosts = cells[2];
                    var TotConAllowed = cells[3];
                    var TotConNotAllowed = cells[4];
                    var TotHOk = cells[5];
                    var TotHNotOk = cells[6];
                    var TotActiveDiscon = cells[7];
                    var TotHostsOn = cells[8];
                    var TotHostsOff = cells[9];

                    var CheckIfBlank = cells[0]

                    var HostName = "NONE"
                    var RSGroup = "NONE"
                    var ThisDataS = HostName + ":" + RSGroup + ":" + HostPool;

                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                        var cell = row.insertCell(-1);
                        cell.innerHTML = HostPool;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TotHosts;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TotConAllowed;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TotConNotAllowed;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TotHOk;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TotHNotOk;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TotActiveDiscon;
                        cell.style.fontSize = "22px";
                        cell.style.color = "green";

                        //var TotHostsOnNow = TotHostsOn

                        var TurnOffOrNot = localStorage.getItem("TurnOffAllInHostPool");
                        if (TurnOffOrNot == "Yes") {
                            var TurnOff = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOffAllHostFunction(id)">Turn Off All</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = TotHostsOn + TurnOff;
                            cell.style.fontSize = "22px";
                            cell.style.color = "green";
                        }
                        if (TurnOffOrNot == "No") {
                            var TurnOff = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOffAllHostFunction(id)">Turn Off All</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = TotHostsOn + TurnOff;
                            cell.style.fontSize = "22px";
                            cell.style.color = "green";
                        }

                        var TurnOnOrNot = localStorage.getItem("TurnOnAllInHostPool");
                        if (TurnOnOrNot == "Yes") {

                            var TurnOn = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOnAllHostFunction(id)"">Turn On All</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = TotHostsOff + TurnOn;
                            cell.style.fontSize = "22px";
                            cell.style.color = "rgb(249, 99, 25)";
                        }
                        if (TurnOnOrNot == "No") {
                            var TurnOn = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOnAllHostFunction(id)"">Turn On All</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = TotHostsOff + TurnOn;
                            cell.style.fontSize = "22px";
                            cell.style.color = "rgb(249, 99, 25)";
                        }


                        var ThisSelTen = document.getElementById("HOSTHAvaTenListN").value;
                        var FinalString = ThisSelTen + ":" + HostPool;

                        //var PushKPIAgent = '<button id = ' + FinalString + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="PushKPIAgentFunctionNow(id)"">Push KPIAgent</button>'

                        var RemoveHostOrNot = localStorage.getItem("RemoveHostsInPool");
                        if (RemoveHostOrNot == "Yes") {
                            var RemoveAllHosts = '<button id = ' + HostPool + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="RemoveHostsFromHostHealthFunction(id)"">Remove Hosts</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = RemoveAllHosts;
                        }
                        if (RemoveHostOrNot == "No") {
                            var RemoveAllHosts = '<button id = ' + HostPool + ' disabled = true style="text-decoration:line-through; font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="RemoveHostsFromHostHealthFunction(id)"">Remove Hosts</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = RemoveAllHosts;

                        }

                        var DeplHostOrNot = localStorage.getItem("DeployHost");
                        if (DeplHostOrNot == "Yes") {
                            var DeployNewHosts = '<button id = ' + HostPool + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="DeployNewHostsFromHostHealthFunction(id)"">Deploy Hosts</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = DeployNewHosts;
                        }
                        if (DeplHostOrNot == "No") {
                            var DeployNewHosts = '<button id = ' + HostPool + ' disabled = true style="text-decoration:line-through; font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="DeployNewHostsFromHostHealthFunction(id)"">Deploy Hosts</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = DeployNewHosts;

                        }

                        var AddHostTemplate = localStorage.getItem("CreateHostTemplate");
                        if (AddHostTemplate == "Yes") {
                            var CreateAddHostTemplates = '<button id = ' + FinalString + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="CreateNewHostsTemplateFromHostHealth(id)"">Create Host Template</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = CreateAddHostTemplates;
                        }
                        if (AddHostTemplate == "No") {
                            var CreateAddHostTemplates = '<button id = ' + FinalString + ' disabled = true style="text-decoration:line-through; font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="CreateNewHostsTemplateFromHostHealth(id)"">Create Host Template</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = CreateAddHostTemplates;

                        }


                    }



                }


            }

            if (CheckFRow == "HOSTSTATUS") {
                var row = datatableHosts.insertRow(-1);

                if (CheckSRow == "Session Host") {

                    var ThisMarkUnAll = '<input id="MarkUnMarkAllHostsInGrid" type="checkbox" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>'
                    var cell = row.insertCell(-1);
                    cell.innerHTML = ThisMarkUnAll;
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";
                    cell.style.textAlign = "Center";
                    cell.style.width = "40px";

                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }
                    }

                    var cell = row.insertCell(-1);
                    cell.innerHTML = "Restart";
                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";


                } else {

                    var HostName = cells[1];
                    var ConAllowed = cells[2];
                    var HB = cells[3];
                    var HPool = cells[4];
                    var RSGroup = cells[5];
                    var VMStatus = cells[6];
                    var TotSess = cells[7];
                    var ActStatus = cells[8];

                    var CheckIfBlank = cells[0]

                    var ThisDataS = HostName + ":" + RSGroup + ":" + HPool;

                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                        var Repair = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top:0px;outline:none;" onclick="RepairHostFunction(id)">Repair</button>'
                        var TurnOn = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOnHostFunction(id)"">Turn On</button>'
                        var TurnOff = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOffHostFunction(id)">Turn Off</button>'
                        var PutInDrainMode = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostFalseFunction(id)">Set False</button>'
                        var RemoveFromDrainMode = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostTrueFunction(id)">Set True</button>'

                        var HostCheckBox = '<input id=' + ThisDataS + ' type="checkbox" style="cursor: pointer;border: 1px solid black;border-radius: 10px;">'

                        var cell = row.insertCell(-1);
                        cell.innerHTML = HostCheckBox;
                        cell.style.textAlign = "Center";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = HostName;

                        if (ConAllowed == "False") {

                            var RemoveFromDrainModeNow = localStorage.getItem("RemoveFromDrainMode");
                            if (RemoveFromDrainModeNow == "Yes") {
                                var RemoveFromDrainMode = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostTrueFunction(id)">Set True</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = ConAllowed + RemoveFromDrainMode;
                            }
                            if (RemoveFromDrainModeNow == "No") {
                                var RemoveFromDrainMode = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostTrueFunction(id)">Set True</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = ConAllowed + RemoveFromDrainMode;
                            }

                        }
                        if (ConAllowed == "True") {

                            var PutInDrainModeOrNot = localStorage.getItem("PutInDrainMode");
                            if (PutInDrainModeOrNot == "Yes") {
                                var PutInDrainMode = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostFalseFunction(id)">Set False</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = ConAllowed + PutInDrainMode;
                            }
                            if (PutInDrainModeOrNot == "No") {
                                var PutInDrainMode = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="SetHostFalseFunction(id)">Set False</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = ConAllowed + PutInDrainMode;
                            }

                        }

                        if (HB == "Unavailable" || HB == "Available") {
                            if (HB == "Unavailable") {
                                var cell = row.insertCell(-1);
                                if (VMStatus == "VM running") {
                                    cell.innerHTML = HB //+ Repair;
                                } else {
                                    cell.innerHTML = HB;
                                }
                                cell.style.color = "#f96319";
                            }

                            if (HB == "Available") {
                                var cell = row.insertCell(-1);
                                cell.innerHTML = HB;
                                cell.style.color = "green";
                            }
                        } else {
                            var cell = row.insertCell(-1);
                            cell.innerHTML = HB;
                            cell.style.color = "#f96319";
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = HPool;

                        var cell = row.insertCell(-1);
                        cell.innerHTML = RSGroup;

                        if (VMStatus == "VM running" || VMStatus == "VM deallocated") {

                            if (VMStatus == "VM deallocated") {
                                var TurnOnSingleSSHost = localStorage.getItem("TurnOnSingleHost");
                                if (TurnOnSingleSSHost == "Yes") {
                                    var TurnOn = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOnHostFunction(id)"">Turn On</button>'
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = VMStatus + TurnOn;
                                    cell.style.color = "#f96319";

                                }
                                if (TurnOnSingleSSHost == "No") {
                                    var TurnOn = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOnHostFunction(id)"">Turn On</button>'
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = VMStatus + TurnOn;
                                    cell.style.color = "#f96319";
                                }
                            }

                            if (VMStatus == "VM running") {

                                var TurnOffSingleSSHost = localStorage.getItem("TurnOffSingleHost");
                                if (TurnOffSingleSSHost == "Yes") {
                                    var TurnOff = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOffHostFunction(id)">Turn Off</button>'
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = VMStatus + TurnOff;
                                    cell.style.color = "green";

                                }
                                if (TurnOffSingleSSHost == "No") {
                                    var TurnOff = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="TurnOffHostFunction(id)">Turn Off</button>'
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = VMStatus + TurnOff;
                                    cell.style.color = "green";
                                }
                            }
                        } else {
                            var cell = row.insertCell(-1);
                            cell.innerHTML = VMStatus;
                            cell.style.color = "#f96319";
                        }

                        var cell = row.insertCell(-1);
                        cell.innerHTML = TotSess;
                        cell.style.width = "40px";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = ActStatus;
                        if (ActStatus == "VM deallocated") {
                            cell.style.color = "#f96319";
                        }
                        if (ActStatus == "Accepting Connections") {
                            cell.style.color = "green";
                        }
                        if (ActStatus == "Idle") {
                            cell.style.color = "#767777";
                        }
                        if (ActStatus == "VM running") {
                            cell.style.color = "green";
                        }

                        var RemoveSingleHostNow = localStorage.getItem("RemoveSingleHost");
                        if (RemoveSingleHostNow == "Yes") {
                            var RemoveSingleHost = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="RemoveSingleHostFunction(id)"">Remove Host</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = RemoveSingleHost;
                        }
                        if (RemoveSingleHostNow == "No") {
                            var RemoveSingleHost = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="RemoveSingleHostFunction(id)"">Remove Host</button>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = RemoveSingleHost;
                        }

                        if (VMStatus == "VM running") {

                            var RestartHostNow = localStorage.getItem("RestartSingleHost");
                            RestartHostNow = "Yes"
                            if (RestartHostNow == "Yes") {
                                var RestartSingleHostNow = '<button id = ' + ThisDataS + ' style="font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="RestartSingleHostFunction(id)"">Restart</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = RestartSingleHostNow;
                            }
                            if (RestartHostNow == "No") {
                                var RestartSingleHostNow = '<button id = ' + ThisDataS + ' disabled = true style="text-decoration:line-through;font-size:10px;cursor: pointer;background: #ffe7ce;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px;margin-top:0px;outline:none;" onclick="RestartSingleHostFunction(id)"">Restart</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = RestartSingleHostNow;
                            }
                        } else {
                            var cell = row.insertCell(-1);
                            cell.innerHTML = "";
                        }

                    }


                }

            }

            if (CheckFRow == "HOSTNUMBERS") {
                var TotHosts = cells[1];
                var TotTurnedOffHosts = cells[2];
                var TotTurnedOnHosts = cells[3];
                var TotTurnedOnInDrainMode = cells[4];
                var TotTurnedOnRECVHB = cells[5];
                var TotTurnedOnNOHB = cells[6];
                var TOTRECHBACTIVEHosts = cells[7];
                var TotTurnedONIdleHosts = cells[8];

                document.getElementById("TotNumberOfHostsNow").innerHTML = TotHosts;
                document.getElementById("TotHostsTOFFN").innerHTML = TotTurnedOffHosts;
                document.getElementById("TotHostsTurnedOnN").innerHTML = TotTurnedOnHosts;
                document.getElementById("TotHostsInDrainMode").innerHTML = TotTurnedOnInDrainMode;
                document.getElementById("TotHostsRECHBN").innerHTML = TotTurnedOnRECVHB;
                document.getElementById("TotHostsNotRecHB").innerHTML = TotTurnedOnNOHB;
                document.getElementById("TotHostsActiveNowN").innerHTML = TOTRECHBACTIVEHosts;
                document.getElementById("TotHostsIdleNowN").innerHTML = TotTurnedONIdleHosts;
            }

            if (CheckFRow == "TENALERTS") {
                var row = datatableAlerts.insertRow(-1);

                var CheckIfBlank = cells[0]
                if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[1];
                }
            }

            if (CheckFRow == "USERSPERHOST") {
                var row = datatableTwo.insertRow(-1);

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[1];

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[2];

            }

            var dtable = document.getElementById("AnyAlertsDiv");
            dtable.innerHTML = "";
            dtable.appendChild(datatableAlerts);

            var dtable = document.getElementById("HostsStatusPerPoolResultDiv");
            dtable.innerHTML = "";
            dtable.appendChild(datatable);

            var dtable = document.getElementById("AllHostsAttrStatusDIV");
            dtable.innerHTML = "";
            dtable.appendChild(datatableHosts);

            var dtable = document.getElementById("DASHItemsForUsersPerHostDATA");
            dtable.innerHTML = "";
            dtable.appendChild(datatableTwo);

            document.getElementById("DASHRightShowChart").click()

            // Start VM Refresh Routine After this is Finished here...

            $("#MarkUnMarkAllHostsInGrid").click(function(e) {


                if (document.getElementById("MarkUnMarkAllHostsInGrid").checked == true) {

                    var TotHostsNow = 0;

                    var table, rows, i, x, y, shouldSwitch;
                    table = document.getElementById("SessionHostsStatusTable");
                    rows = table.rows;
                    for (i = 1; i < (rows.length); i++) {

                        //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
                        x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                        var ThisNow = x.split('"');
                        var ThisIDNow = ThisNow[1];
                        document.getElementById(ThisIDNow).checked = true;
                        ++TotHostsNow
                    }

                    document.getElementById("AllHostsSelectedNow").innerHTML = TotHostsNow + " Selected";

                } else {
                    var table, rows, i, x, y, shouldSwitch;
                    table = document.getElementById("SessionHostsStatusTable");
                    rows = table.rows;
                    for (i = 1; i < (rows.length); i++) {

                        //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
                        x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                        var ThisNow = x.split('"');
                        var ThisIDNow = ThisNow[1];
                        document.getElementById(ThisIDNow).checked = false;
                    }

                    document.getElementById("AllHostsSelectedNow").innerHTML = "0 Selected";

                }

            });





        }







    }

    function RemoveSingleHostFunction(ThisAllItems) {

        //var ThisDataS = HostPool+":"+RSGroup+":"+HostName;
        var res = ThisAllItems.split(":");
        var ThisHostName = res[0];
        var ThisRsGroup = res[1];
        var ThisPool = res[2];

        document.getElementById("SelectedSingleHostNameN").innerHTML = "Selected Session Host:" + ThisHostName;
        document.getElementById("RemoveSingleHostMod").style.display = "block";
        document.getElementById("SingleHostDelVMResourcesAlso").checked = false;
        document.getElementById("SingleHostRemoveATTR").innerHTML = ThisAllItems;

    }

    function RepairHostFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisHost = res[0];
        var ThisResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to start Repair Process for Host: " + ThisHost + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var FinalHostActionNow = ThisHostAndResGroup + ":REPAIRHOST"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }

    function TurnOnHostFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisHost = res[0];
        var ThisResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Turn On Host: " + ThisHost + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var FinalHostActionNow = ThisHostAndResGroup + ":TURNON"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }

    function RestartSingleHostFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisHost = res[0];
        var ThisResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Restart Host: " + ThisHost + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";
        document.getElementById("ForMultiStringID").innerHTML = ThisHostAndResGroup;

        var FinalHostActionNow = ThisHostAndResGroup + ":RESTART"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }

    function TurnOffHostFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisHost = res[0];
        var ThisResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Turn Off Host: " + ThisHost + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";
        document.getElementById("ForMultiStringID").innerHTML = ThisHostAndResGroup;

        var FinalHostActionNow = ThisHostAndResGroup + ":TURNOFF"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }

    function SetHostFalseFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisHost = res[0];
        var ThisResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Stop Host from accepting connections: " + ThisHost + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";
        document.getElementById("ForMultiStringID").innerHTML = ThisHostAndResGroup;

        var FinalHostActionNow = ThisHostAndResGroup + ":SETFALSE"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }

    function SetHostTrueFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisHost = res[0];
        var ThisResGroup = res[1];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to allow Host to start accepting connections: " + ThisHost + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";
        document.getElementById("ForMultiStringID").innerHTML = ThisHost;

        var FinalHostActionNow = ThisHostAndResGroup + ":SETTRUE"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }

    function TurnOnAllHostFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisPool = res[2];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to turn on all Session Hosts in Host Pool: " + ThisPool + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var FinalHostActionNow = ThisHostAndResGroup + ":TURNONALLHOSTSINPOOL"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }

    function TurnOffAllHostFunction(ThisHostAndResGroup) {

        var res = ThisHostAndResGroup.split(":");
        var ThisPool = res[2];

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to turn off all Session Hosts in Host Pool: " + ThisPool + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var FinalHostActionNow = ThisHostAndResGroup + ":TURNOFFALLHOSTSINPOOL"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;
    }

    $("#DeplAdditionalHostsNowButtonD").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to start the deployment of Session Hosts from Template?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "DEPLSESSHOST";

    });

    function RemoveHostsFromHostHealthFunction(ThisHostPool) {
        document.getElementById("SelectedHostPoolToRemHFrom").innerHTML = "Selected Host Pool:" + ThisHostPool;
        document.getElementById("RemoveAllHostsModN").style.display = "block";
        document.getElementById("DeleteVMResourcesAsWellCheckBox").checked = false;

    }

    $("#RemoveSingleHostNowButton").click(function(e) {

        var EntHostPool = document.getElementById("EnterJustYes").value;

        if (EntHostPool == "Yes" || EntHostPool == "yes") {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = '<span style="color: red;">WARNING: Are you sure you want to remove Session Host from Host Pool?</span>'
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

            var ThisHostAndResGroup = document.getElementById("SingleHostRemoveATTR").innerHTML;
            var FinalHostActionNow = ThisHostAndResGroup + ":REMOVESINGLEHOST"
            document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

        }

    });

    $("#RemoveSessHostsNowButtonDD").click(function(e) {

        var ThisHostPool = document.getElementById("SelectedHostPoolToRemHFrom").innerHTML;
        var res = ThisHostPool.split(":");
        var ThisFinalHostPoolNow = res[1];

        var EntHostPool = document.getElementById("EnterNameOfHostPoolToRemoveSessHostsFrom").value;

        if (ThisFinalHostPoolNow == EntHostPool) {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = '<span style="color: red;">WARNING: Are you sure you want to remove all Session Hosts from Host Pool?</span>'
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

            var FinalHostActionNow = ThisFinalHostPoolNow + ":NONE: " + ThisFinalHostPoolNow + ":REMOVEALLHOSTS"
            document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

        }

    });

    $("#RemoveSelectedHostsButtonDFG").click(function(e) {

        var EntHostPool = document.getElementById("EnterOnlyYesToRemoveSelHosts").value;

        if (EntHostPool == "Yes") {

            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = '<span style="color: red;">WARNING: Are you sure you want to remove selected Session Hosts from Host Pool?</span>'
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

            var FinalHostActionNow = "NONE" + ":NONE: " + "NONE" + ":REMOVESELECETDHOSTS"
            document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

        }

    });


    function DeployNewHostsFromHostHealthFunction(ThisHostPool) {
        document.getElementById("selHostPoolInWhichHostToDeploy").innerHTML = "Selected Host Pool: " + ThisHostPool;
        document.getElementById("DeployNewHostsModN").style.display = "block";

        document.getElementById("DeleteVMResourcesAsWellCheckBox").checked = false;

        var TRPKey = document.getElementById("TRPKeyN").value;
        $.ajax({
            url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var xLeft = document.getElementById("DEPLHostsAllSessHostTemplatesNow");
                    var options = document.querySelectorAll('#DEPLHostsAllSessHostTemplatesNow option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");

                    var rows = res.split("\n");
                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var rUName = cells[0];
                            var CheckTType = cells[3];

                            if (rUName == 'TemplateName') {} else {
                                if (rUName == "" || rUName == null) {} else {
                                    if (CheckTType == "SessionHostTemplate") {
                                        var ThisPoolInFile = cells[2];
                                        if (ThisPoolInFile.toLowerCase() == ThisHostPool.toLowerCase()) {
                                            var optionR = document.createElement("option");
                                            optionR.text = newcell;
                                            xLeft.add(optionR);
                                        }

                                    }
                                }
                            }
                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    }


    $("#FetchSelHostTemplAttrNow").click(function(e) {

        var ThisMsg = "Fetching Host Template. Please Wait...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        var FinalSelTempNow = document.getElementById("DEPLHostsAllSessHostTemplatesNow").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/LoadTempDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': FinalSelTempNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckFRow == "TENIMAGES" || CheckFRow == "LOCATIONS") {

                        } else {

                            if (CheckFRow == "Parameter" || CheckFRow == "Assignment Name") {


                            } else {

                                if (CheckFRow == "" || CheckFRow == null) {

                                } else {

                                    if (cells[0] == "VM Initial Number") {
                                        document.getElementById("TMPAttrVMInitNumber").value = cells[1];
                                        document.getElementById("AddHostsVMInitialNumberN").value = cells[1];

                                    }
                                    if (cells[0] == "Number Of Session Hosts") {
                                        document.getElementById("TMPAttrTotalHostsToDepl").value = cells[1];
                                        document.getElementById("EntNumberOfSessHostsToDeplDD").value = cells[1];
                                    }
                                    if (cells[0] == "Image Source ID") {
                                        document.getElementById("TMPAttrImageSourceID").value = cells[1];
                                    }
                                }

                            }

                        }
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });
    });

    $("#CloseHostRemovalMod").click(function(e) {

        document.getElementById("RemoveAllHostsModN").style.display = "none";

    });

    $("#CloseDeplNewHostMod").click(function(e) {

        document.getElementById("DeployNewHostsModN").style.display = "none";

    });



}
// END: ALL HOSTS HEALTH TASKS

// START: ALL DASHBOARD ITEMS HERE

{

    $("#RefDashItemsForSelTenButton").click(function(e) {


        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("RefDASHSTOPCIRCLE").style.display = "block";

            document.getElementById("NotRunningC").style.display = "block";

            var ThisTen = document.getElementById("DASHAvaTenListNS").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/RefDashItems', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "DASHITEMS";

                        //var ThisCompleteData = data.message;
                        //GetDashItemsStatusFunction(ThisCompleteData)

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }
    });

    function GetDashItemsStatusFunction(ThisCompleteData) {
        // Check Status here and load logs       

        //alert(ThisCompleteData);


        var datatable = document.createElement("table");
        datatable.id = 'ActiveUsersDataTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableTwo = document.createElement("table");
        datatableTwo.id = 'UsersPerHourDataTable'
        datatableTwo.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableThree = document.createElement("table");
        datatableThree.id = 'DashSessionHostsStatusTable'
        datatableThree.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableFour = document.createElement("table");
        datatableFour.id = 'DashHostPoolStatusTable'
        datatableFour.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableFive = document.createElement("table");
        datatableFive.id = 'DashAppGroupsStatusTable'
        datatableFive.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableSix = document.createElement("table");
        datatableSix.id = 'DashTenUsersTable'
        datatableSix.setAttribute('class', 'SummaryTableClassforAzBilling');

        var datatableAlerts = document.createElement("table");
        datatableAlerts.id = 'DashHostsAlertsTable'
        datatableAlerts.setAttribute('class', 'SummaryTableClassforAzBilling');

        const PoolCols = [1, 2, 3, 4, 5, 6, 7, 8]
        const HostCols = [1, 2, 3, 4, 5, 6, 7, 8]

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");

            var CheckFRow = cells[0];
            var CheckSRow = cells[1];

            if (CheckFRow == "LASTREFDATE") {
                var LastRefDate = cells[1];
                document.getElementById("DashLastRefForTen").innerHTML = "Last Refresh: " + LastRefDate;
            }

            if (CheckFRow == "HOSTPOOLS") {
                var row = datatableFour.insertRow(-1);

                if (CheckSRow == "Name") {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }

                    }
                } else {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            if (cells[j] == "Refreshing...") {
                                cell.style.color = "#f96319";
                            }
                        }

                    }

                }
            }

            if (CheckFRow == "SESSIONHOSTS") {
                var row = datatableThree.insertRow(-1);

                if (CheckSRow == "Session Host Name") {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }

                    }
                } else {

                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!HostCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];
                            if (cells[j] == "Refreshing...") {
                                cell.style.color = "#f96319";
                            }
                            if (cells[j] == "VM running") {
                                cell.style.color = "green";
                            }
                            if (cells[j] == "VM deallocated") {
                                cell.style.color = "#f96319";
                            }
                            if (cells[j] == "Unavailable") {
                                cell.style.color = "#f96319";
                            }


                        }
                    }
                }
            }

            if (CheckFRow == "APPGROUPS") {
                var row = datatableFive.insertRow(-1);
                if (CheckSRow == "AppGroupName") {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";

                        }

                    }
                } else {

                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!HostCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];
                        }
                    }
                }
            }

            if (CheckFRow == "CHARTUSERSNUMBER") {
                var row = datatable.insertRow(-1);

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[1];

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[2];

            }

            if (CheckFRow == "USERSPERHOST") {
                var row = datatableTwo.insertRow(-1);

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[1];

                var cell = row.insertCell(-1);
                cell.innerHTML = cells[2];

            }

            if (CheckFRow == "HOSTNUMBERS") {
                var TotHosts = cells[1];
                var TotTurnedOffHosts = cells[2];
                var TotTurnedOnHosts = cells[3];
                var TotTurnedOnInDrainMode = cells[4];
                var TotTurnedOnRECVHB = cells[5];
                var TotTurnedOnNOHB = cells[6];
                var TOTRECHBACTIVEHosts = cells[7];
                var TotTurnedONIdleHosts = cells[8];
                var TotHostsNeeded = cells[9];
                var TotExtraHosts = cells[10];
                var TotConAvg = cells[11];
                var TotHostPools = cells[12];
                var TotAppGroups = cells[13];

                document.getElementById("DASHITotHostPols").innerHTML = TotHostPools;
                document.getElementById("DASHITotAppGroups").innerHTML = TotAppGroups;
                document.getElementById("DASHITotHosts").innerHTML = TotHosts;
                document.getElementById("DASHTotHostsTurnedOn").innerHTML = TotTurnedOnHosts;
                document.getElementById("DASHITurnedOffHosts").innerHTML = TotTurnedOffHosts;
                document.getElementById("DASHTotHostsUnavailable").innerHTML = TotTurnedOnNOHB;
                document.getElementById("DASHTotHostsInDrainMode").innerHTML = TotTurnedOnInDrainMode;
                document.getElementById("DASHITotActiveHosts").innerHTML = TOTRECHBACTIVEHosts;
                document.getElementById("DASHITotIdleHosts").innerHTML = TotTurnedONIdleHosts;

                document.getElementById("DashTotHostsNeeded").innerHTML = TotHostsNeeded;
                document.getElementById("DashTotHostsNeeded").style.fontSize = "24px";

                document.getElementById("DashTotExtraHosts").innerHTML = TotExtraHosts;
                document.getElementById("DashTotExtraHosts").style.fontSize = "24px";

                document.getElementById("DashConnectionAVG").innerHTML = TotConAvg;
                document.getElementById("DashConnectionAVG").style.fontSize = "24px";

                document.getElementById("DASHItemsHostsInDrainMode").innerHTML = TotTurnedOnInDrainMode;
                document.getElementById("DASHItemsHostsInDrainMode").style.fontSize = "24px";

                document.getElementById("DASHItemsHostsUnava").innerHTML = TotTurnedOnNOHB;
                document.getElementById("DASHItemsHostsUnava").style.fontSize = "24px";

                document.getElementById("DASHItemsTotHostsActive").innerHTML = TOTRECHBACTIVEHosts;
                document.getElementById("DASHItemsTotHostsActive").style.fontSize = "24px";

                document.getElementById("DASHItemsHostsIdle").innerHTML = TotTurnedONIdleHosts;
                document.getElementById("DASHItemsHostsIdle").style.fontSize = "24px";
            }

            if (CheckFRow == "TENALERTS") {
                var row = datatableAlerts.insertRow(-1);
                var CheckIfBlank = cells[0]
                if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                    var ThisR = '<i class="fas fa-exclamation-triangle" aria-hidden="true" style="font-size: 11px;color: #ffa700;"></i>'
                    var cell = row.insertCell(-1);
                    cell.innerHTML = ThisR;
                    cell.style.color = "#ff8300";
                    cell.style.fontSize = "11px";
                    cell.style.background = "white";

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[1];
                    cell.style.color = "rgb(130, 130, 130)";
                    cell.style.fontStyle = "italic";
                    cell.style.background = "white";
                    cell.style.padding = "10px";
                    cell.style.fontFamily = "Roboto";
                    cell.style.fontWeight = "400";

                }

            }

            var dtable = document.getElementById("DASHAlertData");
            dtable.innerHTML = "";
            dtable.appendChild(datatableAlerts);

            var dtable = document.getElementById("DASHActiveUsersDataDIV");
            dtable.innerHTML = "";
            dtable.appendChild(datatable);

            var dtable = document.getElementById("DASHItemsForUsersPerHostDATA");
            dtable.innerHTML = "";
            dtable.appendChild(datatableTwo);

            var dtable = document.getElementById("DASHItemsFORHostPools");
            dtable.innerHTML = "";
            dtable.appendChild(datatableFour);

            var dtable = document.getElementById("DASHItemsFORHosts");
            dtable.innerHTML = "";
            dtable.appendChild(datatableThree);

            var dtable = document.getElementById("DASHItemsForAppGroups");
            dtable.innerHTML = "";
            dtable.appendChild(datatableFive);


            document.getElementById("DASHTopShowChart").click();
            document.getElementById("DASHRightShowChart").click();


        }




    }


    function DASHShowUsersChart() {

        Highcharts.chart('DASHActiveUsersChartDIV', {
            data: {
                table: 'ActiveUsersDataTable',
                startColumn: 0
            },
            chart: {
                type: 'pie',
                style: {
                    fontFamily: 'Roboto',
                    color: "#777",
                    fontSize: "8px",
                    fontWeight: "300"
                }
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: ''
                },
                labels: {
                    style: {
                        color: '#777',
                        font: '8px Roboto',
                        fontWeight: "300"
                    }
                },
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });

    }

    function DASHShowUsersPerHostChart() {

        Highcharts.chart('DASHItemsForUsersPerHostCHART', {
            data: {
                table: 'UsersPerHourDataTable',
                startColumn: 0
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: ''
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });

    }

    $("#DASHTopShowData").click(function(e) {

        document.getElementById("DASHActiveUsersDataDIV").style.display = "block";
        document.getElementById("DASHActiveUsersChartDIV").style.display = "none";

    });

    $("#DASHTopShowChart").click(function(e) {

        document.getElementById("DASHActiveUsersDataDIV").style.display = "none";
        document.getElementById("DASHActiveUsersChartDIV").style.display = "block";
        DASHShowUsersChart()
    });


    $("#DASHRightShowData").click(function(e) {

        document.getElementById("DASHItemsForUsersPerHostDATA").style.display = "inline-block";
        document.getElementById("DASHItemsForUsersPerHostCHART").style.display = "none";
        document.getElementById("RCNumDivOrNot").style.display = "none";

    });

    $("#DASHRightShowChart").click(function(e) {

        document.getElementById("DASHItemsForUsersPerHostDATA").style.display = "none";
        document.getElementById("DASHItemsForUsersPerHostCHART").style.display = "inline-block";
        DASHShowUsersPerHostChart()
        document.getElementById("RCNumDivOrNot").style.display = "none";

    });

    $("#DASHSwitchToSelTen").click(function(e) {


        document.getElementById("RefDASHSTOPCIRCLE").style.display = "block";

        var SelTen = document.getElementById("DASHAvaTenListNS").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        var ThisTen = document.getElementById("DASHAvaTenListNS").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];
        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckDashFileStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {
                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("RefDASHSTOPCIRCLE").style.display = "none";
                        }
                    } else {
                        GetDashItemsStatusFunction(data.message)
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("RefAllTaskRunningListButton").click();

                        document.getElementById("RefDASHSTOPCIRCLE").style.display = "none";

                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });



    });

    $("#24HoursSelTEnNNButton").click(function(e) {

        document.getElementById("CollectingDatesFor24HrsCircle").style.display = "inline-block";

        var SelTen = document.getElementById("H24HoursAvaTenListND").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        document.getElementById("Collect24DatesButton").click();

        document.getElementById("CollectingDatesFor24HrsCircle").style.display = "none";

        var ThisVal = $('#24HoursSelONE option').length;
        if (ThisVal > 0) {} else {
            var ThisMsg = "Tenant does not have Cost Analyzer Data...."
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }
        }




    });

    function SessManaAvaSelSwitchButtonHandler() {

        document.getElementById("CollectingSessDetCircle").style.display = "block";

        var SelTen = document.getElementById("SessManagerAavaTenListN").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        var ThisTenant = document.getElementById("SessManagerAavaTenListN").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckSessFileStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTenant,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {

                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("CollectingSessDetCircle").style.display = "none";
                        }

                    } else {
                        GetSessManagerDataNFunction(data.message)
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("RefAllTaskRunningListButton").click();

                        document.getElementById("CollectingSessDetCircle").style.display = "none";
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });
    }

    setInterval(SessManaAvaSelSwitchButtonHandler, MIN_4);

    $("#SessManaAvaSelSwitchButton").click(SessManaAvaSelSwitchButtonHandler);

    function HOSTAvaSelTenButtonNHandler(e) {
        document.getElementById("CollectingHostsStatusCircle").style.display = "block";

        var SelTen = document.getElementById("HOSTHAvaTenListN").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        var ThisTen = document.getElementById("HOSTHAvaTenListN").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckHostHealthFileStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey,
                'userId': userId
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {
                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("CollectingHostsStatusCircle").style.display = "none";
                        }

                    } else {
                        GetHostsHealthStatusFunction(data.message)
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("RefAllTaskRunningListButton").click();

                        document.getElementById("CollectingHostsStatusCircle").style.display = "none";
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });
    }

    setInterval(HOSTAvaSelTenButtonNHandler, MIN_4);

    $("#HOSTAvaSelTenButtonN").click(HOSTAvaSelTenButtonNHandler);

    $("#DEPLAVDSelSelTenButton").click(function(e) {

        document.getElementById("LoadingDeplTempForSelTenCircle").style.display = "block";

        var SelTen = document.getElementById("DEPLAVDAvaTenListND").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        document.getElementById("AVDRefTemplaterNumbers").click();
        document.getElementById("AVDAppGroupNameNow").value = "MyAppGroup";
        document.getElementById("AVDSelectedAppGroupType").value = "Desktop";

        document.getElementById("LoadingDeplTempForSelTenCircle").style.display = "none";

    });


}

// END: ALL DASHBOARD ITEMS HERE

// START: ICON SWITCHING HERE 
{
    $("#ICONSwitchToSessMan").click(function(e) {

        document.getElementById("AVDShowManagementPane").click();
        document.getElementById("MENUSwitchToSessManager").click();

    });

    $("#ICONSwitchToDepAVD").click(function(e) {

        document.getElementById("AVDShowDeployPane").click();
        document.getElementById("MENUSwitchToAVDDeploy").click();

    });

    $("#ICONSwitchToAVDNotCenter").click(function(e) {

        document.getElementById("AVDShowManagePane").click();
        document.getElementById("MENUSwitchToNotCenter").click();

    });

    $("#ICONSwitchTo24Hours").click(function(e) {

        document.getElementById("MENUDashItems").style.display = "block";

        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

        document.getElementById("MENUSwitchTo24HoursStatus").click();

    });

    $("#ICONSwitchToProfileServerStatus").click(function(e) {

        document.getElementById("MENUDashItems").style.display = "block";

        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

        document.getElementById("MENUSwitchToProfilesStatus").click();

    });

    $("#ICONSwitchToAvdMonPane").click(function(e) {

        document.getElementById("MENUDashItems").style.display = "block";

        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

        document.getElementById("MENUSwitchToHostsMonitor").click();

    });

    $("#ICONSwitchToDash").click(function(e) {

        document.getElementById("MENUDashItems").style.display = "block";

        document.getElementById("MENUInfoItems").style.display = "none";
        document.getElementById("MENUManagerItems").style.display = "none";
        document.getElementById("MENUManagementItems").style.display = "none";
        document.getElementById("MENUAnalyzerItems").style.display = "none";
        document.getElementById("MENUSettingsItems").style.display = "none";
        document.getElementById("MENULogItems").style.display = "none";
        document.getElementById("MENUDeployItems").style.display = "none";

        document.getElementById("MENUSwitchToHostsHealth").click();

    });

    $("#ICONSwitchToDash").click(function(e) {

        document.getElementById("AVDShowDashPane").click();
        document.getElementById("MENUSwitchToHostsHealth").click();

    });


}
// END: ICON SWITCHING HERE 

// START: For Alerts and Notifications
{

    $("#OpenNotificationsPaneNN").click(function(e) {

        document.getElementById("AVDRunningNotificationsPane").style.display = "block";
        //document.getElementById("AVDRunningNotificationsPane").style.marginTop = "-00px";

        document.getElementById("RefAllTaskRunningListButton").click();

    });

    $("#NotificationsNumberNow").click(function(e) {

        document.getElementById("AVDRunningNotificationsPane").style.display = "block";
        document.getElementById("AVDRunningNotificationsPane").style.marginTop = "-00px";
        document.getElementById("RefAllTaskRunningListButton").click();

    });


    $("#OpenAVDNotifyAndAlertPane").click(function(e) {

        var ThisMsg = "Feature is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        var ProceedOrNot = "No"
        if (ProceedOrNot == "Yes") {
            document.getElementById("AVDNotificationAndAlertsPane").style.display = "block";
            document.getElementById("AVDNotificationAndAlertsPane").style.marginTop = "-00px";
        }

    });

    $("#CloseTaskRunningModal").click(function(e) {

        //document.getElementById("AVDRunningNotificationsPane").style.marginTop = "-2000px";
        document.getElementById("AVDRunningNotificationsPane").style.display = "none";


    });

    $("#CloseAVDNotifyAlertPane").click(function(e) {

        document.getElementById("AVDNotificationAndAlertsPane").style.display = "none";
        document.getElementById("AVDNotificationAndAlertsPane").style.marginTop = "-900px";

    });

    $("#RefAllNotificationsID").click(function(e) {

        var ProceedOrNot = "Yes";

        var ThisSelNow = document.getElementById("OpenedNotificationNameN").innerHTML;
        var res = ThisSelNow.split(":");
        var Value1 = res[0];
        var Value2 = res[1];
        if (Value2 == "" || Value2 == null) {
            ProceedOrNot = "Yes"
        } else {
            ProceedOrNot = "No"
        }

        if (ProceedOrNot == "Yes") {

            $.ajax({
                url: '/LoadAllNotifications', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                success: function(data) {
                    if (data.message) {

                        var xLeft = document.getElementById("AllNotificationTemplatesD");
                        var options = document.querySelectorAll('#AllNotificationTemplatesD option');
                        options.forEach(o => o.remove());

                        var CopyFrom = document.getElementById("EmailSettingsCopyFrom");
                        var options = document.querySelectorAll('#EmailSettingsCopyFrom option');
                        options.forEach(o => o.remove());

                        let res = data.message.replaceAll('"', "");

                        var rows = res.split("\n");
                        for (var i = 0; i < rows.length; i++) {
                            var cells = rows[i].split(",");
                            if (cells.length > 1) {

                                var newcell = cells[0];

                                if (newcell == 'NName') {} else {
                                    if (newcell == "" || newcell == null) {} else {
                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        xLeft.add(optionR);

                                        var optionR = document.createElement("option");
                                        optionR.text = newcell;
                                        CopyFrom.add(optionR);

                                    }
                                }
                            }
                        }

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });
        }

    });

    $("#RefAllAlertAndNotForTenAndAVDNow").click(function(e) {

        var datatable = document.createElement("table");
        datatable.id = 'AlertAndNotTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/GetAVDAlertFile', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[0];
                        cell.style.background = "#313030";
                        cell.style.color = "#cacaca";
                        cell.style.borderBottom = "1px solid black";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[1];
                        cell.style.background = "#313030";
                        cell.style.borderBottom = "1px solid black";
                        cell.style.color = "#cacaca";

                        var cell = row.insertCell(-1);
                        cell.innerHTML = cells[2];
                        cell.style.background = "#313030";
                        cell.style.color = "#cacaca";
                        cell.style.borderBottom = "1px solid black";

                    }

                    var dtable = document.getElementById("TaskRunningDataDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#RefAllTaskRunningListButton").click(function(e) {

        var datatable = document.createElement("table");
        datatable.id = 'TOPNotificationsTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        var TRPKey = document.getElementById("TRPKeyN").value;
        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        $.ajax({
            url: '/GetTOPAVDNotifications', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'TRPKey': TRPKey,
                'ThisLUser': FinalUserNameNow
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    var totNotsNow = 0

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        CheckFRow = cells[0];

                        if (CheckFRow == "" || CheckFRow == null) {} else {

                            if (CheckFRow == "TASKNAME") {

                                var resall = cells[1].split("#");
                                var FinalTaskStatus = resall[0];
                                var FinalTaskName = resall[1];

                                var TaskRunningPic = '<i id="ssss" class="fa fa-spinner fa-spin" aria-hidden="true" style="margin-right: 7px;font-size: 14px;color: #f00;margin-left: 7px;text-shadow: none;"></i>'
                                var TaskDonePic = '<i id="ssss" class="far fa-check-circle" aria-hidden="true" style="margin-right: 7px;font-size: 14px;color: #05ce05;margin-left: 7px;text-shadow: none;"></i>'
                                var TaskFailedPic = '<i id="ssss" class="fas fa-exclamation-circle" aria-hidden="true" style="margin-right: 7px;font-size: 14px;color: rgb(249, 99, 25);margin-left: 7px;text-shadow: none;"></i>'

                                if (FinalTaskStatus == "Running") {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = TaskRunningPic + FinalTaskName
                                    cell.style.background = "white";
                                    cell.style.fontSize = "12px";
                                    cell.style.lineHeight = "20px";
                                    cell.style.paddingBottom = "0px";
                                    cell.style.fontFamily = "roboto";
                                    cell.style.fontWeight = "500";
                                    cell.style.color = "#555454";

                                    ++totNotsNow;
                                }
                                if (FinalTaskStatus == "Done") {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = TaskDonePic + FinalTaskName
                                    cell.style.background = "white";
                                    cell.style.fontSize = "12px";
                                    cell.style.lineHeight = "20px";
                                    cell.style.paddingBottom = "0px";
                                    cell.style.fontFamily = "roboto";
                                    cell.style.fontWeight = "500";
                                    cell.style.color = "#555454";

                                }
                                if (FinalTaskStatus == "Failed") {
                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = TaskFailedPic + FinalTaskName
                                    cell.style.background = "white";
                                    cell.style.fontSize = "12px";
                                    cell.style.lineHeight = "20px";
                                    cell.style.paddingBottom = "0px";
                                    cell.style.fontFamily = "roboto";
                                    cell.style.fontWeight = "500";
                                    cell.style.color = "#555454";
                                }

                                var GetFurther = FinalTaskName.split(":")
                                var S1 = GetFurther[0];
                                var S2 = GetFurther[1];

                                var DispTaskLog = '<button id = "' + FinalTaskName + '" style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="ShowLogForTaskRunningFunc(id)">Log</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = DispTaskLog;
                                cell.style.background = "white";
                                cell.style.paddingBottom = "0px";

                                var FinalToAppend = FinalTaskStatus + "#" + FinalTaskName;

                                var DismissTask = '<button id = "' + FinalToAppend + '" style="cursor: pointer;background: white;border: 0px solid #c6c6c6;border-radius: 22px;color: #ff6000;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right; font-size:16px;padding:0px; margin:0px;" onclick="DismissTaskFunction(id)">X</button>'
                                var cell = row.insertCell(-1);
                                cell.innerHTML = DismissTask;
                                cell.style.background = "white";
                                cell.style.paddingBottom = "0px";
                                cell.style.paddingLeft = "0px";
                                cell.style.paddingRight = "0px";

                                var row = datatable.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                cell.style.background = "white";
                                cell.style.color = "rgb(135, 136, 136)";
                                cell.style.paddingBottom = "25px";
                                cell.style.fontFamily = "Roboto";
                                cell.style.fontSize = "11px";
                                cell.style.lineHeight = "15px";
                                cell.style.paddingLeft = "37px";
                                cell.style.paddingTop = "0px";

                            }


                        }
                    }
                    var dtable = document.getElementById("TaskRunningDataDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    var FinalNumberNow = totNotsNow;
                    document.getElementById("NotificationsNumberNow").innerHTML = FinalNumberNow;

                    if (FinalNumberNow == 0) {
                        document.getElementById("NotRunningC").style.display = "none";
                    } else {
                        document.getElementById("NotRunningC").style.display = "block";
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#ClearCompletedTasksRunning").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Clear Completed Tasks?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CLEARCOMPLETED";

    });

    $("#TestEmailSettingsNotificationID").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Test Email Settings for Current Notification?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "TESTEMAIL";

    });

    $("#StopAllRunningTasks").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to Dismiss All Running Tasks? You will not be able to see progress of tasks."
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "STOPTASKS";

    });

    $("#OpenSelNotificationNowThisID").click(function(e) {

        var SelTempNow = document.getElementById("AllNotificationTemplatesD").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        document.getElementById("OpenedNotificationNameN").innerHTML = "Notification:" + SelTempNow;

        e.preventDefault();
        $.ajax({
            url: '/LoadNotificationDetails', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'SelTempNow': SelTempNow,
                'ThisLUser': FinalUserNameNow
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'NotEmailSettingsTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckFRow = cells[0];
                        var CheckSRow = cells[1];

                        if (CheckFRow == "EMAILSETTING") {
                            var row = datatable.insertRow(-1);
                            if (CheckSRow == "Item") {

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];

                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];

                                cell.style.backgroundColor = "white";
                                cell.style.color = "#066d95";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "600";
                                cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                                cell.style.position = "sticky";
                                cell.style.zIndex = "22";
                                cell.style.top = "0px";
                                cell.style.fontSize = "12px";
                                cell.style.fontFamily = "Calibri";


                            } else {

                                if (cells[0] == "" || cells[0] == null) {} else {

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[1];
                                    cell.style.background = "#f7f7f7";
                                    cell.style.fontWeight = "500";

                                    var cell = row.insertCell(-1);
                                    cell.innerHTML = cells[2];
                                    cell.style.background = "white";
                                    cell.contentEditable = "true";

                                }
                            }

                        }


                        if (CheckFRow == "NOTSETTINGS") {
                            var NotSelected = cells[1];
                            var EmailSubject = cells[2];
                            var RunEveryHour = cells[3];
                            var NotAMPM = cells[4];
                            var AppTenant = cells[5];
                            var EmailNotifyOption = cells[6];
                            var NotStatus = cells[7];
                            var NotType = cells[8];
                            var NotHourForMailer = cells[9];
                            var NotScope = cells[10];
                            var NotSelectedPool = cells[11];
                            var ReqVMOrNot = cells[12];

                            document.getElementById("SelNotNNName").innerHTML = NotSelected;
                            document.getElementById("OpenedNotificationTypeN").innerHTML = "Type:" + NotType;

                            if (NotStatus == "Enabled") {
                                document.getElementById("SetNOTEnabledOrDisabled").selectedIndex = "0";
                            } else {
                                document.getElementById("SetNOTEnabledOrDisabled").selectedIndex = "1";
                            }
                            if (NotScope == "Tenant-Wise") {
                                document.getElementById("NOTSetSelScope").selectedIndex = "0";
                            } else {
                                document.getElementById("NOTSetSelScope").selectedIndex = "1";
                            }

                            GetNotificationSelectedPoolsNow()

                            document.getElementById("NOTSetSelTenant").value = AppTenant;
                            document.getElementById("NOTSetSelPoolN").value = NotSelectedPool;
                            document.getElementById("SETNotNotifyWhen").value = RunEveryHour;
                            document.getElementById("SETMailerToSendWhen").value = NotHourForMailer;


                        }

                    }

                    var dtable = document.getElementById("NOTSetEmailSettings");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#SaveCurrentNotificationID").click(function(e) {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Save Notification?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "SAVENOT";

    });

}
// END: For Alerts and Notifications


// START: For All Hosts Monitoring
{



    $("#CloseHostActionModal").click(function(e) {

        document.getElementById("HostActionMenuModal").style.display = "none";

    });


    $("#MONShowActiveUsers").click(function(e) {

        var ThisMsg = "Show Active Users cannot be unchecked."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        document.getElementById("MONShowActiveUsers").checked = true;

    });

    $("#LastHostHealthRefButton").click(function(e) {

        document.getElementById("HOSTAvaSelTenButtonN").click();

    });

    $("#SingleHostDelVMResourcesAlso").click(function(e) {

        if (document.getElementById("SingleHostDelVMResourcesAlso").checked == true) {
            document.getElementById("SingleHostRemoveHostText").innerHTML = "Session Host will be unattached and removed. Process will DELETE VM Resources such as disk, network cards and other resources.";
            document.getElementById("SingleHostRemoveHostText").style.color = "red";

        } else {
            document.getElementById("SingleHostRemoveHostText").innerHTML = "Session Host will be unattached and removed. However, process will not delete VM Resources such as disk, network cards and other resources."
            document.getElementById("SingleHostRemoveHostText").style.color = "rgb(136, 135, 135)";
        }

    });

    $("#DeleteVMResourcesForSelHosts").click(function(e) {

        if (document.getElementById("DeleteVMResourcesForSelHosts").checked == true) {
            document.getElementById("RemoveSelHostsText").innerHTML = "Session Host will be unattached and removed. Process will DELETE VM Resources such as disk, network cards and other resources.";
            document.getElementById("RemoveSelHostsText").style.color = "red";

        } else {
            document.getElementById("RemoveSelHostsText").innerHTML = "Session Host will be unattached and removed. However, process will not delete VM Resources such as disk, network cards and other resources."
            document.getElementById("RemoveSelHostsText").style.color = "rgb(136, 135, 135)";

        }

    });

    $("#DeleteVMResourcesAsWellCheckBox").click(function(e) {

        if (document.getElementById("DeleteVMResourcesAsWellCheckBox").checked == true) {
            document.getElementById("RemoveHostText").innerHTML = "All Session Hosts from the Host Pool will be unattached and removed. Process will DELETE VM Resources such as disk, network cards and other resources.";
            document.getElementById("RemoveHostText").style.color = "red";
        } else {
            document.getElementById("RemoveHostText").innerHTML = "All Session Hosts from the Host Pool will be unattached and removed. However, process will not delete VM Resources such as disk, network cards and other resources."
            document.getElementById("RemoveHostText").style.color = "rgb(136, 135, 135)";
        }

    });

    $("#MonShowMaxCPUCheckBox").click(function(e) {

        if (document.getElementById("MonShowMaxCPUCheckBox").checked == true) {

            document.getElementById("MonShowMaxMEMCheckBox").checked = false;
            document.getElementById("MonShowAVGCPUCheckBox").checked = false;
            document.getElementById("MonShowAVGMEMCheckBox").checked = false;
        }

    });

    $("#MonShowMaxMEMCheckBox").click(function(e) {

        if (document.getElementById("MonShowMaxMEMCheckBox").checked == true) {

            document.getElementById("MonShowMaxCPUCheckBox").checked = false;
            document.getElementById("MonShowAVGCPUCheckBox").checked = false;
            document.getElementById("MonShowAVGMEMCheckBox").checked = false;
        }

    });

    $("#MonShowAVGCPUCheckBox").click(function(e) {

        if (document.getElementById("MonShowAVGCPUCheckBox").checked == true) {

            document.getElementById("MonShowMaxCPUCheckBox").checked = false;
            document.getElementById("MonShowMaxMEMCheckBox").checked = false;
            document.getElementById("MonShowAVGMEMCheckBox").checked = false;
        }

    });
    $("#MonShowAVGMEMCheckBox").click(function(e) {

        if (document.getElementById("MonShowAVGMEMCheckBox").checked == true) {

            document.getElementById("MonShowMaxCPUCheckBox").checked = false;
            document.getElementById("MonShowMaxMEMCheckBox").checked = false;
            document.getElementById("MonShowAVGCPUCheckBox").checked = false;
        }

    });

    $("#HostActionShowUsersCon").click(function(e) {

        var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;
        var res = ThisHostNow.split(":");
        var ActualHostNow = res[0];

        document.getElementById("ServerMonActionDetailsMod").style.display = "block";
        document.getElementById("WhichHostSelectedActionMonT").innerHTML = "Session Host: " + ActualHostNow
        document.getElementById("WhichActionSelectedID").innerHTML = "Show Users Connected";

        GetServerActionFileNow()

        //document.getElementById("HOSTActionGetServerDataForSelectedAction").click();
    });

    $("#HostActionMemUsagePerUSer").click(function(e) {

        var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;
        var res = ThisHostNow.split(":");
        var ActualHostNow = res[0];

        document.getElementById("ServerMonActionDetailsMod").style.display = "block";
        document.getElementById("WhichHostSelectedActionMonT").innerHTML = "Session Host: " + ActualHostNow
        document.getElementById("WhichActionSelectedID").innerHTML = "Memory Usage Per User";

        GetServerActionFileNow()

        //document.getElementById("HOSTActionGetServerDataForSelectedAction").click();
    });

    function GetServerActionFileNow() {

        document.getElementById("ServerActionCircleNow").style.display = "block";

        var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;
        var res = ThisHostNow.split(":");
        var ActualHostNow = res[0];

        var FinalHostNow = ActualHostNow
        var FinalActionToAct = document.getElementById("WhichActionSelectedID").innerHTML;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var ThisTen = document.getElementById("MONAvaTenList").value;

        var TRPKey = document.getElementById("TRPKeyN").value;
        //ASHISH
        $.ajax({
            url: '/CheckServerActionFile', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'FinalHostNow': FinalHostNow,
                'FinalActionToAct': FinalActionToAct,
                'ThisLUser': FinalUserNameNow,
                'ThisTen': ThisTen,
                'TRPKey': TRPKey,
                "userId": userId
            },
            success: function(data) {
                console.log(data);
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });
    }

    $("#HOSTActionGetServerDataForSelectedAction").click(function(e) {

        document.getElementById("ServerActionCircleNow").style.display = "block";

        var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;
        var res = ThisHostNow.split(":");
        var ActualHostNow = res[0];

        var FinalHostNow = ActualHostNow.replace(/[\r\n]+/gm, "");
        var FinalActionToAct = document.getElementById("WhichActionSelectedID").innerHTML;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var ThisTen = document.getElementById("MONAvaTenList").value;

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault()
        $.ajax({
            url: '/RefServerActionItemsNow', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'FinalHostNow': FinalHostNow,
                'FinalActionToAct': FinalActionToAct,
                'ThisLUser': FinalUserNameNow,
                'ThisTen': ThisTen,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    document.getElementById("WhatToGetFromServer").innerHTML = "SERVERACTIONS_USERSCONNECTED";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });


    });

    function UpdateServerActionItemsFunction(ThisCompleteData) {
        // Check Status here and load logs       

        document.getElementById("ServerActionCircleNow").style.display = "block";

        var datatable = document.createElement("table");
        datatable.id = 'HostActionDataTableDR'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        const PoolCols = [0, 1, 2, 3, 4, 5, 6, 7, 8]

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");

            var CheckFRow = cells[0];
            var CheckSRow = cells[0];

            if (CheckFRow == "LASTUPDATED") {
                document.getElementById("ActionMonLastupdatedDate").innerHTML = "Last Updated: " + cells[1];
            }
            if (CheckFRow == "ENDOFDATA" || CheckFRow == "LASTUPDATED") {

            } else {

                var row = datatable.insertRow(-1);

                if (CheckSRow == "UserPrincipalName" || CheckSRow == "HostName" || CheckSRow == "Host Name" || CheckSRow == "Registry Entry" || CheckSRow == "Profile Path") {
                    for (var j = 0; j < cells.length; j++) {
                        var CheckIfBlank = cells[0]
                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {
                            if (!PoolCols.includes(j)) {
                                continue
                            }
                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[j];

                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";
                        }
                    }
                } else {
                    var WhichACheck = document.getElementById("WhichActionSelectedID").innerHTML;

                    var CheckIfBlank = cells[0]
                    if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                        if (WhichACheck == "Show Users Connected") {

                            var UPNNew = cells[0];
                            var ADUserName = cells[1];
                            var CreateTime = cells[2];
                            var SessID = cells[3];
                            var PoolName = cells[4];
                            var SessHostName = cells[5];
                            var SessState = cells[6];

                            var ShadowAttr = UPNNew + ":" + SessID + ":" + SessHostName;

                            var RemoveUser = '<button id = ' + UPNNew + "_REMOVE" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="SessShortActionFunction(id)"><i class="fas fa-user-times" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Remove</button>'
                            var LogOffUser = '<button id = ' + UPNNew + "_LOGOFF" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="SessShortActionFunction(id)"><i class="fas fa-user-minus" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Logoff</button>'
                            var ShadowSess = '<button id = ' + ShadowAttr + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;" onclick="SessShortActionShadowFunction(id)"><i class="fas fa-people-arrows" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Shadow</button>'

                            var cell = row.insertCell(-1);
                            cell.innerHTML = UPNNew + RemoveUser + LogOffUser;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = ADUserName;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = CreateTime;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = SessID;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = PoolName;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = SessHostName;

                            if (SessState == "Active") {
                                var cell = row.insertCell(-1);
                                cell.innerHTML = SessState + ShadowSess;
                            } else {
                                var cell = row.insertCell(-1);
                                cell.innerHTML = SessState;
                            }



                        }

                        if (WhichACheck == "Memory Usage Per User") {

                            var HostNameNow = cells[0];
                            var UserNow = cells[1];
                            var MemoryNow = cells[2];

                            var AllAttr = HostNameNow + ":" + UserNow;

                            var LogOffUser = '<button id = ' + AllAttr + "_LOGOFF" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="MonitoringActionLogoffUserFunction(id)"><i class="fas fa-user-minus" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Logoff User</button>'

                            var cell = row.insertCell(-1);
                            cell.innerHTML = HostNameNow;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = UserNow;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = MemoryNow;

                        }

                        if (WhichACheck == "Resources Usage Per App") {

                            //Host Name, User Name, Application Process, Memory Usages MB, CPU Usages, Application Path
                            var HostNameNow = cells[0];
                            var UserNow = cells[1];
                            var AppProcess = cells[2];
                            var MemUsageMB = cells[3];
                            var CPUUsage = cells[4];
                            var AppPath = cells[5];
                            var ProcessID = cells[6];

                            var AllAttr = HostNameNow + ":" + AppProcess + ":" + ProcessID;

                            var KillProcessNow = '<button id = ' + AllAttr + "_LOGOFF" + ' style="cursor: pointer;background: #e5ffe5;border: 1px solid #c6c6c6;border-radius: 22px;color: #4f4d4d;padding-left: 11px;padding-right: 11px;padding-bottom: 4px;padding-top: 4px;font-family: &quot;Roboto&quot;;font-weight: 500;margin-left: 4px; margin-top: 0px;outline:none;float:right;" onclick="MonitoringActionLogoffUserFunction(id)"><i class="fas fa-user-minus" aria-hidden="true" style="color: #e17c22;margin-right: 5px;"></i>Kill Process</button>'

                            var cell = row.insertCell(-1);
                            cell.innerHTML = HostNameNow;
                            cell.style.width = "140px";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = UserNow;
                            cell.style.width = "140px";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = AppProcess;
                            cell.style.width = "200px";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = MemUsageMB;
                            cell.style.width = "130px";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = CPUUsage + KillProcessNow;
                            cell.style.width = "170px";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = AppPath;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = ProcessID;

                        }

                        if (WhichACheck == "Show User Profiles") {

                            //Profile Path, VDH Path, Outlook Cache Mode, Last Profile Load Time
                            var ProfPath = cells[0];
                            var VHDPath = cells[1];
                            var OutLookCEnabled = cells[2];
                            var LastProfLoadTime = cells[3];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = ProfPath;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = VHDPath;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = OutLookCEnabled;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = LastProfLoadTime;

                        }

                        if (WhichACheck == "Show FSLogix Config") {

                            //Registry Entry,Value
                            var RegEntry = cells[0];
                            var RegValue = cells[1];

                            var cell = row.insertCell(-1);
                            cell.innerHTML = RegEntry;

                            var cell = row.insertCell(-1);
                            cell.innerHTML = RegValue;

                        }

                    }

                }

            }
        }

        var dtable = document.getElementById("SelectedActionDataDiv");
        dtable.innerHTML = "";
        dtable.appendChild(datatable);

        document.getElementById("ServerActionCircleNow").style.display = "none";


    }


    $("#EnableProactiveMonitoringCheckBox").click(function(e) {

        if (document.getElementById("EnableProactiveMonitoringCheckBox").checked == true) {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to enable Proactive Monitoring for Selected Tenant? Session Hosts will be refreshed every 5 minutes."
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "ENABLEPROACTIVEMON";

        } else {
            var DoWhatWithMonTimer = "DisableNow"
            FunctionEnableDisableMonTimer(DoWhatWithMonTimer)

        }

    });

    $("#CloseHostActionBarNR").click(function(e) {

        document.getElementById("ServerMonActionDetailsMod").style.display = "none";

    });

    $("#MonSelSelTen").click(function(e) {

        //document.getElementById("SelHostNowInMonT").innerHTML = ThisHost;
        //document.getElementById("AllHostActionsNHere").style.minWidth = "141px";
        //document.getElementById("AllHostActionsNHere").style.width = "141px";
        //document.getElementById("AllBlocksAction").style.display = "block";

        //document.getElementById("CloseHostActionDIVD").click();
        document.getElementById("SelHostNowInMonT").innerHTML = "";

        document.getElementById("MonRefCircleForA").style.display = "block";

        var SelTen = document.getElementById("MONAvaTenList").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        var ThisTen = document.getElementById("MONAvaTenList").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckMonitoringFileStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {
                        if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                            document.getElementById("MonRefCircleForA").style.display = "none";
                        }
                    } else {
                        GetMonItemsFunction(data.message)
                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("RefAllTaskRunningListButton").click();

                        document.getElementById("MonRefCircleForA").style.display = "none";
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });



    });

    $("#CloseHostActionDIVD").click(function(e) {

        document.getElementById("AllHostActionsNHere").style.minWidth = "0px";
        document.getElementById("AllHostActionsNHere").style.width = "0px";
        document.getElementById("AllBlocksAction").style.display = "none";

    });

    $("#MonUpdateViewButton").click(function(e) {

        document.getElementById("MonRefCircleForA").style.display = "block";

        var ThisTen = document.getElementById("MONAvaTenList").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TotColCount = document.getElementById("TotColCountForMon").value;
        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CallJustUpdateMonCalls', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTen': ThisTen,
                'ThisLUser': FinalUserNameNow,
                'TotColCount': TotColCount,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var ThisCompleteData = data.message;
                    GetMonItemsFunction(ThisCompleteData)

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });



    });

    $("#MonRefNowForall").click(function(e) {

        var DemoOrNot = document.getElementById("DOrNot").innerHTML;
        if (DemoOrNot == "DEMO") {
            var ThisMsg = "Task is not available in Demo Mode!"
            document.getElementById("FootMessageID").innerHTML = ThisMsg;
            document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
            document.getElementById("GettingReadyID").style.display = "none";
            var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

            function FunctionFooterDIV() {
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                clearInterval(MyTimerFooter);
            }

        } else {

            document.getElementById("NotRunningC").style.display = "block";

            document.getElementById("MonRefCircleForA").style.display = "block";

            var ThisTen = document.getElementById("MONAvaTenList").value;

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TotColCount = document.getElementById("TotColCountForMon").value;
            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/RefHostMonItems', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisTen': ThisTen,
                    'ThisLUser': FinalUserNameNow,
                    'TotColCount': TotColCount,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "SESSMONITEMS";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });


        }

    });



    function GetMonItemsFunction(ThisCompleteData) {
        // Check Status here and load logs

        var FiltCheckNow = document.getElementById("FiltMonNowListAA").value;

        document.getElementById("MonRefCircleForA").style.display = "block";

        var datatable = document.createElement("table");
        datatable.id = 'ActiveSessionHostsMonitoringTable'
        datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

        const MonCols = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]

        var WhichView = 1
        var TextName = "Max.CPU"
        if (document.getElementById("MonShowMaxCPUCheckBox").checked == true) {
            WhichView = 1
            var TextName = "Max.CPU"
        }
        if (document.getElementById("MonShowMaxMEMCheckBox").checked == true) {
            WhichView = 2
            var TextName = "Max.MEM"
        }
        if (document.getElementById("MonShowAVGCPUCheckBox").checked == true) {
            WhichView = 3
            var TextName = "Avg.CPU"
        }
        if (document.getElementById("MonShowAVGMEMCheckBox").checked == true) {
            WhichView = 4
            var TextName = "Avg.CPU"
        }

        let res = ThisCompleteData.replaceAll('"', "");
        var rows = res.split("\n");

        for (var i = 0; i < rows.length; i++) {
            var cells = rows[i].split(",");

            var CheckFRow = cells[0];
            var CheckSRow = cells[1];

            if (CheckFRow == "WORKSPACEIDSTATUS") {
                var IDCheckNow = cells[1];

                if (IDCheckNow == "Yes") {
                    document.getElementById("MonShowIDOne").style.display = "none";
                    document.getElementById("MonShowIDTwo").style.display = "none";
                }
                if (IDCheckNow == "No") {
                    document.getElementById("MonShowIDOne").style.display = "block";
                    document.getElementById("MonShowIDTwo").style.display = "block";
                }

            }

            if (CheckFRow == "MONNUMBER") {
                var MTotActiveUsers = cells[1];
                var MTotActiveHosts = cells[2];
                var mMaxCPU = cells[3];
                var mAvgCPU = cells[4];
                var mMaxMem = cells[5];
                var mAvgMem = cells[6];

                document.getElementById("MONTotActiveUsersF").innerHTML = MTotActiveUsers;
                document.getElementById("MONActiveHostsNIN").innerHTML = MTotActiveHosts;
                document.getElementById("MONMaxCPUNIN").innerHTML = mMaxCPU;
                document.getElementById("MonAvgCPUInF").innerHTML = mAvgCPU;
                document.getElementById("MONMaxMemByHost").innerHTML = mMaxMem;
                document.getElementById("MONAvgMemForHS").innerHTML = mAvgMem;
            }

            if (CheckFRow == "LASTREFDATE") {
                var LastRefDate = cells[1];
                document.getElementById("MonLastRefDate").innerHTML = "Last Refresh: " + LastRefDate;
            }

            if (CheckFRow == "SERVER" || CheckFRow == "VALUE" || CheckFRow == "OTHERATTR") {
                var row = datatable.insertRow(-1);

                if (CheckFRow == "SERVER") {

                    var CheckSNNow = cells[1];
                    var resnew = CheckSNNow.split(":");
                    var ServerStatus = resnew[0];
                    var ServerName = resnew[1];
                    var ServerHostPool = resnew[2];
                    var ServerResGroup = resnew[3];
                    var ValueTotUsers = resnew[4];
                    var ValueMaxCPU = resnew[5];
                    var ValueMaxMem = resnew[6];
                    var ValueAvgCPU = resnew[7];
                    var ValueAvgMem = resnew[8];

                    var AllOrNot = "No"

                    if (FiltCheckNow == "All Hosts") {
                        AllOrNot = "Yes"
                    }

                    if (AllOrNot == "Yes") {

                        var AlertValueCheck = parseInt(ValueMaxMem);

                        var EntAlertValue = document.getElementById("MonAlertValueT").value;
                        var EntNewValue = parseInt(EntAlertValue);

                        var RR = '<span style="color: #484848;font-size: 12px;font-weight: 500;font-family: &quot;Roboto&quot;">Host Pool: </span>'
                        var RROne = '<span style="color: #484848;font-size: 12px;font-weight: 500;font-family: &quot;Roboto&quot;"> Resource Group: </span>'

                        var UserSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;">Sessions: </span>'
                        var MaxCPUSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> MaxCPU: </span>'
                        var MaxMEMspan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> MaxMEM: </span>'
                        var AVGCPUSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> AvgCPU: </span>'
                        var AVGMEMSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> AvgMEM: </span>'

                        var StyleNow = 'style="border: 0px solid #b9b9b9;margin-left: auto;margin-right: auto;padding: 30px;border-radius: 100px; line-height: 33px;"'

                        var StyleNowPool = 'style="border: 2px solid #2b2a2a;margin-left: auto;margin-right: auto;width: auto;padding: 12px;border-radius: 0px; padding-bottom: 12px;display: inline-block;"'

                        var MonValueOneNow = '<span style="color:black; font-size: 32px;font-weight: 500;color;#07c407;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueTotUsers + '</span>'
                        var MonValueTwoNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueMaxCPU + '</span>'
                        var MonValueThreeNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueMaxMem + '</span>'
                        var MonValueFourNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueAvgCPU + '</span>'
                        var MonValueFiveNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueAvgMem + '</span>'

                        //<p style="font-size: 16px;">-Users-0-MaxCPU-0-MaxMem-0-AvgCPU-0-AvgMem-0</p>
                        var FinalMonValueString = "<p " + StyleNow + ">" + UserSpan + MonValueOneNow + MaxCPUSpan + MonValueTwoNow + MaxMEMspan + MonValueThreeNow + AVGCPUSpan + MonValueFourNow + AVGMEMSpan + MonValueFiveNow + "</p>";
                        var FinalPoolAndResGroupString = "<p " + StyleNowPool + ">" + RR + ServerHostPool + RROne + ServerResGroup + "</p>";

                        var HostInfoB = '<span style="background: white;color: #0aafe3;border-bottom: 1px solid #0aafe3;padding: 1px;font-size: 11px;font-family: &quot;Roboto&quot;;font-weight: 400;border-radius: 0px;margin-left: 10px;">-</span><span id="' + ServerName + '" style="float: right;margin-top: 9px;" onclick="AllHostActionsForMonitoring(id)"><i class="fa fa-bars" aria-hidden="true" style="color: #4f4e4e;font-size:14px;margin-right: 0px;float: right;margin-top: -10px;"></i></span>'
                        if (ServerStatus == "UP") {
                            var ServerNameInsert = '<p id="' + ServerName + '"' + ' style="margin: 0px; min-width: 270px; border: 2px solid #2d2d2d;width: 630px;padding: 10px;margin-top: 0px;box-shadow: 1px 1px 1px #d3d4d5;border-radius: 0px;margin-bottom: 5px;margin-left:auto;margin-right:auto;"><span style="margin: 0px;height: 20px;width: 20px;background: white;"><i class="fa fa-circle" aria-hidden="true" style="color: #2aea2a;font-size:10px;margin-right: 10px;"></i></span>' + ServerName + HostInfoB + '</p>'
                        }
                        if (ServerStatus == "DOWN") {
                            var ServerNameInsert = '<p id="' + ServerName + '"' + ' style="margin: 0px; min-width: 270px; border: 2px solid #2d2d2d;width: 630px;padding: 10px;margin-top: 0px;box-shadow: 1px 1px 1px #d3d4d5;border-radius: 0px;margin-bottom: 5px;margin-left:auto;margin-right:auto;"><span style="margin: 0px;height: 20px;width: 20px;background: white;"><i class="fa fa-circle" aria-hidden="true" style="color: #ea572a;font-size:10px;margin-right: 10px;"></i></span>' + ServerName + HostInfoB + '</p>'
                        }

                        var cell = row.insertCell(-1);
                        var ThisCellN = ServerNameInsert + FinalPoolAndResGroupString + FinalMonValueString;
                        cell.innerHTML = ThisCellN;

                        cell.style.backgroundColor = "white";
                        cell.style.color = "rgb(210, 127, 19)";
                        cell.style.textAlign = "left";
                        cell.style.letterSpacing = "0px";
                        cell.style.fontWeight = "500";
                        cell.style.fontFamily = "Roboto";
                        cell.style.fontSize = "11px";
                        cell.style.background = "white";
                        cell.style.textAlign = "Center";
                        cell.style.lineHeight = "14px !Important";
                        cell.style.verticalAlign = "bottom";
                        cell.style.paddingBottom = "6px";
                    }

                    if (AllOrNot == "No") {

                        if (FiltCheckNow == "Idle Hosts") {

                            if (ValueTotUsers == "0") {

                                var AlertValueCheck = parseInt(ValueMaxMem);

                                var EntAlertValue = document.getElementById("MonAlertValueT").value;
                                var EntNewValue = parseInt(EntAlertValue);

                                var RR = '<span style="color: #484848;font-size: 12px;font-weight: 500;font-family: &quot;Roboto&quot;">Host Pool: </span>'
                                var RROne = '<span style="color: #484848;font-size: 12px;font-weight: 500;font-family: &quot;Roboto&quot;"> Resource Group: </span>'

                                var UserSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;">Sessions: </span>'
                                var MaxCPUSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> MaxCPU: </span>'
                                var MaxMEMspan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> MaxMEM: </span>'
                                var AVGCPUSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> AvgCPU: </span>'
                                var AVGMEMSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> AvgMEM: </span>'

                                var StyleNow = 'style="border: 0px solid #b9b9b9;margin-left: auto;margin-right: auto;padding: 30px;border-radius: 100px; line-height: 33px;"'

                                var StyleNowPool = 'style="border: 2px solid #2b2a2a;margin-left: auto;margin-right: auto;width: auto;padding: 12px;border-radius: 0px; padding-bottom: 12px;display: inline-block;"'

                                var MonValueOneNow = '<span style="color:black; font-size: 32px;font-weight: 500;color;#07c407;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueTotUsers + '</span>'
                                var MonValueTwoNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueMaxCPU + '</span>'
                                var MonValueThreeNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueMaxMem + '</span>'
                                var MonValueFourNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueAvgCPU + '</span>'
                                var MonValueFiveNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueAvgMem + '</span>'

                                //<p style="font-size: 16px;">-Users-0-MaxCPU-0-MaxMem-0-AvgCPU-0-AvgMem-0</p>
                                var FinalMonValueString = "<p " + StyleNow + ">" + UserSpan + MonValueOneNow + MaxCPUSpan + MonValueTwoNow + MaxMEMspan + MonValueThreeNow + AVGCPUSpan + MonValueFourNow + AVGMEMSpan + MonValueFiveNow + "</p>";
                                var FinalPoolAndResGroupString = "<p " + StyleNowPool + ">" + RR + ServerHostPool + RROne + ServerResGroup + "</p>";

                                var HostInfoB = '<span style="background: white;color: #0aafe3;border-bottom: 1px solid #0aafe3;padding: 1px;font-size: 11px;font-family: &quot;Roboto&quot;;font-weight: 400;border-radius: 0px;margin-left: 10px;">-</span><span id="' + ServerName + '" style="float: right;margin-top: 9px;" onclick="AllHostActionsForMonitoring(id)"><i class="fa fa-bars" aria-hidden="true" style="color: #4f4e4e;font-size:14px;margin-right: 0px;float: right;margin-top: -10px;"></i></span>'
                                if (ServerStatus == "UP") {
                                    var ServerNameInsert = '<p id="' + ServerName + '"' + ' style="margin: 0px; min-width: 270px; border: 2px solid #2d2d2d;width: 630px;padding: 10px;margin-top: 0px;box-shadow: 1px 1px 1px #d3d4d5;border-radius: 0px;margin-bottom: 5px;margin-left:auto;margin-right:auto;"><span style="margin: 0px;height: 20px;width: 20px;background: white;"><i class="fa fa-circle" aria-hidden="true" style="color: #2aea2a;font-size:10px;margin-right: 10px;"></i></span>' + ServerName + HostInfoB + '</p>'
                                }
                                if (ServerStatus == "DOWN") {
                                    var ServerNameInsert = '<p id="' + ServerName + '"' + ' style="margin: 0px; min-width: 270px; border: 2px solid #2d2d2d;width: 630px;padding: 10px;margin-top: 0px;box-shadow: 1px 1px 1px #d3d4d5;border-radius: 0px;margin-bottom: 5px;margin-left:auto;margin-right:auto;"><span style="margin: 0px;height: 20px;width: 20px;background: white;"><i class="fa fa-circle" aria-hidden="true" style="color: #ea572a;font-size:10px;margin-right: 10px;"></i></span>' + ServerName + HostInfoB + '</p>'
                                }

                                var cell = row.insertCell(-1);
                                var ThisCellN = ServerNameInsert + FinalPoolAndResGroupString + FinalMonValueString;
                                cell.innerHTML = ThisCellN;

                                cell.style.backgroundColor = "white";
                                cell.style.color = "rgb(210, 127, 19)";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "500";
                                cell.style.fontFamily = "Roboto";
                                cell.style.fontSize = "11px";
                                cell.style.background = "white";
                                cell.style.textAlign = "Center";
                                cell.style.lineHeight = "14px !Important";
                                cell.style.verticalAlign = "bottom";
                                cell.style.paddingBottom = "6px";
                            }



                        }

                        if (FiltCheckNow == "Active Hosts") {

                            if (ValueTotUsers != "0") {

                                var AlertValueCheck = parseInt(ValueMaxMem);

                                var EntAlertValue = document.getElementById("MonAlertValueT").value;
                                var EntNewValue = parseInt(EntAlertValue);

                                var RR = '<span style="color: #484848;font-size: 12px;font-weight: 500;font-family: &quot;Roboto&quot;">Host Pool: </span>'
                                var RROne = '<span style="color: #484848;font-size: 12px;font-weight: 500;font-family: &quot;Roboto&quot;"> Resource Group: </span>'

                                var UserSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;">Sessions: </span>'
                                var MaxCPUSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> MaxCPU: </span>'
                                var MaxMEMspan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> MaxMEM: </span>'
                                var AVGCPUSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> AvgCPU: </span>'
                                var AVGMEMSpan = '<span style="color: #484848;font-size: 12px;font-weight: 100;font-family: &quot;Roboto&quot;"> AvgMEM: </span>'

                                var StyleNow = 'style="border: 0px solid #b9b9b9;margin-left: auto;margin-right: auto;padding: 30px;border-radius: 100px; line-height: 33px;"'

                                var StyleNowPool = 'style="border: 2px solid #2b2a2a;margin-left: auto;margin-right: auto;width: auto;padding: 12px;border-radius: 0px; padding-bottom: 12px;display: inline-block;"'

                                var MonValueOneNow = '<span style="color:black; font-size: 32px;font-weight: 500;color;#07c407;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueTotUsers + '</span>'
                                var MonValueTwoNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueMaxCPU + '</span>'
                                var MonValueThreeNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueMaxMem + '</span>'
                                var MonValueFourNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueAvgCPU + '</span>'
                                var MonValueFiveNow = '<span style="color:black; font-size: 32px;font-weight: 100;font-family: &quot;Roboto&quot;;margin-right: 10px;">' + ValueAvgMem + '</span>'

                                //<p style="font-size: 16px;">-Users-0-MaxCPU-0-MaxMem-0-AvgCPU-0-AvgMem-0</p>
                                var FinalMonValueString = "<p " + StyleNow + ">" + UserSpan + MonValueOneNow + MaxCPUSpan + MonValueTwoNow + MaxMEMspan + MonValueThreeNow + AVGCPUSpan + MonValueFourNow + AVGMEMSpan + MonValueFiveNow + "</p>";
                                var FinalPoolAndResGroupString = "<p " + StyleNowPool + ">" + RR + ServerHostPool + RROne + ServerResGroup + "</p>";

                                var HostInfoB = '<span style="background: white;color: #0aafe3;border-bottom: 1px solid #0aafe3;padding: 1px;font-size: 11px;font-family: &quot;Roboto&quot;;font-weight: 400;border-radius: 0px;margin-left: 10px;">-</span><span id="' + ServerName + '" style="float: right;margin-top: 9px;" onclick="AllHostActionsForMonitoring(id)"><i class="fa fa-bars" aria-hidden="true" style="color: #4f4e4e;font-size:14px;margin-right: 0px;float: right;margin-top: -10px;"></i></span>'
                                if (ServerStatus == "UP") {
                                    var ServerNameInsert = '<p id="' + ServerName + '"' + ' style="margin: 0px; min-width: 270px; border: 2px solid #2d2d2d;width: 630px;padding: 10px;margin-top: 0px;box-shadow: 1px 1px 1px #d3d4d5;border-radius: 0px;margin-bottom: 5px;margin-left:auto;margin-right:auto;"><span style="margin: 0px;height: 20px;width: 20px;background: white;"><i class="fa fa-circle" aria-hidden="true" style="color: #2aea2a;font-size:10px;margin-right: 10px;"></i></span>' + ServerName + HostInfoB + '</p>'
                                }
                                if (ServerStatus == "DOWN") {
                                    var ServerNameInsert = '<p id="' + ServerName + '"' + ' style="margin: 0px; min-width: 270px; border: 2px solid #2d2d2d;width: 630px;padding: 10px;margin-top: 0px;box-shadow: 1px 1px 1px #d3d4d5;border-radius: 0px;margin-bottom: 5px;margin-left:auto;margin-right:auto;"><span style="margin: 0px;height: 20px;width: 20px;background: white;"><i class="fa fa-circle" aria-hidden="true" style="color: #ea572a;font-size:10px;margin-right: 10px;"></i></span>' + ServerName + HostInfoB + '</p>'
                                }

                                var cell = row.insertCell(-1);
                                var ThisCellN = ServerNameInsert + FinalPoolAndResGroupString + FinalMonValueString;
                                cell.innerHTML = ThisCellN;

                                cell.style.backgroundColor = "white";
                                cell.style.color = "rgb(210, 127, 19)";
                                cell.style.textAlign = "left";
                                cell.style.letterSpacing = "0px";
                                cell.style.fontWeight = "500";
                                cell.style.fontFamily = "Roboto";
                                cell.style.fontSize = "11px";
                                cell.style.background = "white";
                                cell.style.textAlign = "Center";
                                cell.style.lineHeight = "14px !Important";
                                cell.style.verticalAlign = "bottom";
                                cell.style.paddingBottom = "6px";
                            }



                        }

                    }

                }

            }

            var dtable = document.getElementById("MonitoringDataDivForMonS");
            dtable.innerHTML = "";
            dtable.appendChild(datatable);

            document.getElementById("MonRefCircleForA").style.display = "none";

        }



    }

    function AllHostActionsForMonitoring(ThisHost) {

        document.getElementById("SelHostNowInMonT").innerHTML = ThisHost;
        document.getElementById("AllHostActionsNHere").style.minWidth = "141px";
        document.getElementById("AllHostActionsNHere").style.width = "141px";
        document.getElementById("AllBlocksAction").style.display = "block";

    }

}
// END: For All Hosts Monitoring

// START: MANAGEMENT OPTIONS HERE
{

    $("#ManOptRefAllAgentsStatus").click(function(e) {

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CheckAgentStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    var InHTML = '<i class="fa fa-play-circle-o" aria-hidden="true" style="/*! font-size: 22px; */"></i>'

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var ThisService = cells[0];
                        var ThisStatus = cells[1];

                        if (ThisService == "COST") {
                            if (ThisStatus == "STARTED") {
                                document.getElementById("ManOPTAgentOneStatus").innerHTML = "Running";
                                document.getElementById("ManOPTAgentOneStatus").style.color = "green";
                                //document.getElementById("ManOptStartCostAgent").innerHTML = InHTML + "Stop Policy Agent";
                            } else {
                                document.getElementById("ManOPTAgentOneStatus").innerHTML = "Stopped";
                                document.getElementById("ManOPTAgentOneStatus").style.color = "red";
                                //document.getElementById("ManOptStartCostAgent").innerHTML = InHTML + "Start Policy Agent";
                            }
                        }

                        if (ThisService == "NOTIFICATION") {
                            if (ThisStatus == "STARTED") {
                                document.getElementById("ManOPTAgentTwoStatus").innerHTML = "Running";
                                document.getElementById("ManOPTAgentTwoStatus").style.color = "green";
                                //document.getElementById("ManOptStartPolicyAgent").innerHTML = InHTML + "Stop Policy Agent";

                            } else {
                                document.getElementById("ManOPTAgentTwoStatus").innerHTML = "Stopped";
                                document.getElementById("ManOPTAgentTwoStatus").style.color = "red";
                                //document.getElementById("ManOptStartPolicyAgent").innerHTML = InHTML + "Start Policy Agent";
                            }
                        }

                        if (ThisService == "POLICY") {
                            if (ThisStatus == "STARTED") {
                                document.getElementById("ManOPTAgentThreeStatus").innerHTML = "Running";
                                document.getElementById("ManOPTAgentThreeStatus").style.color = "green";
                                //document.getElementById("ManOptStartNotifyAgent").innerHTML = InHTML + "Stop Policy Agent";
                            } else {
                                document.getElementById("ManOPTAgentThreeStatus").innerHTML = "Stopped";
                                document.getElementById("ManOPTAgentThreeStatus").style.color = "red";
                                //document.getElementById("ManOptStartNotifyAgent").innerHTML = InHTML + "Start Policy Agent";
                            }
                        }

                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";

                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    });

    $("#ManOptStartPolicyAgent").click(function(e) {

        if (document.getElementById("ManOPTAgentThreeStatus").innerHTML == "Running") {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to STOP Policy Agent?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "STARTPOLICYAGENT";

        } else {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to START Policy Agent?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "STOPPOLICYAGENT";

        }


    });

    $("#ManOptStartNotifyAgent").click(function(e) {

        if (document.getElementById("ManOPTAgentTwoStatus").innerHTML == "Running") {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to STOP Notification Center?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "STOPNOTIFYAGENT";

        } else {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to START Notification Center?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "STARTNOTIFYAGENT";

        }


    });

    $("#ManOptStartCostAgent").click(function(e) {

        if (document.getElementById("ManOPTAgentOneStatus").innerHTML == "Running") {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to STOP Cost Analyzer Agent?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "STARTCOSTAGENT";

        } else {
            document.getElementById("ConfirmDBox").style.display = "block";
            var MSGNow = "Do you want to START Cost Analyzer Agent?"
            document.getElementById("TakeActionMSG").innerHTML = MSGNow;
            document.getElementById("ActionDoWhat").innerHTML = "STOPCOSTAGENT";

        }


    });


}

function CallAgentOptScript(WhatToDoNow) {

    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
    var res = ThisLUserNow.split("@");
    var FinalUserNameNow = res[0];

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/CallAgentActionScript', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisUser': FinalUserNameNow,
            'WhatToDoNow': WhatToDoNow,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                let res = data.message.replaceAll('"', "");
                if (data.message == "Done") {
                    document.getElementById("ManOptRefAllAgentsStatus").click();
                }


            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });



}



// START: COST ANALYZER PANE
{

    $("#CostAnaSwitchToTen").click(function(e) {

        document.getElementById("CollectingDatesFor24HrsCircleRTD").style.display = "inline-block";

        var SelTen = document.getElementById("CostAnalyzerTens").value;
        document.getElementById("SelectedAVDTenNow").innerHTML = "Tenant :" + SelTen;

        document.getElementById("CollectCostTenDates").click();

        document.getElementById("CollectingDatesFor24HrsCircleRTD").style.display = "none";

    });

    $("#CollectCostTenDates").click(function(e) {

        var ThisTenant = document.getElementById("CostAnalyzerTens").value;
        var FinalTenSelected = ThisTenant;

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/GetCostTenDates', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenant': FinalTenSelected,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) { // That means if there is data available

                    var xLeft = document.getElementById("CostAnaAllTenDates");
                    var xPools = document.getElementById("CostAnaSelectScope");

                    $('#CostAnaAllTenDates').empty();
                    $('#CostAnaSelectScope').empty();

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        if (cells.length > 1) {

                            var newcell = cells[0];
                            var ThisDataNow = cells[1];

                            if (newcell == '24DATES') {
                                var optionR = document.createElement("option");
                                optionR.text = ThisDataNow;
                                xLeft.add(optionR);
                            }
                            if (newcell == 'HOSTPOOLS') {
                                var optionRT = document.createElement("option");
                                optionRT.text = ThisDataNow;
                                xPools.add(optionRT);
                            }

                        }
                    }

                    var datatable = document.createElement("table");
                    datatable.id = 'CostAnaAllDatesForWeekChartTable'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var newcell = cells[0];
                        var ThisDataNow = cells[1];

                        if (newcell == '24DATES') {

                            var row = datatable.insertRow(-1);

                            var ThisMarkUnAll = '<input id="' + ThisDataNow + '" type="checkbox" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>'
                            var cell = row.insertCell(-1);
                            cell.innerHTML = ThisMarkUnAll;
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";
                            cell.style.textAlign = "Center";
                            cell.style.width = "40px";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];
                        }
                    }

                    var dtable = document.getElementById("AlldatesLoadedHere");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    document.getElementById("SuperNovaStatusID").style.color = "red";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
            }
        });



    });


    $("#CostAnaGenChartButton").click(function(e) {

        var ThisMsg = "Generating Chart. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "block";

        var ThisTenant = document.getElementById("CostAnalyzerTens").value;
        var FinalTenSelected = ThisTenant

        var DateSel = document.getElementById("CostAnaAllTenDates").value;
        var ScopeSel = document.getElementById("CostAnaSelectScope").value;
        var ChartCol = document.getElementById("CostAnaAllChartCols").value;

        //document.getElementById("MaxInEachHourForColName").innerHTML = "Maximum In Each Hour: " + ChartCol;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/GetCostAnaDataNow', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenant': FinalTenSelected,
                'DateSel': DateSel,
                'ScopeSel': ScopeSel,
                'ThisUser': FinalUserNameNow,
                'ChartCol': ChartCol,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'CostAnaChartTableONE'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckIfBlank = cells[0]

                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            if (CheckIfBlank == "TOPCHARTDATA") {
                                var row = datatable.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                            }

                        }
                    }

                    var dtable = document.getElementById("CostAnaTopData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    document.getElementById("TopChartShowChart").click();
                    document.getElementById("BottomChartShowChart").click();

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    document.getElementById("GettingReadyID").style.display = "none";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }


            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                document.getElementById("GettingReadyID").style.display = "none";

            }
        });

    });


    $("#CostAnaGenChartButtonBottom").click(function(e) {

        var ThisMsg = "Generating Chart. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "block";

        var ThisTenant = document.getElementById("CostAnalyzerTens").value;
        var FinalTenSelected = ThisTenant

        var DateSel = document.getElementById("CostAnaAllTenDates").value;
        var ScopeSel = document.getElementById("CostAnaSelectScope").value;
        var ChartCol = document.getElementById("CostAnaAllChartCols").value;
        //var ForWeekNow = document.getElementById("ShowForHowManyWeeks").value;

        //document.getElementById("MaxInEachHourForColName").innerHTML = "Maximum In Each Hour:" + ChartCol;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        var AllHostsValues = [];
        var table, rows, i, x, y, shouldSwitch;
        table = document.getElementById("CostAnaAllDatesForWeekChartTable");
        rows = table.rows;
        for (i = 1; i < (rows.length - 1); i++) {

            //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
            x = rows[i].getElementsByTagName("TD")[0].innerHTML;

            var ThisNow = x.split('"');
            var ThisIDNow = ThisNow[1];
            var CheckThisHost = document.getElementById(ThisIDNow).checked;

            if (CheckThisHost == true) {
                AllHostsValues.push(ThisIDNow);
            }
        }

        var FinalHostValuesNow = AllHostsValues.join('\r\n');

        e.preventDefault();
        $.ajax({
            url: '/GetCostAnaDataNowForWeek', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenant': FinalTenSelected,
                'DateSel': DateSel,
                'ScopeSel': ScopeSel,
                'ThisUser': FinalUserNameNow,
                'ChartCol': ChartCol,
                'TRPKey': TRPKey,
                'FinalHostValuesNow': FinalHostValuesNow
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'CostAnaChartTableONEDown'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckIfBlank = cells[0]

                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            if (CheckIfBlank == "TOPCHARTDATA") {
                                var row = datatable.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];

                            }

                        }
                    }

                    var dtable = document.getElementById("CostAnaBottomData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    document.getElementById("BottomChartShowChart").click();

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    document.getElementById("GettingReadyID").style.display = "none";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }


            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                document.getElementById("GettingReadyID").style.display = "none";

            }
        });

    });


    $("#TopChartShowData").click(function(e) {

        document.getElementById("CostAnaTopChart").style.display = "none";
        document.getElementById("CostAnaTopData").style.display = "block";

    });

    $("#BottomChartShowData").click(function(e) {

        document.getElementById("CostAnaBottomChart").style.display = "none";
        document.getElementById("CostAnaBottomData").style.display = "block";

    });

    $("#BottomChartShowChart").click(function(e) {

        document.getElementById("CostAnaBottomChart").style.display = "block";
        document.getElementById("CostAnaBottomData").style.display = "none";

        Highcharts.chart('CostAnaBottomChart', {
            data: {
                table: 'CostAnaChartTableONEDown',
                startColumn: 1,
                endColumn: 4
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Active Users'
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });

    });

    $("#TopChartShowChart").click(function(e) {

        document.getElementById("CostAnaTopChart").style.display = "block";
        document.getElementById("CostAnaTopData").style.display = "none";

        Highcharts.chart('CostAnaTopChart', {
            data: {
                table: 'CostAnaTopData',
                startColumn: 1,
                endColumn: 3
            },
            chart: {
                type: 'column'
            },
            title: {
                text: ''
            },
            yAxis: {
                allowDecimals: false,
                title: {
                    text: 'Active Users'
                }
            },
            plotOptions: {
                column: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: true
                }
            },

            tooltip: {
                formatter: function() {
                    return '<b>' + this.series.name + '</b><br/>' +
                        this.point.y + ' ' + this.point.name.toLowerCase();
                }
            }
        });



    });


    $("#AddChartcolumnToExistingButtonTwo").click(function(e) {

        var ThisMsg = "This feature is not production ready yet...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        //document.getElementById("AddChartcolumnModalTwo").style.display = "block";

    });

    $("#AddChartcolumnToExistingButton").click(function(e) {

        document.getElementById("AddChartcolumnModal").style.display = "block";
    });

    $("#CloseChartColModal").click(function(e) {

        document.getElementById("AddChartcolumnModal").style.display = "none";
    });

    $("#CloseChartColModalTwo").click(function(e) {

        document.getElementById("AddChartcolumnModalTwo").style.display = "none";
    });

    $("#AddChartColumnNowSS").click(function(e) {

        var ThisMsg = "Adding Chart Column. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "block";

        document.getElementById("AddChartcolumnModal").style.display = "none";

        var ThisTenant = document.getElementById("CostAnalyzerTens").value;
        var FinalTenSelected = ThisTenant

        var DateSel = document.getElementById("CostAnaAllTenDates").value;
        var ScopeSel = document.getElementById("CostAnaSelectScope").value;
        var ChartCol = document.getElementById("CostAnaAllChartCols").value;
        var SecondChartCol = document.getElementById("AddChartcolumnsSelectedCol").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/GetCostAnaDataNowForSecondCol', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenant': FinalTenSelected,
                'DateSel': DateSel,
                'ScopeSel': ScopeSel,
                'ThisUser': FinalUserNameNow,
                'ChartCol': ChartCol,
                'SecondChartCol': SecondChartCol,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'CostAnaChartTableONE'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckIfBlank = cells[0]

                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            if (CheckIfBlank == "TOPCHARTDATA") {
                                var row = datatable.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];

                            }

                        }
                    }

                    var dtable = document.getElementById("CostAnaTopData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    document.getElementById("TopChartShowChart").click();
                    document.getElementById("BottomChartShowChart").click();

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    document.getElementById("GettingReadyID").style.display = "none";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }


            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                document.getElementById("GettingReadyID").style.display = "none";

            }
        });

    });

    $("#AddChartColumnNowSSTwo").click(function(e) {

        var ThisMsg = "Adding Chart Column. Please Wait..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "block";

        document.getElementById("AddChartcolumnModalTwo").style.display = "none";

        var ThisTenant = document.getElementById("CostAnalyzerTens").value;
        var FinalTenSelected = ThisTenant

        var DateSel = document.getElementById("CostAnaAllTenDates").value;
        var ScopeSel = document.getElementById("CostAnaSelectScope").value;
        var ChartCol = document.getElementById("CostAnaAllChartCols").value;
        var SecondChartCol = document.getElementById("AddChartcolumnsSelectedColTwo").value;

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/GetCostAnaDataNowForSecondColTwo', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenant': FinalTenSelected,
                'DateSel': DateSel,
                'ScopeSel': ScopeSel,
                'ThisUser': FinalUserNameNow,
                'ChartCol': ChartCol,
                'SecondChartCol': SecondChartCol,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var datatable = document.createElement("table");
                    datatable.id = 'CostAnaChartTableONETwo'
                    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var CheckIfBlank = cells[0]

                        if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                            if (CheckIfBlank == "TOPCHARTDATA") {
                                var row = datatable.insertRow(-1);

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[2];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[3];
                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[4];

                            }

                        }
                    }

                    var dtable = document.getElementById("CostAnaBottomData");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                    document.getElementById("BottomChartShowChart").click();

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    document.getElementById("GettingReadyID").style.display = "none";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }


            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
                document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                document.getElementById("GettingReadyID").style.display = "none";

            }
        });

    });


}


// END: COST ANALYZER PANE

// END: MANAGEMENT OPTIONS HERE


// START: ALL NEW NOTIFICATIONS HERE
{

    var acc = document.getElementsByClassName("accordionNOT");
    var i;

    for (i = 0; i < acc.length; i++) {
        acc[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var panel = this.nextElementSibling;
            if (panel.style.display === "block") {
                panel.style.display = "none";
            } else {
                panel.style.display = "block";
            }
        });
    }
}

// END: ALL NEW NOTIFICATIONS HERE


function myFunction() {

    var modal = document.getElementById("LoginRegisterModal");
    modal.style.display = "block";

}

$("#ChangeLoginNow").click(function(e) {

    var modal = document.getElementById("LoginRegisterModal");
    modal.style.display = "block";
    document.getElementById("LoginCancelNow").style.display = "block";

});

function SWITCHFuncDashPane() {

    document.getElementById("DASHSwitchToSelTen").click();

}

function SWITCHFuncProfManager() {

    document.getElementById("ProfManaSwitchTenNN").click();

}

function SWITCHFuncAVDCompliance() {

    document.getElementById("SwitchToRiskAndCompList").click();

}

function SWITCHFuncHostHealthPane() {

    document.getElementById("HOSTAvaSelTenButtonN").click();

}

function SWITCHFuncImageManTen() {
    document.getElementById("SwitchToImageManagerTen").click();
}


function SWITCHFuncAVDDeplN() {
    document.getElementById("DEPLAVDSelSelTenButton").click();
}

function SWITCHFunc24HoursPane() {
    document.getElementById("24HoursSelTEnNNButton").click();
}

function SWITCHFuncSessManagerN() {
    document.getElementById("SessManaAvaSelSwitchButton").click();
}

function SWITCHFuncAllMonPane() {
    document.getElementById("MonSelSelTen").click();
}

function SWITCHFuncAssManagerUsers() {
    document.getElementById("ManAssSwitchToSelTenNN").click();
}

function SWITCHFuncCostAnalyzer() {
    document.getElementById("CostAnaSwitchToTen").click();
}

function SWITCHFuncAllInfoAndStatus() {
    document.getElementById("ButtonSwitchToAVDTen").click();
}

function UpdateKPIAgentSettings(ThisHostPoolNow) {

    document.getElementById("KPIAgentSettingsPane").style.display = "block";

    var RC = ThisHostPoolNow.split(":")
    var ThisHostPool = RC[0];
    var ThisTenant = RC[1];

    document.getElementById("KPIagentSelHostPoolNow").innerHTML = ThisHostPool;
    document.getElementById("ThisKPISelectedTenNOWN").innerHTML = ThisTenant;

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/CallLoadKPISettingsForPool', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisHostPool': ThisHostPool,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                let res = data.message.replaceAll('"', "");
                var rows = res.split("\n");

                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");

                    var CheckFRow = cells[0];
                    var CheckSRow = cells[1];

                    var ForThisSetting = cells[1];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];

                    document.getElementById("EnterKPIAgentSharePathHere").value = SettingNow;

                    var ForThisSetting = cells[2];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsOne").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsOne").checked = false;
                    }

                    var ForThisSetting = cells[3];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsTwo").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsTwo").checked = false;
                    }

                    var ForThisSetting = cells[4];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsThree").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsThree").checked = false;
                    }

                    var ForThisSetting = cells[5];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsFour").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsFour").checked = false;
                    }

                    var ForThisSetting = cells[6];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsFive").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsFive").checked = false;
                    }

                    var ForThisSetting = cells[7];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsSix").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsSix").checked = false;
                    }

                    var ForThisSetting = cells[8];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsSeven").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsSeven").checked = false;
                    }

                    var ForThisSetting = cells[9];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    if (SettingNow == "true") {
                        document.getElementById("KPIAgentSettingsEight").checked = true;
                    } else {
                        document.getElementById("KPIAgentSettingsEight").checked = false;
                    }

                    var ForThisSetting = cells[10];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    document.getElementById("UserNameToAccessShare").value = SettingNow;

                    var ForThisSetting = cells[11];
                    var RC = ForThisSetting.split(":")
                    var SettingNow = RC[1];
                    document.getElementById("PassToAccesShare").value = SettingNow;

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

}

function UpdateSelectedItemSetting() {


}

$("#CloseTaskLogModa").click(function(e) {

    document.getElementById("ShowLogForTaskMod").style.display = "none";
    document.getElementById("TaskRunningDataDiv").style.display = "block";


});

function DismissTaskFunction(FinalTaskName) {

    var ThisTaskN = FinalTaskName;
    var res = ThisTaskN.split("#");
    var TaskStatusNow = res[0];

    if (TaskStatusNow == "Running") {
        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Task is running. Are you sure you want to cancel the Task?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "REMOVETASKFROMLIST";
        document.getElementById("ForMultiStringID").innerHTML = FinalTaskName;

    } else {

        RemoveTaskFromListNow(FinalTaskName)

    }
}

function RemoveTaskFromListNow(TaskStringNow) {

    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
    var res = ThisLUserNow.split("@");
    var FinalUserNameNow = res[0];
    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/CallRemoveTaskFromListNow', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'TaskString': TaskStringNow,
            'ThisLUser': FinalUserNameNow,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {


            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });



    document.getElementById("RefAllTaskRunningListButton").click();


}

$("#RefTaskLogNowButtonB").click(function(e) {

    document.getElementById("RefAllTaskRunningListButton").click();

    var FinalTaskName = document.getElementById("ThisTaskLogToShowND").innerHTML;
    document.getElementById("ShowLogForTaskMod").style.display = "block";
    document.getElementById("TaskRunningDataDiv").style.display = "none";
    ShowLogForTaskRunningFunc(FinalTaskName)

});

function ShowLogForTaskRunningFunc(FinalTaskName) {
    //$STR = "TASKNAME,Running#Creating Master Image:$ImageTemplate,Tenant: $AppTenant | Logged In User: $ThisLUser | Run Time: $StartDateNow,"

    var ThisTaskN = FinalTaskName;
    var res = ThisTaskN.split(":");
    var WhatTaskItIs = res[0];
    var WhatObjectItIs = res[1];

    document.getElementById("ThisTaskLogToShowND").innerHTML = FinalTaskName;

    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
    var res = ThisLUserNow.split("@");
    var FinalUserNameNow = res[0];

    var datatable = document.createElement("table");
    datatable.id = 'ShowingLogTaskTable'
    datatable.setAttribute('class', 'NotificationAndAlertsTable');

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/GetSelectedTaskLogNow', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisUser': FinalUserNameNow,
            'ThisTaskName': WhatTaskItIs,
            'ThisTaskObject': WhatObjectItIs,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                if (data.message == "NoLogToShow") {

                    document.getElementById("ShowLogForTaskMod").style.display = "none";
                    document.getElementById("TaskRunningDataDiv").style.display = "block";

                    var ThisMsg = "No Log To Show or Task does not have logs associated..."
                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                    document.getElementById("GettingReadyID").style.display = "none";
                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 2000);

                    function FunctionFooterDIV() {
                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                        clearInterval(MyTimerFooter);
                    }

                } else {

                    document.getElementById("ShowLogForTaskMod").style.display = "block";
                    document.getElementById("TaskRunningDataDiv").style.display = "none";

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        var CheckFRow = cells[0];

                        if (CheckFRow == "" || CheckFRow == null) {} else {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[0];
                            cell.style.background = "white";
                            cell.style.width = "140px";

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];
                            cell.style.background = "white";
                        }
                    }

                    var dtable = document.getElementById("SelectTaskLogDataDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                }
            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });


}

function FunctionEnableDisableMonTimer(DoWhatWithMonTimer) {

    var MyTimerForHostMonitoring = setInterval(function() { FunctionGetAllMonitoringDataNow() }, 300000);

    if (DoWhatWithMonTimer == "EnableNow") {

        document.getElementById("MonInProgCircle").style.display = "block";

        function FunctionGetAllMonitoringDataNow() {

            document.getElementById("MonSelSelTen").click();

        }

    }

    if (DoWhatWithMonTimer == "DisableNow") {

        clearInterval(MyTimerForHostMonitoring);
        document.getElementById("MonInProgCircle").style.display = "none";

    }

}

$("#CloseFeedbackFormNow").click(function(e) {

    document.getElementById("FeedbackModDiv").style.display = "none";

});

$("#FeedbackUsNowButton").click(function(e) {

    document.getElementById("FeedbackModDiv").style.display = "block";

});

$("#LoginCancelNow").click(function(e) {

    document.getElementById("LoginRegisterModal").style.display = "none";

});

$("#SessACTUpdateAccType").click(function(e) {

    var ThisMsg = "Task is not available in this Version!"
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#CloseSendMSGMod").click(function(e) {

    document.getElementById("SendMSGToUsersBoxMod").style.display = "none";

});

$("#CloseShadowNMod").click(function(e) {

    document.getElementById("ShadowSessModN").style.display = "none";

});

$("#SessACTExportUList").click(function(e) {

    var DemoOrNot = document.getElementById("DOrNot").innerHTML;
    if (DemoOrNot == "DEMO") {
        var ThisMsg = "Task is not available in Demo Mode!"
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Export Sessions for selected Tenant?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "EXPORTSESSIONS";

    }
});

$("#AddHostsForaPool").click(function(e) {

    if (document.getElementById("AddHostsForaPool").checked == true) {
        document.getElementById("ApplyNamingConventionONE").style.display = "none";
        document.getElementById("ApplyNamingConventionTWO").style.display = "none";
    } else {
        document.getElementById("ApplyNamingConventionONE").style.display = "block";
        document.getElementById("ApplyNamingConventionTWO").style.display = "block";
        document.getElementById("TempApplyNamingOrNot").checked = false;
    }

});

$("#RefAllDashItemsNSDDSS").click(function(e) {

    document.getElementById("DASHSwitchToSelTen").click();

});

function AddFileServerGetAllHostPools() {
    document.getElementById("RefAllHostPoolsForFileServerAdding").click();
}

$("#LaunchQuickProfActionN").click(function(e) {

    var DemoOrNot = document.getElementById("DOrNot").innerHTML;
    if (DemoOrNot == "DEMO") {
        var ThisMsg = "Task is not available in Demo Mode!"
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Are you sure you want to close all Profile Handles? Closing all profile handles will result in data loss."
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "CLOSEALLHANDLESACTION";

    }


});


function ShowUsersForGroupFunction(ThisIDNow) {

    document.getElementById("ThisGroupNameNowtoShowUsers").innerHTML = ThisIDNow;
    document.getElementById("ShowUsersFromSelGroup").style.display = "block";

    document.getElementById("CollingUsersFromGroupCircle").style.display = "block";

    var FinalGroupNow = ThisIDNow;

    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
    var res = ThisLUserNow.split("@");
    var FinalUserNameNow = res[0];

    var TRPKey = document.getElementById("TRPKeyN").value;
    var ThisTen = document.getElementById("ManageAssTenListNV").value;

    $.ajax({
        url: '/CallShowUsersFromGroup', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: true,
        timeout: 50000,
        data: {
            'ThisGroup': FinalGroupNow,
            'ThisLUser': FinalUserNameNow,
            'TRPKey': TRPKey,
            'ThisTen': ThisTen
        },
        success: function(data) {
            if (data.message) {

                document.getElementById("WhatToGetFromServer").innerHTML = "COLLECTUSERSFROMGROUP";

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            document.getElementById("SuperNovaStatusID").style.color = "red";
        }
    });





}

$("#CloseShowUsersFromGroupMod").click(function(e) {

    document.getElementById("ShowUsersFromSelGroup").style.display = "none";

});


$("#CheckAssVDIStatus").click(function(e) {

    var ThisMsg = "Checking VDI Status for Assignments is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#CreateNewSPN").click(function(e) {

    var ThisMsg = "Create SPN is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#SessShadowNowOtherButton").click(function(e) {

    alert("If you would like to shadow without copying command please use Wintellisys AVD Manager for Desktop.")

});

$("#AddSelAndEntAssToList").click(function(e) {

    var asstype = document.getElementById("ADDNewUsersAssignmentType").value;
    var AssAppGroupName = document.getElementById("AddAsAppGroupName").value;
    var AssResGroupName = document.getElementById("AssAddResGroupName").value;
    var assvalue = document.getElementById("AddAssignmentToListND").value;

    var FinalItem = assvalue + ":" + asstype + ":" + AssAppGroupName + ":" + AssResGroupName;

    var table = document.getElementById("AllAsignmendTobeAddedTable");
    var row = table.insertRow(-1);
    var cell1 = row.insertCell(0);
    cell1.innerHTML = FinalItem;

    var tableRT = document.getElementById('AllAsignmendTobeAddedTable');
    var cells = tableRT.getElementsByTagName('td');
    for (var i = 0; i < cells.length; i++) {
        // Take each cell
        var cell = cells[i];
        // do something on onclick event for cell
        cell.onclick = function() {
            // Get the row id where the cell exists

            var rowId = this.parentNode.rowIndex;
            var rowsNotSelected = tableRT.getElementsByTagName('tr');
            for (var row = 0; row < rowsNotSelected.length; row++) {
                rowsNotSelected[row].style.color = "#666666";
                rowsNotSelected[row].style.background = "white";
                rowsNotSelected[row].classList.remove('selected');
            }
            var rowSelected = tableRT.getElementsByTagName('tr')[rowId];
            rowSelected.style.color = "black";
            rowSelected.style.background = "#B1EDFF";
            rowSelected.className += "selected";
            var ImageID = rowSelected.cells[0].innerHTML;
            document.getElementById("SelectedImageIDforTenN").innerHTML = ImageID;
        }
    }


});


$("#CloseSingleHostRemoveMod").click(function(e) {

    document.getElementById("RemoveSingleHostMod").style.display = "none";

});

$("#LastRefAllAssignmentsNDR").click(function(e) {

    document.getElementById("ManAssSwitchToSelTenNN").click();

});

$("#ProcessAssignmentTempButtonN").click(function(e) {

    document.getElementById("ProcessAssignmentTempModN").style.display = "block";

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                var xLeft = document.getElementById("AllAssignmentTemlatetoDD");
                var options = document.querySelectorAll('#AllAssignmentTemlatetoDD option');
                options.forEach(o => o.remove());

                let res = data.message.replaceAll('"', "");

                var rows = res.split("\n");
                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");
                    if (cells.length > 1) {

                        var newcell = cells[0];
                        var rUName = cells[0];
                        var CheckTType = cells[3];

                        if (rUName == 'TemplateName') {} else {
                            if (rUName == "" || rUName == null) {} else {
                                if (CheckTType == "AssignmentTemplate") {
                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeft.add(optionR);
                                }
                            }
                        }
                    }
                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });


});

$("#RefAllAssTempAttrInWindow").click(function(e) {

    var FinalSelTempNow = document.getElementById("AllAssignmentTemlatetoDD").value;

    var TRPKey = document.getElementById("TRPKeyN").value;

    e.preventDefault();
    $.ajax({
        url: '/LoadTempDetails', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'SelTempNow': FinalSelTempNow,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                var datatable = document.createElement("table");
                datatable.id = 'AsignmentTemplateTableND'
                datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

                let res = data.message.replaceAll('"', "");
                var rows = res.split("\n");

                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");

                    var CheckFRow = cells[0];
                    var CheckSRow = cells[1];

                    if (CheckFRow == "TENIMAGES" || CheckFRow == "LOCATIONS") {

                    } else {

                        var row = datatable.insertRow(-1);
                        if (CheckFRow == "Parameter" || CheckFRow == "Assignment Name") {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[0];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";


                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[1];
                            cell.style.backgroundColor = "white";
                            cell.style.color = "#066d95";
                            cell.style.textAlign = "left";
                            cell.style.letterSpacing = "0px";
                            cell.style.fontWeight = "600";
                            cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                            cell.style.position = "sticky";
                            cell.style.zIndex = "22";
                            cell.style.top = "0px";
                            cell.style.fontSize = "12px";
                            cell.style.fontFamily = "Calibri";


                        } else {

                            if (CheckFRow == "" || CheckFRow == null) {

                            } else {


                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[0];
                                cell.style.background = "#f7f7f7";
                                cell.style.fontWeight = "500";

                                var cell = row.insertCell(-1);
                                cell.innerHTML = cells[1];
                                cell.style.background = "white";
                                cell.contentEditable = "true";
                                cell.spellcheck = "false";

                            }

                        }

                    }
                }

                var dtable = document.getElementById("SelectedAssTemplateAttrBelowDIV");
                dtable.innerHTML = "";
                dtable.appendChild(datatable);


            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

});

$("#CloseAssignmentProcModN").click(function(e) {

    document.getElementById("ProcessAssignmentTempModN").style.display = "none";

});

$("#ProcessAssignmentFromTempButtonRD").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Process Assignment Template? Assignments managed in the Template will be added."
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "PROCESSASSTEMPLATENOW";

});

$("#CloseEditImageModN").click(function(e) {

    document.getElementById("CreateAVMFromImageMod").style.display = "none";

});

$("#RefAllLogeInTensNow").click(function(e) {

    document.getElementById("RefAllAVDTenNow").click();

});

function DiskImageSelOrNotFunction() {
    if (document.getElementById("AVDSessVMImageOptN").value == "Create an Image Template") {
        document.getElementById("TenImageListDispOrNot").style.display = "none";
        document.getElementById("TenImageListDispOrNotTWO").style.display = "none";
    }
    if (document.getElementById("AVDSessVMImageOptN").value == "Use Existing Image URI") {
        document.getElementById("TenImageListDispOrNot").style.display = "block";
        document.getElementById("TenImageListDispOrNotTWO").style.display = "block";
    }


}

$("#RegisterNewUserFromRbacPane").click(function(e) {

    document.getElementById("RegisterToSuperNovaModal").style.display = "block";

});

$("#EditImageCreateVMFromImage").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "The process will create an VM from selected Image. You are required to RDP into VM using Admin username and password."
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "CREATEVMFROMIMAGE";

});

$("#GenPCIReportForRiskAndComp").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});


$("#ExportRiskAndCompItems").click(function(e) {

    var DemoOrNot = document.getElementById("DOrNot").innerHTML;
    if (DemoOrNot == "DEMO") {
        var ThisMsg = "Task is not available in Demo Mode!"
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Export Risk and Compliance Issues?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "EXPORTPCIITEMS";

    }
});

function EditImageFunction(ThisImage) {

    //var IDToAppend = cells[2] + ":" + cells[3] + ":" + cells[5]+ ":" + cells[4];

    var res = ThisImage.split(":");
    var ImageName = res[0];
    var ImageLocation = res[1];
    var ImageID = res[2];
    var ImageRSGroup = res[3];

    document.getElementById("CreateAVMFromImageMod").style.display = "block";

    document.getElementById("EditImageImageToEditName").innerHTML = ImageName;
    document.getElementById("EditImageVMResGroup").value = ImageRSGroup;
    document.getElementById("EditImageVMLocation").value = ImageLocation;
    document.getElementById("EditImageImageURIID").value = ImageID;

}

$("#MENUSwitchToScalingMon").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#HostActionSendMSGToUsers").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#HostActionShowResDetails").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});


$("#HostActionMemUsagePerApp").click(function(e) {

    var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;
    var res = ThisHostNow.split(":");
    var ActualHostNow = res[0];

    document.getElementById("ServerMonActionDetailsMod").style.display = "block";
    document.getElementById("WhichHostSelectedActionMonT").innerHTML = "Session Host: " + ActualHostNow
    document.getElementById("WhichActionSelectedID").innerHTML = "Resources Usage Per App";

    GetServerActionFileNow()

});

$("#HostActionSearchUserProfile").click(function(e) {

    var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;
    var res = ThisHostNow.split(":");
    var ActualHostNow = res[0];

    document.getElementById("ServerMonActionDetailsMod").style.display = "block";
    document.getElementById("WhichHostSelectedActionMonT").innerHTML = "Session Host: " + ActualHostNow
    document.getElementById("WhichActionSelectedID").innerHTML = "Show User Profiles";

    GetServerActionFileNow()

});

$("#HostActionShowFSLogixConfig").click(function(e) {

    var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;
    var res = ThisHostNow.split(":");
    var ActualHostNow = res[0];

    document.getElementById("ServerMonActionDetailsMod").style.display = "block";
    document.getElementById("WhichHostSelectedActionMonT").innerHTML = "Session Host: " + ActualHostNow
    document.getElementById("WhichActionSelectedID").innerHTML = "Show FSLogix Config";

    GetServerActionFileNow()

});

$("#HostActionExecuteAScript").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#HostActionDeploySingleApp").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#HostActionPatchHostSingle").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#HostActionPatchHostSingle").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#MENUSwitchToCapacityAna").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#RefAVDDeplMonStqatusND").click(function(e) {

    CheckAVDDeployingStatusForAll()

});


$("#MENUSwitchToSuperNovaReporter").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#ProfileRefProfileDashboard").click(function(e) {

    var ThisMsg = "This feature is not production ready yet...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";
    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }

});

$("#InfoExportAVD").click(function(e) {

    var DemoOrNot = document.getElementById("DOrNot").innerHTML;
    if (DemoOrNot == "DEMO") {
        var ThisMsg = "Task is not available in Demo Mode!"
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Export AVD Info?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "EXPORTAVDINFO";

    }
});

function CollectRBACPoliciesFunction() {

    // Enable all Buttons here first

    document.getElementById("AVDOpenRegOptPane").enabled = true;
    document.getElementById("AVDOpenRegOptPane").style.textDecoration = "none";
    document.getElementById("ShowProtectedLogsNow").enabled = true;
    document.getElementById("ShowProtectedLogsNow").style.textDecoration = "none";
    document.getElementById("TestAppAuthID").enabled = true;
    document.getElementById("TestAppAuthID").style.textDecoration = "none";
    document.getElementById("FeedbackUsNowButton").enabled = true;
    document.getElementById("FeedbackUsNowButton").style.textDecoration = "none";
    document.getElementById("MENUSwitchToMultiTenDashboard").enabled = true;
    document.getElementById("MENUSwitchToMultiTenDashboard").style.textDecoration = "none";
    document.getElementById("MENUSwitchToHostsHealth").enabled = true;
    document.getElementById("MENUSwitchToHostsHealth").style.textDecoration = "none";
    document.getElementById("MENUSwitchTo24HoursStatus").enabled = true;
    document.getElementById("MENUSwitchTo24HoursStatus").style.textDecoration = "none";
    document.getElementById("MENUSwitchToHostsMonitor").enabled = true;
    document.getElementById("MENUSwitchToHostsMonitor").style.textDecoration = "none";
    document.getElementById("MENUSwitchToProfilesStatus").enabled = true;
    document.getElementById("MENUSwitchToProfilesStatus").style.textDecoration = "none";
    document.getElementById("MENUSwitchToAVDComp").enabled = true;
    document.getElementById("MENUSwitchToAVDComp").style.textDecoration = "none";
    document.getElementById("InfoSwitchToHostPools").enabled = true;
    document.getElementById("InfoSwitchToHostPools").style.textDecoration = "none";
    document.getElementById("InfoSwitchToStartMenu").enabled = true;
    document.getElementById("InfoSwitchToStartMenu").style.textDecoration = "none";
    document.getElementById("InfoSwitchToAppGroups").enabled = true;
    document.getElementById("InfoSwitchToAppGroups").style.textDecoration = "none";
    document.getElementById("InfoSwitchToWorkInfo").enabled = true;
    document.getElementById("InfoSwitchToWorkInfo").style.textDecoration = "none";
    document.getElementById("InfoSwitchToSessHostInfo").enabled = true;
    document.getElementById("InfoSwitchToSessHostInfo").style.textDecoration = "none";
    document.getElementById("InfoSwitchToHeartbeat").enabled = true;
    document.getElementById("InfoSwitchToHeartbeat").style.textDecoration = "none";
    document.getElementById("MENUSwitchToRBACManager").enabled = true;
    document.getElementById("MENUSwitchToRBACManager").style.textDecoration = "none";
    document.getElementById("MENUSwitchToPolManager").enabled = true;
    document.getElementById("MENUSwitchToPolManager").style.textDecoration = "none";
    document.getElementById("MENUSwitchToNotCenter").enabled = true;
    document.getElementById("MENUSwitchToNotCenter").style.textDecoration = "none";
    document.getElementById("MENUSwitchToImageManager").enabled = true;
    document.getElementById("MENUSwitchToImageManager").style.textDecoration = "none";
    document.getElementById("MENUSwitchToTempManager").enabled = true;
    document.getElementById("MENUSwitchToTempManager").style.textDecoration = "none";
    document.getElementById("MENUSwitchToSessManager").enabled = true;
    document.getElementById("MENUSwitchToSessManager").style.textDecoration = "none";
    document.getElementById("MENUSwitchToProfManager").enabled = true;
    document.getElementById("MENUSwitchToProfManager").style.textDecoration = "none";
    document.getElementById("MENUSwitchToAssManager").enabled = true;
    document.getElementById("MENUSwitchToAssManager").style.textDecoration = "none";
    document.getElementById("MENUSwitchToDepFSLogixCOnfig").enabled = true;
    document.getElementById("MENUSwitchToDepFSLogixCOnfig").style.textDecoration = "none";
    document.getElementById("MENUSwitchToDepApps").enabled = true;
    document.getElementById("MENUSwitchToDepApps").style.textDecoration = "none";
    document.getElementById("MENUSwitchToAVDDeploy").enabled = true;
    document.getElementById("MENUSwitchToAVDDeploy").style.textDecoration = "none";
    document.getElementById("MENUSwitchToScriptExecution").enabled = true;
    document.getElementById("MENUSwitchToScriptExecution").style.textDecoration = "none";
    document.getElementById("MENUSwitchToCostAnalyzer").enabled = true;
    document.getElementById("MENUSwitchToCostAnalyzer").style.textDecoration = "none";
    document.getElementById("MENUSwitchToCapacityAna").enabled = true;
    document.getElementById("MENUSwitchToCapacityAna").style.textDecoration = "none";
    document.getElementById("MENUSwitchToAVDOptionsPane").enabled = true;
    document.getElementById("MENUSwitchToAVDOptionsPane").style.textDecoration = "none";
    document.getElementById("MENUSwitchToTenConfig").enabled = true;
    document.getElementById("MENUSwitchToTenConfig").style.textDecoration = "none";
    document.getElementById("MENUSwitchToActivePol").enabled = true;
    document.getElementById("MENUSwitchToActivePol").style.textDecoration = "none";
    document.getElementById("MENUSwitchToCostAnaLog").enabled = true;
    document.getElementById("MENUSwitchToCostAnaLog").style.textDecoration = "none";
    document.getElementById("MENUSwitchToOptRBACLog").enabled = true;
    document.getElementById("MENUSwitchToOptRBACLog").style.textDecoration = "none";
    document.getElementById("MENUSwitchToNotifyLog").enabled = true;
    document.getElementById("MENUSwitchToNotifyLog").style.textDecoration = "none";
    document.getElementById("TurnOnAllVMsButtonN").enabled = true;
    document.getElementById("TurnOnAllVMsButtonN").style.textDecoration = "none";
    document.getElementById("TurnOffAllVMsButtonN").enabled = true;
    document.getElementById("TurnOffAllVMsButtonN").style.textDecoration = "none";
    document.getElementById("TurnOffSelectedHostsInGrid").enabled = true;
    document.getElementById("TurnOffSelectedHostsInGrid").style.textDecoration = "none";
    document.getElementById("TurnOnSelectedHostsInGridNow").enabled = true;
    document.getElementById("TurnOnSelectedHostsInGridNow").style.textDecoration = "none";
    document.getElementById("RemoveSelectedHostsInGrid").enabled = true;
    document.getElementById("RemoveSelectedHostsInGrid").style.textDecoration = "none";
    document.getElementById("SessACTLogoffDisconnected").enabled = true;
    document.getElementById("SessACTLogoffDisconnected").style.textDecoration = "none";
    document.getElementById("SessACTRemoveDisconnected").enabled = true;
    document.getElementById("SessACTRemoveDisconnected").style.textDecoration = "none";
    document.getElementById("SessACTRemoveStaleSess").enabled = true;
    document.getElementById("SessACTRemoveStaleSess").style.textDecoration = "none";
    document.getElementById("SessACTLunhcQuickACT").enabled = true;
    document.getElementById("SessACTLunhcQuickACT").style.textDecoration = "none";
    document.getElementById("SessACTExportUList").enabled = true;
    document.getElementById("SessACTExportUList").style.textDecoration = "none";
    document.getElementById("HostActionShowUsersCon").enabled = true;
    document.getElementById("HostActionShowUsersCon").style.textDecoration = "none";
    document.getElementById("HostActionMemUsagePerUSer").enabled = true;
    document.getElementById("HostActionMemUsagePerUSer").style.textDecoration = "none";
    document.getElementById("HostActionMemUsagePerApp").enabled = true;
    document.getElementById("HostActionMemUsagePerApp").style.textDecoration = "none";
    document.getElementById("HostActionMonitorHostNow").enabled = true;
    document.getElementById("HostActionMonitorHostNow").style.textDecoration = "none";
    document.getElementById("HostActionShowFSLogixConfig").enabled = true;
    document.getElementById("HostActionShowFSLogixConfig").style.textDecoration = "none";
    document.getElementById("HostActionSearchUserProfile").enabled = true;
    document.getElementById("HostActionSearchUserProfile").style.textDecoration = "none";
    document.getElementById("HostActionShowFSLogixConfig").enabled = true;
    document.getElementById("HostActionShowFSLogixConfig").style.textDecoration = "none";
    document.getElementById("PushKPIAgentOnHostID").enabled = true;
    document.getElementById("PushKPIAgentOnHostID").style.textDecoration = "none";

    document.getElementById("PleaseWaitWhatAtLogin").innerHTML = "Applying Policies..."

    var RUserNow = document.getElementById("FirstLoginEmail").value;
    var res = RUserNow.split("@");
    var RBACUserNow = res[0];

    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
    var res = ThisLUserNow.split("@");
    var FinalUserNameNow = res[0];

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/LoadRBACUserTasks', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'SelRBACUser': RBACUserNow,
            'ThisLUser': FinalUserNameNow,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                let res = data.message.replaceAll('"', "");
                var rows = res.split("\n");

                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");

                    var CheckFRow = cells[1];
                    var CheckSRow = cells[1];
                    var CheckWhatRow = cells[0];

                    if (CheckWhatRow == "RBACTASKS") {

                        var ThisRBACUser = cells[1];
                        var ThisRBACTenant = cells[2];
                        var ThisRBACTask = cells[3];
                        var ThisTaskAvaOrNot = cells[4];
                        var ThisTaskType = cells[5];

                        localStorage.setItem(ThisRBACTask, ThisTaskAvaOrNot);

                        if (ThisRBACTask == "Option:CloudNovaDesk:Register App") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("AVDOpenRegOptPane").disabled = true;
                                document.getElementById("AVDOpenRegOptPane").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("AVDOpenRegOptPane").enabled = true;
                                document.getElementById("AVDOpenRegOptPane").style.textDecoration = "none";
                            }

                        }
                        if (ThisRBACTask == "Option:CloudNovaDesk:See Protected Logs") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("ShowProtectedLogsNow").disabled = true;
                                document.getElementById("ShowProtectedLogsNow").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("ShowProtectedLogsNow").enabled = true;
                                document.getElementById("ShowProtectedLogsNow").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:CloudNovaDesk:Test Authentication") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("TestAppAuthID").disabled = true;
                                document.getElementById("TestAppAuthID").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("TestAppAuthID").enabled = true;
                                document.getElementById("TestAppAuthID").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:CloudNovaDesk:Feature Request") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("FeedbackUsNowButton").disabled = true;
                                document.getElementById("FeedbackUsNowButton").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("FeedbackUsNowButton").enabled = true;
                                document.getElementById("FeedbackUsNowButton").style.textDecoration = "none";
                            }
                        }

                        if (ThisRBACTask == "Option:AVD Dashboard-Tenant Dashboard") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToMultiTenDashboard").disabled = true;
                                document.getElementById("MENUSwitchToMultiTenDashboard").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToMultiTenDashboard").enabled = true;
                                document.getElementById("MENUSwitchToMultiTenDashboard").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Dashboard-Hosts Health") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToHostsHealth").disabled = true;
                                document.getElementById("MENUSwitchToHostsHealth").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToHostsHealth").enabled = true;
                                document.getElementById("MENUSwitchToHostsHealth").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Dashboard-24 Hours Status") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchTo24HoursStatus").disabled = true;
                                document.getElementById("MENUSwitchTo24HoursStatus").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchTo24HoursStatus").enabled = true;
                                document.getElementById("MENUSwitchTo24HoursStatus").style.textDecoration = "none";
                            }

                        }
                        if (ThisRBACTask == "Option:AVD Dashboard-Monitor & Actions") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToHostsMonitor").disabled = true;
                                document.getElementById("MENUSwitchToHostsMonitor").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToHostsMonitor").enabled = true;
                                document.getElementById("MENUSwitchToHostsMonitor").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Dashboard-Profile Servers") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToProfilesStatus").disabled = true;
                                document.getElementById("MENUSwitchToProfilesStatus").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToProfilesStatus").enabled = true;
                                document.getElementById("MENUSwitchToProfilesStatus").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Dashboard-AVD Compliance") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToAVDComp").disabled = true;
                                document.getElementById("MENUSwitchToAVDComp").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToAVDComp").enabled = true;
                                document.getElementById("MENUSwitchToAVDComp").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Info & Status-AVD Host Pools") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("InfoSwitchToHostPools").disabled = true;
                                document.getElementById("InfoSwitchToHostPools").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("InfoSwitchToHostPools").enabled = true;
                                document.getElementById("InfoSwitchToHostPools").style.textDecoration = "none";
                            }

                        }
                        if (ThisRBACTask == "Option:AVD Info & Status-AVD Start Menu Apps") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("InfoSwitchToStartMenu").disabled = true;
                                document.getElementById("InfoSwitchToStartMenu").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("InfoSwitchToStartMenu").enabled = true;
                                document.getElementById("InfoSwitchToStartMenu").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Info & Status-AVD Application Groups") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("InfoSwitchToAppGroups").disabled = true;
                                document.getElementById("InfoSwitchToAppGroups").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("InfoSwitchToAppGroups").enabled = true;
                                document.getElementById("InfoSwitchToAppGroups").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Info & Status-AVD Workspace Info") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("InfoSwitchToWorkInfo").disabled = true;
                                document.getElementById("InfoSwitchToWorkInfo").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("InfoSwitchToWorkInfo").enabled = true;
                                document.getElementById("InfoSwitchToWorkInfo").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Info & Status-AVD Session Hosts Info") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("InfoSwitchToSessHostInfo").disabled = true;
                                document.getElementById("InfoSwitchToSessHostInfo").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("InfoSwitchToSessHostInfo").enabled = true;
                                document.getElementById("InfoSwitchToSessHostInfo").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Info & Status-AVD Session Hosts Heartbeat and Update Status") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("InfoSwitchToHeartbeat").disabled = true;
                                document.getElementById("InfoSwitchToHeartbeat").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("InfoSwitchToHeartbeat").enabled = true;
                                document.getElementById("InfoSwitchToHeartbeat").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Managers-RBAC Manager") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToRBACManager").disabled = true;
                                document.getElementById("MENUSwitchToRBACManager").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToRBACManager").enabled = true;
                                document.getElementById("MENUSwitchToRBACManager").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Managers-Policy Manager") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToPolManager").disabled = true;
                                document.getElementById("MENUSwitchToPolManager").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToPolManager").enabled = true;
                                document.getElementById("MENUSwitchToPolManager").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Managers-Notification Center") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToNotCenter").disabled = true;
                                document.getElementById("MENUSwitchToNotCenter").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToNotCenter").enabled = true;
                                document.getElementById("MENUSwitchToNotCenter").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Managers-Image Manager") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToImageManager").disabled = true;
                                document.getElementById("MENUSwitchToImageManager").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToImageManager").enabled = true;
                                document.getElementById("MENUSwitchToImageManager").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Managers-Templates Manager") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToTempManager").disabled = true;
                                document.getElementById("MENUSwitchToTempManager").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToTempManager").enabled = true;
                                document.getElementById("MENUSwitchToTempManager").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Management-Sessions Manager") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToSessManager").disabled = true;
                                document.getElementById("MENUSwitchToSessManager").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToSessManager").enabled = true;
                                document.getElementById("MENUSwitchToSessManager").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Management-Profiles Manager") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToProfManager").disabled = true;
                                document.getElementById("MENUSwitchToProfManager").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToProfManager").enabled = true;
                                document.getElementById("MENUSwitchToProfManager").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Management-Manage Assignments") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToAssManager").disabled = true;
                                document.getElementById("MENUSwitchToAssManager").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToAssManager").enabled = true;
                                document.getElementById("MENUSwitchToAssManager").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Deploy-FSLogix Config") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToDepFSLogixCOnfig").disabled = true;
                                document.getElementById("MENUSwitchToDepFSLogixCOnfig").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToDepFSLogixCOnfig").enabled = true;
                                document.getElementById("MENUSwitchToDepFSLogixCOnfig").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Deploy-Deploy Application") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToDepApps").disabled = true;
                                document.getElementById("MENUSwitchToDepApps").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToDepApps").enabled = true;
                                document.getElementById("MENUSwitchToDepApps").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Deploy-AVD Deploy") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("MENUSwitchToAVDDeploy").disabled = true;
                                document.getElementById("MENUSwitchToAVDDeploy").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToAVDDeploy").enabled = true;
                                document.getElementById("MENUSwitchToAVDDeploy").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:AVD Deploy-Execute Script") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToScriptExecution").disabled = true;
                                document.getElementById("MENUSwitchToScriptExecution").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToScriptExecution").enabled = true;
                                document.getElementById("MENUSwitchToScriptExecution").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Analyzers-Cost Analyzer") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToCostAnalyzer").disabled = true;
                                document.getElementById("MENUSwitchToCostAnalyzer").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToCostAnalyzer").enabled = true;
                                document.getElementById("MENUSwitchToCostAnalyzer").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Analyzers-Hosts Capacity Analyzer") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToCapacityAna").disabled = true;
                                document.getElementById("MENUSwitchToCapacityAna").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToCapacityAna").enabled = true;
                                document.getElementById("MENUSwitchToCapacityAna").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Settings-Management Options") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToAVDOptionsPane").disabled = true;
                                document.getElementById("MENUSwitchToAVDOptionsPane").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToAVDOptionsPane").enabled = true;
                                document.getElementById("MENUSwitchToAVDOptionsPane").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Settings-Tenant Configuration") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToTenConfig").disabled = true;
                                document.getElementById("MENUSwitchToTenConfig").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToTenConfig").enabled = true;
                                document.getElementById("MENUSwitchToTenConfig").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Settings-Active Policies") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToActivePol").disabled = true;
                                document.getElementById("MENUSwitchToActivePol").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToActivePol").enabled = true;
                                document.getElementById("MENUSwitchToActivePol").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Logs-Cost Analyzer Logs") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToCostAnaLog").disabled = true;
                                document.getElementById("MENUSwitchToCostAnaLog").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToCostAnaLog").enabled = true;
                                document.getElementById("MENUSwitchToCostAnaLog").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Logs-Operational Logs") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToOptRBACLog").disabled = true;
                                document.getElementById("MENUSwitchToOptRBACLog").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToOptRBACLog").enabled = true;
                                document.getElementById("MENUSwitchToOptRBACLog").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Option:Logs-Notification Logs") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                document.getElementById("MENUSwitchToNotifyLog").disabled = true;
                                document.getElementById("MENUSwitchToNotifyLog").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("MENUSwitchToNotifyLog").enabled = true;
                                document.getElementById("MENUSwitchToNotifyLog").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn On All Pools") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("TurnOnAllVMsButtonN").disabled = true;
                                document.getElementById("TurnOnAllVMsButtonN").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("TurnOnAllVMsButtonN").enabled = true;
                                document.getElementById("TurnOnAllVMsButtonN").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn Off All Pools") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("TurnOffAllVMsButtonN").disabled = true;
                                document.getElementById("TurnOffAllVMsButtonN").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("TurnOffAllVMsButtonN").enabled = true;
                                document.getElementById("TurnOffAllVMsButtonN").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn Off Selected Hosts") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("TurnOffSelectedHostsInGrid").disabled = true;
                                document.getElementById("TurnOffSelectedHostsInGrid").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("TurnOffSelectedHostsInGrid").enabled = true;
                                document.getElementById("TurnOffSelectedHostsInGrid").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn On Selected Hosts") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("TurnOnSelectedHostsInGridNow").disabled = true;
                                document.getElementById("TurnOnSelectedHostsInGridNow").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("TurnOnSelectedHostsInGridNow").enabled = true;
                                document.getElementById("TurnOnSelectedHostsInGridNow").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Remove Selected Hosts") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("RemoveSelectedHostsInGrid").disabled = true;
                                document.getElementById("RemoveSelectedHostsInGrid").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("RemoveSelectedHostsInGrid").enabled = true;
                                document.getElementById("RemoveSelectedHostsInGrid").style.textDecoration = "none";
                            }
                        }

                        if (ThisRBACTask == "Granular-Option:Hosts Health:Remove All Session Hosts In Host Pool") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("RemoveHostsInPool", "No");

                            } else {

                                localStorage.setItem("RemoveHostsInPool", "Yes");
                            }
                        }

                        if (ThisRBACTask == "Granular-Option:Hosts Health:Deploy Session Hosts In Host Pool") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("DeployHost", "No");

                            } else {

                                localStorage.setItem("DeployHost", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Can Repair Session Host") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("CanRepair", "No");

                            } else {

                                localStorage.setItem("CanRepair", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Can Set False - Put Session Host in Drain Mode") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("PutInDrainMode", "No");

                            } else {

                                localStorage.setItem("PutInDrainMode", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Can Set True - Remove Session Host from Drain Mode") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("RemoveFromDrainMode", "No");

                            } else {

                                localStorage.setItem("RemoveFromDrainMode", "Yes");
                            }
                        }

                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn On All Hosts In Host Pool") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("TurnOnAllInHostPool", "No");

                            } else {

                                localStorage.setItem("TurnOnAllInHostPool", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn Off All Hosts In Host Pool") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("TurnOffAllInHostPool", "No");

                            } else {

                                localStorage.setItem("TurnOffAllInHostPool", "Yes");
                            }
                        }

                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn On Individual Session Host") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("TurnOnSingleHost", "No");

                            } else {

                                localStorage.setItem("TurnOnSingleHost", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Turn Off Individual Session Host") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("TurnOffSingleHost", "No");

                            } else {

                                localStorage.setItem("TurnOffSingleHost", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Remove Individual Session Host") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("RemoveSingleHost", "No");

                            } else {

                                localStorage.setItem("RemoveSingleHost", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Restart Individual Session Host") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("RestartSingleHost", "No");

                            } else {

                                localStorage.setItem("RestartSingleHost", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Create Host Template") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("CreateHostTemplate", "No");

                            } else {

                                localStorage.setItem("CreateHostTemplate", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Hosts Health:Create Host Template") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("CreateHostTemplate", "No");

                            } else {

                                localStorage.setItem("CreateHostTemplate", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Logoff All Disconnected") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("LogOffAllDisconnected", "No");

                            } else {

                                localStorage.setItem("LogOffAllDisconnected", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Remove All Disconnected") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("RemoveAllDisconnected", "No");

                            } else {

                                localStorage.setItem("RemoveAllDisconnected", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Remove All Stale Sessions") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("RemoveAllStaleSessions", "No");

                            } else {

                                localStorage.setItem("RemoveAllStaleSessions", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Launch Quick Action") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("LaunchQuickAction", "No");

                            } else {

                                localStorage.setItem("LaunchQuickAction", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Remove Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("RemoveSingleSession", "No");

                            } else {

                                localStorage.setItem("RemoveSingleSession", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Logoff Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("LogoffSingleSession", "No");

                            } else {

                                localStorage.setItem("LogoffSingleSession", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Shadow Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("ShadowSingleSession", "No");

                            } else {

                                localStorage.setItem("ShadowSingleSession", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Message Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("MessageSingeSession", "No");

                            } else {

                                localStorage.setItem("MessageSingeSession", "Yes");
                            }
                        }

                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Logoff All Disconnected") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("SessACTLogoffDisconnected").disabled = true;
                                document.getElementById("SessACTLogoffDisconnected").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("SessACTLogoffDisconnected").enabled = true;
                                document.getElementById("SessACTLogoffDisconnected").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Remove All Disconnected") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("SessACTRemoveDisconnected").disabled = true;
                                document.getElementById("SessACTRemoveDisconnected").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("SessACTRemoveDisconnected").enabled = true;
                                document.getElementById("SessACTRemoveDisconnected").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Remove All Stale Sessions") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("SessACTRemoveStaleSess").disabled = true;
                                document.getElementById("SessACTRemoveStaleSess").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("SessACTRemoveStaleSess").enabled = true;
                                document.getElementById("SessACTRemoveStaleSess").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Launch Quick Action") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("SessACTLunhcQuickACT").disabled = true;
                                document.getElementById("SessACTLunhcQuickACT").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("SessACTLunhcQuickACT").enabled = true;
                                document.getElementById("SessACTLunhcQuickACT").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Export Sessions List") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("SessACTExportUList").disabled = true;
                                document.getElementById("SessACTExportUList").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("SessACTExportUList").enabled = true;
                                document.getElementById("SessACTExportUList").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Remove Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("SESSManRemoveSingleUser", "No");

                            } else {

                                localStorage.setItem("SESSManRemoveSingleUser", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Logoff Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("SESSManLogoffSingleUser", "No");

                            } else {

                                localStorage.setItem("SESSManLogoffSingleUser", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Shadow Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("SESSManShadowSingleUser", "No");

                            } else {

                                localStorage.setItem("SESSManShadowSingleUser", "Yes");
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Sessions Manager:Message Individual Session") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {

                                localStorage.setItem("SESSManMessageSingleUser", "No");

                            } else {

                                localStorage.setItem("SESSManMessageSingleUser", "Yes");
                            }
                        }


                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Show Users Connected") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("HostActionShowUsersCon").disabled = true;
                                document.getElementById("HostActionShowUsersCon").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("HostActionShowUsersCon").enabled = true;
                                document.getElementById("HostActionShowUsersCon").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Show Memory Usage Per User") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("HostActionMemUsagePerUSer").disabled = true;
                                document.getElementById("HostActionMemUsagePerUSer").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("HostActionMemUsagePerUSer").enabled = true;
                                document.getElementById("HostActionMemUsagePerUSer").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Show Resources Usage Per App") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("HostActionMemUsagePerApp").disabled = true;
                                document.getElementById("HostActionMemUsagePerApp").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("HostActionMemUsagePerApp").enabled = true;
                                document.getElementById("HostActionMemUsagePerApp").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Monitor Session Host") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("HostActionMonitorHostNow").disabled = true;
                                document.getElementById("HostActionMonitorHostNow").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("HostActionMonitorHostNow").enabled = true;
                                document.getElementById("HostActionMonitorHostNow").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Show FSLogix Config") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("HostActionShowFSLogixConfig").disabled = true;
                                document.getElementById("HostActionShowFSLogixConfig").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("HostActionShowFSLogixConfig").enabled = true;
                                document.getElementById("HostActionShowFSLogixConfig").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Show User Profiles") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("HostActionSearchUserProfile").disabled = true;
                                document.getElementById("HostActionSearchUserProfile").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("HostActionSearchUserProfile").enabled = true;
                                document.getElementById("HostActionSearchUserProfile").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Show FSLogix Config") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("HostActionShowFSLogixConfig").disabled = true;
                                document.getElementById("HostActionShowFSLogixConfig").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("HostActionShowFSLogixConfig").enabled = true;
                                document.getElementById("HostActionShowFSLogixConfig").style.textDecoration = "none";
                            }
                        }
                        if (ThisRBACTask == "Granular-Option:Monitor & Actions:Push KPI Agent") {
                            if (ThisTaskAvaOrNot == "Task Is Not Available") {
                                document.getElementById("PushKPIAgentOnHostID").disabled = true;
                                document.getElementById("PushKPIAgentOnHostID").style.textDecoration = "line-through";
                            } else {
                                document.getElementById("PushKPIAgentOnHostID").enabled = true;
                                document.getElementById("PushKPIAgentOnHostID").style.textDecoration = "none";
                            }
                        }



                    }

                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });


    document.getElementById("PleaseWaitWindow").style.display = "none";
}

$("#RefThoseSecItemsNow").click(function(e) {

    document.getElementById("SwitchToRiskAndCompList").click();

});

$("#RemoveSelRegFSLogixEntry").click(function(e) {


    var ThisToRemove = document.getElementById("SelectedImageIDforTenN").innerHTML;

    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("TemplateAttrTable");
    rows = table.rows;
    for (i = 1; i < (rows.length - 1); i++) {

        x = rows[i].getElementsByTagName("TD")[0].innerHTML;
        if (x == ThisToRemove) {
            rows[i].getElementsByTagName("TD")[0].remove()
            rows[i].getElementsByTagName("TD")[1].remove()
            rows[i].getElementsByTagName("TD")[2].remove()
            rows[i].getElementsByTagName("TD")[3].remove()
        }
    }



});

$("#NOTAndActionEnableAllNots").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Enable All Notifications?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "ENABLEALLNOTIFICATIONS";

});
$("#NotAndActionDisableAllNots").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Disable All Notifications?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "DISABLEALLNOTIFICATIONS";
});
$("#NotAllReportsEnable").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Enable All Reports?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "ENABLEALLREPORTS";
});
$("#NotAllReportsDisable").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Disable All Reports?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "DISABLEALLREPORTS";
});
$("#NotAndActionEnableAllActions").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Enable All Actions?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "ENABLEALLACTIONS";
});
$("#NotAndActionDisableAllActions").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Disable All Actions?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "DISABLEALLACTIONS";
});




$("#NotAndActionSaveSettingsN").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Save Notification Center Settings?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "SAVEALLNOTSETTINGS";
});

$("#NotAndActionSwitchTenN").click(function(e) {

    var ThisMsg = "Opening Notification Center Settings for Tenant..."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/LoadAllTemplates', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                var ReportEmailTemp1 = document.getElementById("AVDReportEmailTemplate1");
                var options = document.querySelectorAll('#AVDReportEmailTemplate1 option');
                options.forEach(o => o.remove());

                var ReportEmailTemp2 = document.getElementById("AVDReportEmailTemplate2");
                var options = document.querySelectorAll('#AVDReportEmailTemplate2 option');
                options.forEach(o => o.remove());

                var ReportEmailTemp3 = document.getElementById("AVDReportEmailTemplate3");
                var options = document.querySelectorAll('#AVDReportEmailTemplate3 option');
                options.forEach(o => o.remove());

                var ReportEmailTemp4 = document.getElementById("AVDReportEmailTemplate4");
                var options = document.querySelectorAll('#AVDReportEmailTemplate4 option');
                options.forEach(o => o.remove());

                var ReportEmailTemp5 = document.getElementById("AVDReportEmailTemplate5");
                var options = document.querySelectorAll('#AVDReportEmailTemplate1 option');
                options.forEach(o => o.remove());

                var ReportEmailTemp6 = document.getElementById("AVDReportEmailTemplate6");
                var options = document.querySelectorAll('#AVDReportEmailTemplate6 option');
                options.forEach(o => o.remove());

                var ReportEmailTemp7 = document.getElementById("AVDReportEmailTemplate7");
                var options = document.querySelectorAll('#AVDReportEmailTemplate7 option');
                options.forEach(o => o.remove());

                var ReportEmailTemp8 = document.getElementById("AVDReportEmailTemplate8");
                var options = document.querySelectorAll('#AVDReportEmailTemplate8 option');
                options.forEach(o => o.remove());

                var AssTemplateOne = document.getElementById("SelActionAssTemplateForTenS");
                var options = document.querySelectorAll('#SelActionAssTemplateForTenS option');
                options.forEach(o => o.remove());

                var xLeftEmailTemplateOne = document.getElementById("ActionEmailTemplate1");
                var options = document.querySelectorAll('#ActionEmailTemplate1 option');
                options.forEach(o => o.remove());

                var xLeftEmailTemplateTwo = document.getElementById("ActionEmailTemplate2");
                var options = document.querySelectorAll('#ActionEmailTemplate2 option');
                options.forEach(o => o.remove());

                var xLeftEmailTemplateThree = document.getElementById("ActionEmailTemplate3");
                var options = document.querySelectorAll('#ActionEmailTemplate3 option');
                options.forEach(o => o.remove());

                var xLeftEmailTemplateFour = document.getElementById("ActionEmailTemplate4");
                var options = document.querySelectorAll('#ActionEmailTemplate4 option');
                options.forEach(o => o.remove());

                var xLeftEmailTemplateFive = document.getElementById("ActionEmailTemplate5");
                var options = document.querySelectorAll('#ActionEmailTemplate5 option');
                options.forEach(o => o.remove());

                var xLeftEmailTemplateSix = document.getElementById("ActionEmailTemplate6");
                var options = document.querySelectorAll('#ActionEmailTemplate6 option');
                options.forEach(o => o.remove());

                var xLeftEmailTemplateSeven = document.getElementById("ActionEmailTemplate7");
                var options = document.querySelectorAll('#ActionEmailTemplate7 option');
                options.forEach(o => o.remove());

                var NotEmailTemp1 = document.getElementById("NOTNotificationEmailTemplate1");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate1 option');
                options.forEach(o => o.remove());

                var NotEmailTemp2 = document.getElementById("NOTNotificationEmailTemplate2");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate2 option');
                options.forEach(o => o.remove());

                var NotEmailTemp3 = document.getElementById("NOTNotificationEmailTemplate3");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate3 option');
                options.forEach(o => o.remove());

                var NotEmailTemp4 = document.getElementById("NOTNotificationEmailTemplate4");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate4 option');
                options.forEach(o => o.remove());

                var NotEmailTemp5 = document.getElementById("NOTNotificationEmailTemplate5");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate5 option');
                options.forEach(o => o.remove());

                var NotEmailTemp6 = document.getElementById("NOTNotificationEmailTemplate6");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate6 option');
                options.forEach(o => o.remove());

                var NotEmailTemp7 = document.getElementById("NOTNotificationEmailTemplate7");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate7 option');
                options.forEach(o => o.remove());

                var NotEmailTemp8 = document.getElementById("NOTNotificationEmailTemplate8");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate8 option');
                options.forEach(o => o.remove());

                var NotEmailTemp9 = document.getElementById("NOTNotificationEmailTemplate9");
                var options = document.querySelectorAll('#NOTNotificationEmailTemplate9 option');
                options.forEach(o => o.remove());

                let res = data.message.replaceAll('"', "");

                var rows = res.split("\n");
                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");
                    if (cells.length > 1) {

                        var newcell = cells[0];
                        var rUName = cells[0];
                        var CheckTType = cells[3];

                        if (rUName == 'TemplateName') {} else {
                            if (rUName == "" || rUName == null) {} else {

                                if (CheckTType == "SessionHostTemplate") {


                                }

                                if (CheckTType == "EmailTemplate") {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp1.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp2.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp3.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp4.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp5.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp6.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp7.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp8.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    NotEmailTemp9.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeftEmailTemplateOne.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeftEmailTemplateTwo.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeftEmailTemplateThree.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeftEmailTemplateFour.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeftEmailTemplateFive.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeftEmailTemplateSix.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    xLeftEmailTemplateSeven.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp1.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp2.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp3.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp4.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp5.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp6.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp7.add(optionR);

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    ReportEmailTemp8.add(optionR);

                                }

                                if (CheckTType == "AssignmentTemplate") {

                                    var optionR = document.createElement("option");
                                    optionR.text = newcell;
                                    AssTemplateOne.add(optionR);

                                }


                            }
                        }
                    }
                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

    var SelTenantNow = document.getElementById("NotAndActionTenList").value;
    document.getElementById("NotActForSelTenName").innerHTML = "Tenant: " + SelTenantNow;

    var TRPKey = document.getElementById("TRPKeyN").value;

    e.preventDefault();
    $.ajax({
        url: '/CallLoadNotificationSettingsForTenant', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'TRPKey': TRPKey,
            'ThisTen': SelTenantNow
        },
        success: function(data) {
            if (data.message) {

                let res = data.message.replaceAll('"', "");
                var rows = res.split("\n");

                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");

                    var CheckFRow = cells[0];
                    var AgentStatus = cells[1];

                    if (CheckFRow == "NOTIFICATION") {
                        if (AgentStatus == "STARTED") {
                            document.getElementById("AVDActionCenterAgentStatusNN").innerHTML = "Running";
                            document.getElementById("AVDActionCenterAgentStatusNN").style.color = "#00a400";
                        } else {
                            document.getElementById("AVDActionCenterAgentStatusNN").innerHTML = "Stopped";
                            document.getElementById("AVDActionCenterAgentStatusNN").style.color = "#f94b16";
                        }
                    }

                    var CheckSRow = cells[1];
                    var EnaOrdis = cells[2];
                    var NottifyWhen = cells[3];
                    var NotEmailTemplate = cells[4];

                    if (CheckSRow == "Force Removal Of Stale Connections From Session Hosts") {
                        document.getElementById("ActionStatus1").value = EnaOrdis;
                        document.getElementById("ActionNotifyWhen1").value = NottifyWhen;
                        document.getElementById("ActionEmailTemplate1").value = NotEmailTemplate;
                    }

                    if (CheckSRow == "Change VM Disk to Standard HDD for Turned Off VMs") {
                        document.getElementById("ActionStatus2").value = EnaOrdis;
                        document.getElementById("ActionNotifyWhen2").value = NottifyWhen;
                        document.getElementById("ActionEmailTemplate2").value = NotEmailTemplate;
                    }

                    if (CheckSRow == "UnAssign Users Not Using AVD for more than one week") {
                        document.getElementById("ActionStatus3").value = EnaOrdis;
                        document.getElementById("ActionNotifyWhen3").value = NottifyWhen;
                        document.getElementById("ActionEmailTemplate3").value = NotEmailTemplate;
                    }

                    if (CheckSRow == "Delete User Profiles not in use for more than one week") {
                        document.getElementById("ActionStatus4").value = EnaOrdis;
                        document.getElementById("ActionNotifyWhen4").value = NottifyWhen;
                        document.getElementById("ActionEmailTemplate4").value = NotEmailTemplate;
                    }

                    if (CheckSRow == "Auto-Repair Broken Session Hosts and Notify") {
                        document.getElementById("ActionStatus5").value = EnaOrdis;
                        document.getElementById("ActionNotifyWhen5").value = NottifyWhen;
                        document.getElementById("ActionEmailTemplate5").value = NotEmailTemplate;
                    }

                    if (CheckSRow == "Do Not Allow Connections to Overloaded Session Hosts") {
                        document.getElementById("ActionStatus6").value = EnaOrdis;
                        document.getElementById("ActionNotifyWhen6").value = NottifyWhen;
                        document.getElementById("ActionEmailTemplate6").value = NotEmailTemplate;
                    }

                    if (CheckSRow == "Re-Add Missing Assignments from Assignment Template") {
                        document.getElementById("ActionStatus7").value = EnaOrdis;
                        document.getElementById("ActionNotifyWhen7").value = NottifyWhen;
                        document.getElementById("ActionEmailTemplate7").value = NotEmailTemplate;
                        document.getElementById("SelActionAssTemplateForTenS").value = cells[5];
                    }

                    // For Notifications
                    if (CheckSRow == "Notify PCI Non-Compliant Items") {
                        document.getElementById("NOTNotificationStatus1").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen1").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate1").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If Turned On Session Hosts Are In Drain Mode") {
                        document.getElementById("NOTNotificationStatus2").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen2").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate2").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If Turned On Session Hosts Status Is Unavailable") {
                        document.getElementById("NOTNotificationStatus3").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen3").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate3").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If Turned On Session Hosts Are Idle") {
                        document.getElementById("NOTNotificationStatus4").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen4").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate4").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If Session Hosts Are Overloaded") {
                        document.getElementById("NOTNotificationStatus5").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen5").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate5").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If Session Hosts Are Underutilized") {
                        document.getElementById("NOTNotificationStatus6").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen6").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate6").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If Session Hosts Are Not Patched Since 10 Days") {
                        document.getElementById("NOTNotificationStatus7").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen7").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate7").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If Extra Session Hosts Are Turned On") {
                        document.getElementById("NOTNotificationStatus8").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen8").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate8").value = NotEmailTemplate;
                    }
                    if (CheckSRow == "Notify If FSLogix Profiles Corruption Occurs") {
                        document.getElementById("NOTNotificationStatus9").value = EnaOrdis;
                        document.getElementById("NOTNotificationNotifyWhen9").value = NottifyWhen;
                        document.getElementById("NOTNotificationEmailTemplate9").value = NotEmailTemplate;
                    }

                    // For Reports
                    if (CheckSRow == "Send Sessions Hosts Status Report") {
                        document.getElementById("AVDReportStatus1").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen1").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour1").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate1").value = cells[5];
                    }

                    if (CheckSRow == "Send PCI and Compliance Report") {
                        document.getElementById("AVDReportStatus2").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen2").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour2").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate2").value = cells[5];
                    }

                    if (CheckSRow == "Send Session Hosts Patching Status Report") {
                        document.getElementById("AVDReportStatus3").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen3").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour3").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate3").value = cells[5];
                    }
                    if (CheckSRow == "Send AVD Joined and Not Joined Users List") {
                        document.getElementById("AVDReportStatus4").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen4").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour4").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate4").value = cells[5];
                    }
                    if (CheckSRow == "Send Hourly Active Sessions List Per Host Pool") {
                        document.getElementById("AVDReportStatus5").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen5").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour5").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate5").value = cells[5];
                    }
                    if (CheckSRow == "Send Hourly Extra Hosts Turned On Vs Hosts Needed List") {
                        document.getElementById("AVDReportStatus6").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen6").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour6").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate6").value = cells[5];
                    }
                    if (CheckSRow == "Send Large User Profiles") {
                        document.getElementById("AVDReportStatus7").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen7").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour7").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate7").value = cells[5];
                        document.getElementById("MaxUserProfileSizeToCheck").value = cells[6];

                    }
                    if (CheckSRow == "Send Profiles Not In Use for More Than One Week") {
                        document.getElementById("AVDReportStatus8").value = EnaOrdis;
                        document.getElementById("AVDReportNotifyWhen8").value = NottifyWhen;
                        document.getElementById("AVDReportNotifyWhenHour8").value = cells[4];
                        document.getElementById("AVDReportEmailTemplate8").value = cells[5];
                    }

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";

});

$.ajaxSetup({
    timeout: 500000 //Time in milliseconds
});

//$(document).ajaxError(function(event, xhr) {
//    console.log(xhr.status + ': ' + xhr.statusText);
//});

$("#CloseKPIDialogouebox").click(function(e) {

    document.getElementById("KPIAgentSettingsPane").style.display = "none";

});


$("#RefAllTempHostPoolsInPaneND").click(function(e) {

    GetAllHostPoolsForTenant()

});


$("#FetchNetSettingsForhost").click(function(e) {

    document.getElementById("FetchingNetCircleNow").style.display = "block";

    var ThisHostName = document.getElementById("AVDExistingSessHostName").value;
    var ThisHostRSGroup = document.getElementById("AVDEistingSessRSGroupName").value;
    var ThisTenant = document.getElementById("AVDTempCreateAllTenList").value;

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/GetAllHostNetworks', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisHostName': ThisHostName,
            'ThisHostRSGroup': ThisHostRSGroup,
            'ThisTenant': ThisTenant,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                document.getElementById("WhatToGetFromServer").innerHTML = "COLLECTVMNETWORK";

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

});

function CheckNetworkFileForHost() {

    var ThisHostName = document.getElementById("AVDExistingSessHostName").value;
    var ThisTenant = document.getElementById("AVDTempCreateAllTenList").value;

    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/CallCheckHostNetworkFile', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisHostName': ThisHostName,
            'ThisTenant': ThisTenant,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                if (data.message == "FileNotFound") {

                    if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                        document.getElementById("FetchingNetCircleNow").style.display = "none";
                    }

                } else {
                    AppendVMNetsNow(data.message)
                    document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                    document.getElementById("RefAllTaskRunningListButton").click();

                    document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                    document.getElementById("FetchingNetCircleNow").style.display = "none";

                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });


}

function AppendVMNetsNow(ThisCompleteData) {
    document.getElementById("CollectVMSizesCircleN").style.display = "block";

    var ThisMsg = "Refreshing Host Networks. Please Wait..."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";

    let res = ThisCompleteData.replaceAll('"', "");

    var rows = res.split("\n");
    for (var i = 0; i < rows.length; i++) {
        var cells = rows[i].split(",");
        if (cells.length > 1) {

            var newcell = cells[0];
            var ThisValue = cells[1];

            if (newcell == "VirtualNetworkResourceGroupName") {
                document.getElementById("AVDVNetResGroupND").value = ThisValue;
            }
            if (newcell == "VNetName") {
                document.getElementById("AVDvNetNameN").value = ThisValue;
            }
            if (newcell == "VNetNameAddressSpace") {
                document.getElementById("AVDvNetAddressSpaceN").value = ThisValue;
            }
            if (newcell == "SubNetName") {
                document.getElementById("AVDSubNetNAmeN").value = ThisValue;
            }
            if (newcell == "SubNetNameAddressSpace") {
                document.getElementById("AVDSubNetAddressSpaceN").value = ThisValue;
            }

        }
    }

}

$("#RefAllHostPoolsForFileServerAdding").click(function(e) {

    var TempTenName = document.getElementById("SelectProfileServerTenantN").value;
    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/LoadTenPools', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisTenNow': TempTenName,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                var xLeft = document.getElementById("SelectServerProfileHostPoolHere");
                var options = document.querySelectorAll('#SelectServerProfileHostPoolHere option');
                options.forEach(o => o.remove());

                let res = data.message.replaceAll('"', "");

                var rows = res.split("\n");
                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");
                    if (cells.length > 1) {

                        var newcell = cells[0];

                        if (newcell == 'HostPool') {} else {
                            if (newcell == "" || newcell == null) {} else {

                                var optionR = document.createElement("option");
                                optionR.text = newcell;
                                xLeft.add(optionR);
                            }
                        }
                    }
                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });


});



$("#UpdateKPIAgentSettingsButton").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Update KPI Agent Settings for Host Pool?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "UPDATEKPISETTINGS";

});

$("#AppEmailSettingsNow").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Apply Email Settings to Email Template?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "UPDATEEMAILSETTINGS";

});

$("#AppEmailSendTestEmailN").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Send a Test Email?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "SENDTESTEMAIL";

});

$("#RemoveSelectedHostsInGrid").click(function(e) {

    var TotHostsNow = 0
    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("SessionHostsStatusTable");
    rows = table.rows;
    for (i = 1; i < (rows.length); i++) {

        //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
        x = rows[i].getElementsByTagName("TD")[0].innerHTML;

        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        var CheckThisHost = document.getElementById(ThisIDNow).checked;
        if (CheckThisHost == true) {
            ++TotHostsNow;
        }
    }

    document.getElementById("AllHostsSelectedNow").innerHTML = TotHostsNow + " Selected";

    if (TotHostsNow == 0) {
        var ThisMsg = "Please select Hosts in Grid...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {
        document.getElementById("SelectedHostsTotalNumberNow").innerHTML = TotHostsNow;
        document.getElementById("RemoveSelectedHostsModNow").style.display = "block";
        document.getElementById("DeleteVMResourcesForSelHosts").checked = false;
    }


});

$("#RestartSelectedSessHostsInBoard").click(function(e) {

    var TotHostsNow = 0
    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("SessionHostsStatusTable");
    rows = table.rows;
    for (i = 1; i < (rows.length); i++) {

        //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
        x = rows[i].getElementsByTagName("TD")[0].innerHTML;

        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        var CheckThisHost = document.getElementById(ThisIDNow).checked;
        if (CheckThisHost == true) {
            ++TotHostsNow;
        }
    }

    document.getElementById("AllHostsSelectedNow").innerHTML = TotHostsNow + " Selected";

    if (TotHostsNow == 0) {
        var ThisMsg = "Please select Hosts in Grid...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        ThisTen = document.getElementById("HOSTHAvaTenListN").value;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Restart selected Session Hosts in selected Tenant : " + ThisTen + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var ThisDataS = "NONE" + ":" + "NONE" + ":" + ThisTen;
        var FinalHostActionNow = ThisDataS + ":RESTARTSELECTEDHOSTS"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }


});

$("#RemoveSelHostsInDrainModeButton").click(function(e) {

    var TotHostsNow = 0
    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("SessionHostsStatusTable");
    rows = table.rows;
    for (i = 1; i < (rows.length); i++) {

        //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
        x = rows[i].getElementsByTagName("TD")[0].innerHTML;

        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        var CheckThisHost = document.getElementById(ThisIDNow).checked;
        if (CheckThisHost == true) {
            ++TotHostsNow;
        }
    }

    document.getElementById("AllHostsSelectedNow").innerHTML = TotHostsNow + " Selected";

    if (TotHostsNow == 0) {
        var ThisMsg = "Please select Hosts in Grid...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        ThisTen = document.getElementById("HOSTHAvaTenListN").value;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Remove Drain Mode for selected Session Hosts in selected Tenant : " + ThisTen + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var ThisDataS = "NONE" + ":" + "NONE" + ":" + ThisTen;
        var FinalHostActionNow = ThisDataS + ":REMOVEDRAINMODEFORSELECTEDHOSTS"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }


});

$("#AddSelHostsInDrainModeButton").click(function(e) {

    var TotHostsNow = 0
    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("SessionHostsStatusTable");
    rows = table.rows;
    for (i = 1; i < (rows.length); i++) {

        //<input id="CloudNovaVM-0:RG-Cloudnova-dev-avd:CloudNovaSH" type="checkbox" checked="checked" style="cursor: pointer;border: 1px solid black;border-radius: 10px;"></input>
        x = rows[i].getElementsByTagName("TD")[0].innerHTML;

        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        var CheckThisHost = document.getElementById(ThisIDNow).checked;
        if (CheckThisHost == true) {
            ++TotHostsNow;
        }
    }

    document.getElementById("AllHostsSelectedNow").innerHTML = TotHostsNow + " Selected";

    if (TotHostsNow == 0) {
        var ThisMsg = "Please select Hosts in Grid...."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";

        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        ThisTen = document.getElementById("HOSTHAvaTenListN").value;

        document.getElementById("ConfirmDBox").style.display = "block";
        var MSGNow = "Do you want to Add selected Session Hosts in Drain Mode for selected Tenant : " + ThisTen + " ?"
        document.getElementById("TakeActionMSG").innerHTML = MSGNow;
        document.getElementById("ActionDoWhat").innerHTML = "ALLHOSTACTIONSNOW";

        var ThisDataS = "NONE" + ":" + "NONE" + ":" + ThisTen;
        var FinalHostActionNow = ThisDataS + ":ADDSELECTEDHOSTSINDRAINMODE"
        document.getElementById("ForMultiStringID").innerHTML = FinalHostActionNow;

    }


});

$("#CloseRemoveSelecetdHostsMod").click(function(e) {

    document.getElementById("RemoveSelectedHostsModNow").style.display = "none";

});

function CopyAttrNowForEmailTempFunction() {

}

$("#SetAdminPassButton").click(function(e) {

    var ThisPassToEnc = document.getElementById("AdminPassHeres").value;
    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/CallPassEnc', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisPassToEnc': ThisPassToEnc,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                var FinalPassNow = data.message;

                var table, rows, i, x, y, shouldSwitch;
                table = document.getElementById("TemplateAttrTable");
                rows = table.rows;
                for (i = 1; i < (rows.length - 1); i++) {
                    x = rows[i].getElementsByTagName("TD")[0].innerHTML;
                    if (x == "Administrator Password") {
                        rows[i].getElementsByTagName("TD")[1].innerHTML = FinalPassNow;
                    }
                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

});


$("#CopyEmailTempAttrButtonNow").click(function(e) {

    var ThisEmailTemplate = document.getElementById("CopyFromEmailTemplateTo").value;
    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/CallCopyEmailTemplate', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisEmailTemplate': ThisEmailTemplate,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {

                let res = data.message.replaceAll('"', "");
                var rows = res.split("\n");

                for (var i = 0; i < rows.length; i++) {
                    var cells = rows[i].split(",");

                    var ParamName = cells[0];
                    var ParamValue = cells[1];

                    if (ParamName == "Email To") {
                        document.getElementById("EmailTempEmailToATTR").value = ParamValue;
                    }
                    if (ParamName == "SMTP Server") {
                        document.getElementById("EmailSTMPServerATTR").value = ParamValue;
                    }
                    if (ParamName == "SMTP Port") {
                        document.getElementById("EmailSMTPPortATTR").value = ParamValue;
                    }
                    if (ParamName == "Use SSL") {
                        document.getElementById("EmailUseSSLOrNotATTR").value = ParamValue;
                    }
                    if (ParamName == "Sender Email") {
                        document.getElementById("EmailSenderEmailATTR").value = ParamValue;
                    }
                    if (ParamName == "Sender Username") {
                        document.getElementById("EmailSenderUserNameATTR").value = ParamValue;
                    }
                    if (ParamName == "Sender Password") {
                        document.getElementById("EmailSenderPasswordATTR").value = ParamValue;
                    }
                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

});


$("#RegisterNowButtonForCloudNova").click(function(e) {

    document.getElementById("RegNovaCircle").style.display = "block";

    var ThisEmailAdd = document.getElementById("RegisterNovaYourEmail").value;
    var ThisLicCode = document.getElementById("RegisterNovaLicenseCode").value;
    var ThisLicData = document.getElementById("RegisterNovaLicenseFileNow").value;

    var TRPKey = document.getElementById("TRPKeyN").value;

    var ProceedOrNot = "Yes"

    if (ThisEmailAdd == "" || ThisLicCode == "" || ThisLicData == "") {

        document.getElementById("RegNovaCircle").style.display = "none";

        var ThisMsg = "Please provide all inputs."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

        ProceedOrNot = "No"
    }

    if (ProceedOrNot == "Yes") {
        $.ajax({
            url: '/CallRegCoudNova', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisEmailAdd': ThisEmailAdd,
                'ThisLicCode': ThisLicCode,
                'ThisLicData': ThisLicData,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    var SItem = data.message.replace(/[\r\n]+/gm, "");
                    var FinalItem = SItem.replaceAll(' ', '');

                    if (FinalItem == "InvalidRegData") {
                        document.getElementById("RegNovaCircle").style.display = "none";

                        var ThisMsg = "Error registering. Please contact Wintellisys."
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            clearInterval(MyTimerFooter);
                        }

                    }

                    if (FinalItem == "Registered") {
                        document.getElementById("RegNovaCircle").style.display = "none";
                        document.getElementById("RegistercloudNovaDeskMod").style.display = "none";

                        var ThisMsg = "Registration Successful!"
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                            clearInterval(MyTimerFooter);
                        }

                    }


                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });
    }
});

$("#RefAllProfSizeNow").click(function(e) {

    var DemoOrNot = document.getElementById("DOrNot").innerHTML;
    if (DemoOrNot == "DEMO") {
        var ThisMsg = "Task is not available in Demo Mode!"
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        var ProceedOrNot = "Yes"
        if (ProceedOrNot == "Yes") {

            document.getElementById("CollectingProfCircleNowS").style.display = "block";

            var ThisString = document.getElementById("ProfManagerTenListNH").value;
            var res = ThisString.split(":");
            var ThisProfTen = res[0];
            var ThisTenShare = res[1];

            var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
            var res = ThisLUserNow.split("@");
            var FinalUserNameNow = res[0];

            var TRPKey = document.getElementById("TRPKeyN").value;

            $.ajax({
                url: '/CallCollectProfileSizes', // This tells server which Route to use OKAYYYY
                type: 'POST',
                async: false,
                timeout: 50000,
                data: {
                    'ThisProfTen': ThisProfTen,
                    'ThisTenShare': ThisTenShare,
                    'ThisLUser': FinalUserNameNow,
                    'TRPKey': TRPKey
                },
                success: function(data) {
                    if (data.message) {

                        document.getElementById("WhatToGetFromServer").innerHTML = "PROFILESSIZES";

                    } else {
                        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    }
                },
                error: function() {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            });

        }

    }
});


function GetAllProfileSizesNowFunction() {

    var ProceedOrNot = "Yes"
    if (ProceedOrNot == "Yes") {

        var tablenew, rowsnew, i, x, y, shouldSwitch;
        tablenew = document.getElementById("ServerProfilesTable");
        rowsnew = tablenew.rows;

        var ThisString = document.getElementById("ProfManagerTenListNH").value;
        var res = ThisString.split(":");
        var ThisProfTen = res[0];
        var ThisTenShare = res[1];

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];
        var TRPKey = document.getElementById("TRPKeyN").value;

        $.ajax({
            url: '/CallGetProfileSizeFile', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisProfTen': ThisProfTen,
                'ThisTenShare': ThisTenShare,
                'ThisLUser': FinalUserNameNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    if (data.message == "FileNotFound") {
                        document.getElementById("CollectingProfCircleNowS").style.display = "block";
                    } else {

                        let res = data.message.replaceAll('"', "");
                        var rows = res.split("\n");

                        for (var r = 0; r < rows.length; r++) {
                            var cells = rows[r].split(",");

                            var ThisProfilePath = cells[0];
                            var ThisProfileSize = cells[3];

                            for (i = 1; i < (rowsnew.length - 1); i++) {
                                x = rowsnew[i].getElementsByTagName("TD")[0].innerHTML;
                                if (x == ThisProfilePath) {
                                    rowsnew[i].getElementsByTagName("TD")[8].innerHTML = ThisProfileSize;
                                }
                            }
                        }

                        document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                        document.getElementById("CollectingProfCircleNowS").style.display = "none";
                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });
    }
}

document.getElementById("ResetMenusNow").click();

$("#UncheckCheckAllHostsNowInGridSD").click(function(e) {

    var TotHostsNow = 0;

    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("SessionHostsStatusTable");
    rows = table.rows;
    for (i = 1; i < (rows.length); i++) {

        x = rows[i].getElementsByTagName("TD")[0].innerHTML;
        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        document.getElementById(ThisIDNow).checked = false;
    }

    document.getElementById("AllHostsSelectedNow").innerHTML = "0 Selected";


});

$("#CheckAllHostsNowInGridSD").click(function(e) {

    var TotHostsNow = 0;

    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("SessionHostsStatusTable");
    rows = table.rows;
    for (i = 1; i < (rows.length); i++) {

        x = rows[i].getElementsByTagName("TD")[0].innerHTML;
        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        document.getElementById(ThisIDNow).checked = true;

        ++TotHostsNow
    }

    document.getElementById("AllHostsSelectedNow").innerHTML = TotHostsNow + " Selected";

});

$("#GoUpdownHealthBoardTWO").click(function(e) {

    var CheckThisNow = document.getElementById("HostsStatusPerPoolResultDiv").style.display;
    if (CheckThisNow == "block") {
        document.getElementById("HostsStatusPerPoolResultDiv").style.display = "none";
        document.getElementById("SecondDivToGoUpDownNSD").style.height = "35px";
        document.getElementById("AllHostsAttrStatusDIV").style.height = "405px";

    } else {
        document.getElementById("HostsStatusPerPoolResultDiv").style.display = "block";
        document.getElementById("SecondDivToGoUpDownNSD").style.height = "300px";
        document.getElementById("AllHostsAttrStatusDIV").style.height = "212px";
    }
});

$("#GoUpdownHealthBoard").click(function(e) {

    var CheckThisNow = document.getElementById("ThisDivToGoUpNow").style.display;
    if (CheckThisNow == "block") {
        document.getElementById("ThisDivToGoUpNow").style.display = "none";
        document.getElementById("topDashboardDivNow").style.height = "27px";
        document.getElementById("AllHostsAttrStatusDIV").style.height = "405px";

    } else {
        document.getElementById("ThisDivToGoUpNow").style.display = "block";
        document.getElementById("topDashboardDivNow").style.height = "220px";
        document.getElementById("AllHostsAttrStatusDIV").style.height = "212px";
    }
});

function SwitchToAuthModeFunction() {
    if (document.getElementById("SelAuthMethodList").value == "PowerShell Authentication") {
        document.getElementById("TestAuthSPNDetailsHereDIV").style.display = "block";
        document.getElementById("TestRESTAPINDetailsHereDIV").style.display = "none";
    }

    if (document.getElementById("SelAuthMethodList").value == "REST API Authentication") {
        document.getElementById("TestAuthSPNDetailsHereDIV").style.display = "none";
        document.getElementById("TestRESTAPINDetailsHereDIV").style.display = "block";
    }



}

$("#TestAuthButtonToTestNow").click(function(e) {

    var ThisAuthToTest = document.getElementById("SelAuthMethodList").value;
    var RetryValue = document.getElementById("AuthRetries").value;
    var RetryPause = document.getElementById("AuthPauseBetweenRet").value;

    var SPNIDNow, SPNSec, SPNTen, SPNSubID, RESTClientID, RESTSec, RESTTenID;

    if (ThisAuthToTest == "PowerShell Authentication") {
        SPNIDNow = document.getElementById("TestAuthSPNGUID").value;
        SPNSec = document.getElementById("TestAuthSPNSec").value;
        SPNSubID = document.getElementById("TestAuthSPNSubID").value;
        SPNTen = document.getElementById("TestAuthSPNTenantID").value;
    }
    if (ThisAuthToTest == "REST API Authentication") {
        RESTClientID = document.getElementById("TestAuthClientIDHere").value;
        RESTSec = document.getElementById("TestAuthRestAPISecHere").value;
        RESTTenID = document.getElementById("TestAuthRESTAPITenIDHere").value;
    }


    var datatable = document.createElement("table");
    datatable.id = 'AuthTestResultTable'
    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

    document.getElementById("TestAuthCircleNow").style.display = "block";

    $.ajax({
        url: '/CallTestAppAuth', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisAuthToTest': ThisAuthToTest,
            'SPNIDNow': SPNIDNow,
            'SPNSec': SPNSec,
            'SPNTen': SPNTen,
            'SPNSubID': SPNSubID,
            'RESTClientID': RESTClientID,
            'RESTSec': RESTSec,
            'RESTTenID': RESTTenID,
            'RetryValue': RetryValue,
            'RetryPause': RetryPause
        },
        success: function(data) {
            if (data.message) {

                document.getElementById("TestAuthCircleNow").style.display = "none";

                if (data.message == "FileNotFound") {

                    var ThisMsg = "Nothing to show..."
                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                    document.getElementById("GettingReadyID").style.display = "none";
                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 2000);

                    function FunctionFooterDIV() {
                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                        clearInterval(MyTimerFooter);
                    }

                } else {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");
                        var row = datatable.insertRow(-1);

                        var CheckFRow = cells[0];

                        if (CheckFRow == "" || CheckFRow == null) {} else {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[0];
                        }
                    }

                    var dtable = document.getElementById("TestAuthResultDiv");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                }


            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

});


$("#FetchLogsNowProtected").click(function(e) {

    var ThisLogToGet = document.getElementById("SelectWhichLogToShowList").value;

    var datatable = document.createElement("table");
    datatable.id = 'ProtectedLogsTable'
    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

    $.ajax({
        url: '/CallProtectedLogs', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisLogToGet': ThisLogToGet
        },
        success: function(data) {
            if (data.message) {

                if (data.message == "NoLogToShow") {

                    var ThisMsg = "No Log To Show or Task does not have logs associated..."
                    document.getElementById("FootMessageID").innerHTML = ThisMsg;
                    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                    document.getElementById("GettingReadyID").style.display = "none";
                    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 2000);

                    function FunctionFooterDIV() {
                        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
                        clearInterval(MyTimerFooter);
                    }

                } else {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split("#");
                        var row = datatable.insertRow(-1);

                        var CheckFRow = cells[0];

                        if (CheckFRow == "" || CheckFRow == null) {} else {

                            var cell = row.insertCell(-1);
                            cell.innerHTML = cells[0];
                        }
                    }

                    var dtable = document.getElementById("ProtectedLogsDivNowNDD");
                    dtable.innerHTML = "";
                    dtable.appendChild(datatable);

                }


            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

});

$("#EnterNameOfHostPoolToRemoveSessHostsFrom").on("keyup", function() {
    var value = $(this).val().toLowerCase();

    var RCNew = document.getElementById("SelectedHostPoolToRemHFrom").innerHTML;
    var res = RCNew.split(":");
    var FinalPoolName = res[1];

    if (FinalPoolName == value) {
        document.getElementById("RemoveSessHostsNowButtonDD").style.border = "2px solid black !important";
    } else {
        document.getElementById("RemoveSessHostsNowButtonDD").style.border = "2px solid black";
    }

});

$("#ShowProtectedLogsNow").click(function(e) {
    document.getElementById("ShowProtectedLogsMod").style.display = "block";
});

$("#CloseProtectedLogMod").click(function(e) {
    document.getElementById("ShowProtectedLogsMod").style.display = "none";
});

$("#AVDOpenRegOptPane").click(function(e) {
    document.getElementById("RegistercloudNovaDeskMod").style.display = "block";
});

$("#CloseRegisterModNow").click(function(e) {
    document.getElementById("RegistercloudNovaDeskMod").style.display = "none";
});

$("#CloseAddHostTemplateMod").click(function(e) {

    document.getElementById("CreateAddHostTemplateMod").style.display = "none";

});

$("#MultiThreadDepIsOff").click(function(e) {

    document.getElementById("VerifyDepAttributesButton").click();

});

$("#AVDDeploySelectedHostPoolTempalteAndProcess").click(function(e) {

    document.getElementById("VerifyDepAttributesButton").click();

});
$("#AVDDeploySelectedImageTempAndProcess").click(function(e) {

    document.getElementById("VerifyDepAttributesButton").click();

});

$("#AVDDeploySelectFSLogixTempAndProcess").click(function(e) {

    document.getElementById("VerifyDepAttributesButton").click();

});

$("#AVDDeploySelectedHostTemplateAndProcess").click(function(e) {

    document.getElementById("VerifyDepAttributesButton").click();

});
$("#AVDDeploySelectScriptTempAndProcess").click(function(e) {

    document.getElementById("VerifyDepAttributesButton").click();

});
$("#AVDDeploySelectAssTemplateAndProcess").click(function(e) {

    document.getElementById("VerifyDepAttributesButton").click();

});

$("#RegisterNewAzureAppInApp").click(function(e) {

    document.getElementById("RegisterAppDModBox").style.display = "block";

});

$("#CloseRegAppDBox").click(function(e) {

    document.getElementById("RegisterAppDModBox").style.display = "none";

});

function PushKPIAgentFunctionNow(ThisID) {

    var ThisNow = ThisID.split(':');
    var ThisTenant = ThisNow[0];
    var ThisHostPool = ThisNow[1];

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Do you want to Push KPI Agent on all Session Hosts of Host Pool: " + ThisHostPool + " ?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "PUSHKPIAGENTNOWCALL";

}

$("#PushKPIAgentOnHostID").click(function(e) {

    var ThisHostNow = document.getElementById("SelHostNowInMonT").innerHTML;

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Do you want to Push KPI Agent on Session Host : " + ThisHostNow + " ?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "PUSHKPIAGENTONSINGLEHOST";

});

function CreateNewHostsTemplateFromHostHealth(ThisID) {

    var ThisNow = ThisID.split(':');
    var ThisTenant = ThisNow[0];
    var ThisHostPool = ThisNow[1];

    document.getElementById("CreateAddHostTemplateMod").style.display = "block";

    document.getElementById("AddHostTempForWhichTenant").innerHTML = "For Tenant:" + ThisTenant;
    document.getElementById("AddHostTempForWhichHostPool").innerHTML = "For Host Pool:" + ThisHostPool;

}

$("#CloseTestAppAuthMod").click(function(e) {
    // Create Template Here    
    document.getElementById("TestAppAuthModNow").style.display = "none";

});

$("#TestAppAuthID").click(function(e) {
    // Create Template Here    
    document.getElementById("TestAppAuthModNow").style.display = "block";

});

$("#CreateAddTemplateNowButtonSD").click(function(e) {
    // Create Template Here

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Create Additional Session Host Template?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "CREATEADDHOSTTEMPLATE";

});


function ShowCollectedUsersFromGroupFunction() {

    document.getElementById("CollingUsersFromGroupCircle").style.display = "block";

    var FinalGroupNow = document.getElementById("ThisGroupNameNowtoShowUsers").innerHTML;

    var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
    var res = ThisLUserNow.split("@");
    var FinalUserNameNow = res[0];

    var TRPKey = document.getElementById("TRPKeyN").value;
    var ThisTen = document.getElementById("ManageAssTenListNV").value;

    $.ajax({
        url: '/GetUsersFileForGroup', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: true,
        timeout: 50000,
        data: {
            'ThisGroup': FinalGroupNow,
            'ThisLUser': FinalUserNameNow,
            'TRPKey': TRPKey,
            'ThisTen': ThisTen
        },
        success: function(data) {
            if (data.message) {

                if (data.message == "FileNotFound") {
                    if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                        document.getElementById("CollingUsersFromGroupCircle").style.display = "none";
                    }

                } else {
                    document.getElementById("RefAllTaskRunningListButton").click();
                    FillUsersInTableNowFunction(data.message)
                    document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                    document.getElementById("CollingUsersFromGroupCircle").style.display = "none";
                }


            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                document.getElementById("SuperNovaStatusID").style.color = "red";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            document.getElementById("SuperNovaStatusID").style.color = "red";
        }
    });





}


function MonitorCaptureImage() {
    // Check Status here and load logs

    var tablenew, rowsnew, i, x, y, shouldSwitch;
    tablenew = document.getElementById("VerifiedTemplateAttrTable");
    rowsnew = tablenew.rows;

    var GlobalCaptureMonitorTimer = setInterval(function() { CheckStatusCaptureFunction() }, 30000);

    function CheckStatusCaptureFunction() {

        var ThisLUserNow = document.getElementById("LoggedInUserName").innerHTML;
        var res = ThisLUserNow.split("@");
        var FinalUserNameNow = res[0];

        var TRPKey = document.getElementById("TRPKeyN").value;
        var ThisVMName = document.getElementById("EditImageVMName").value;

        $.ajax({
            url: '/GetCaptureImageStatus', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisUser': FinalUserNameNow,
                'TRPKey': TRPKey,
                'ThisVMName': ThisVMName
            },
            success: function(data) {
                if (data.message) {

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var r = 0; r < rows.length; r++) {
                        var cells = rows[r].split(",");

                        var CheckFRow = cells[0];
                        var ThisAttr = cells[0];
                        var CheckDepStatus = cells[0];

                        if (CheckDepStatus == "Success") {
                            clearInterval(GlobalCaptureMonitorTimer);
                            document.getElementById("RemSelectedImageN").click();
                        }

                    }

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                    clearInterval(GlobalAVDDeplMonitor);

                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                clearInterval(GlobalAVDDeplMonitor);
            }
        });
    }

}

function FillUsersInTableNowFunction(ThisCompleteData) {
    // Check Status here and load logs

    var datatable = document.createElement("table");
    datatable.id = 'UsersGroupTableNow'
    datatable.setAttribute('class', 'SummaryTableClassforAzBilling');

    let res = ThisCompleteData.replaceAll('"', "");
    var rows = res.split("\n");

    for (var i = 0; i < rows.length; i++) {
        var cells = rows[i].split(",");
        var row = datatable.insertRow(-1);

        var CheckFRow = cells[0];

        if (CheckFRow == "ENDOFDATA") {

        } else {

            if (CheckFRow == "UPN") {
                for (var j = 0; j < cells.length; j++) {

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[j];

                    cell.style.backgroundColor = "white";
                    cell.style.color = "#066d95";
                    cell.style.textAlign = "left";
                    cell.style.letterSpacing = "0px";
                    cell.style.fontWeight = "600";
                    cell.style.borderBottom = "2px solid rgb(204, 200, 200)";
                    cell.style.position = "sticky";
                    cell.style.zIndex = "22";
                    cell.style.top = "0px";
                    cell.style.fontSize = "12px";
                    cell.style.fontFamily = "Calibri";

                }
            } else {

                var CheckIfBlank = cells[0]

                if (CheckIfBlank == "" || CheckIfBlank == null) {} else {

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[0];

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[1];

                    var cell = row.insertCell(-1);
                    cell.innerHTML = cells[2];

                }
            }

        }
    }

    var dtable = document.getElementById("AllUsersListFoundInTheGroupDiv");
    dtable.innerHTML = "";
    dtable.appendChild(datatable);

}

function SelUIDRefFunction() {
    document.getElementById("SelIdentifierButtonNo").click();
}

function AVDTemplateAllFetchImages() {

    document.getElementById("CollectingAVDCreateTempImagesCircle").style.display = "block";

    var ThisTenNow = document.getElementById("AVDTempCreateAllTenList").value;
    var TRPKey = document.getElementById("TRPKeyN").value;

    $.ajax({
        url: '/GetHostTemplateImagesFile', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: false,
        timeout: 50000,
        data: {
            'ThisTen': ThisTenNow,
            'TRPKey': TRPKey
        },
        success: function(data) {
            if (data.message) {
                if (data.message == "FileNotFound") {

                    if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                        document.getElementById("CollectingAVDCreateTempImagesCircle").style.display = "none";

                    }
                } else {

                    var xLeft = document.getElementById("AllTenImagesListND");
                    var options = document.querySelectorAll('#AllTenImagesListND option');
                    options.forEach(o => o.remove());

                    let res = data.message.replaceAll('"', "");
                    var rows = res.split("\n");

                    for (var i = 0; i < rows.length; i++) {
                        var cells = rows[i].split(",");

                        var newcell = cells[0];

                        var FinalName = cells[0] + "_" + cells[1] + "_" + cells[3];

                        if (newcell == "" || newcell == null) {} else {
                            if (newcell == "Image Name") {} else {
                                var optionR = document.createElement("option");
                                optionR.text = FinalName;
                                xLeft.add(optionR);
                            }
                        }
                    }

                    document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                    document.getElementById("RefAllTaskRunningListButton").click();

                    document.getElementById("CollectingAVDCreateTempImagesCircle").style.display = "none";

                }

            } else {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        },
        error: function() {
            document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
        }
    });

}

$("#RegisterAppButtonNowDD").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Register Azure App with CloudNovaDesk?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "REGISTERAZUREAPP";

});

$("#LogOnToAppWithPassButton").click(function(e) {

    document.getElementById('CheckAppPasswordNowCircle').style.display = "block";

    var EntAppPass = document.getElementById('EntAppPassToOpen').value;

    if (EntAppPass == "") {

        var ThisMsg = "Please Enter Application Access Password..."
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-400px";
            clearInterval(MyTimerFooter);
        }

    } else {

        // e.preventDefault();
        $.ajax({
            url: '/CallCheckAppEntPass', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: true,
            datatype: "JSON",
            data: {
                'EntAppPass': EntAppPass
            },
            success: function(data) {

                if (data.message) {

                    document.getElementById("CheckAppPasswordNowCircle").style.display = "none";

                    var SItem = data.message.replace(/[\r\n]+/gm, "");
                    var FinalItem = SItem.replaceAll(' ', '');

                    if (FinalItem == "OK") {
                        document.getElementById("RegisterAppDModBox").style.display = "block";
                        document.getElementById("CheckAppPassNowMod").style.display = "none";

                    }

                    if (FinalItem == "FAILED") {

                        var ThisMsg = "Error logging in!..."
                        document.getElementById("FootMessageID").innerHTML = ThisMsg;
                        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
                        document.getElementById("GettingReadyID").style.display = "none";
                        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

                        function FunctionFooterDIV() {
                            document.getElementById("ThisMSGFooter").style.marginLeft = "-400px";
                            clearInterval(MyTimerFooter);
                        }
                    }



                } else {
                    document.getElementById("CheckAppPasswordNowCircle").style.display = "none";

                }
            },
            error: function() {
                document.getElementById("CheckAppPasswordNowCircle").style.display = "none";
            }
        });
    }


});


$("#ShowProfilesButtonNowN").click(function(e) {

    e.preventDefault();
    document.getElementById("LoadedProfilesForSelTenDiv").style.display = "block";
    document.getElementById("LoadedProfileHandlesTableDiv").style.display = "none";

    document.getElementById("ShowProfileHAndlesButtonNN").style.background = "White";
    document.getElementById("ShowProfilesButtonNowN").style.background = "#9ee8ff";
    document.getElementById("ShowProfilesButtonNowN").style.color = "#312f2f";

    document.getElementById("SearchAllProfileHandles").style.display = "none";
    document.getElementById("SearchAllProfilesNNH").style.display = "inline-block";


});

$("#RefreshSessGridButtonNN").click(function(e) {

    e.preventDefault();
    document.getElementById("SessManaAvaSelSwitchButton").click();

});

$("#ShowProfileHAndlesButtonNN").click(function(e) {

    e.preventDefault();
    document.getElementById("LoadedProfilesForSelTenDiv").style.display = "none";
    document.getElementById("LoadedProfileHandlesTableDiv").style.display = "block";

    document.getElementById("ShowProfileHAndlesButtonNN").style.background = "#9ee8ff";
    document.getElementById("ShowProfileHAndlesButtonNN").style.color = "#312f2f";
    document.getElementById("ShowProfilesButtonNowN").style.background = "white";

    document.getElementById("SearchAllProfileHandles").style.display = "inline-block";
    document.getElementById("SearchAllProfilesNNH").style.display = "none";



});


$("#SetAppPasswordNowButton").click(function(e) {

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Set Application Access Password?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "SETAPPPASSWORD";

});

$("#RefAllAVDImagesDuringC").click(function(e) {

    var DemoOrNot = document.getElementById("DOrNot").innerHTML;
    if (DemoOrNot == "DEMO") {
        var ThisMsg = "Task is not available in Demo Mode!"
        document.getElementById("FootMessageID").innerHTML = ThisMsg;
        document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
        document.getElementById("GettingReadyID").style.display = "none";
        var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 3000);

        function FunctionFooterDIV() {
            document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
            clearInterval(MyTimerFooter);
        }

    } else {

        document.getElementById("CollectingAVDCreateTempImagesCircle").style.display = "block";

        var SelTenNow = document.getElementById("AllAvaTempltesOpt").value;

        var res = SelTempNow.split(":");
        var FinalSelTempNow = res[0];
        var FinalTypeNow = res[1];

        var TRPKey = document.getElementById("TRPKeyN").value;

        e.preventDefault();
        $.ajax({
            url: '/FetchAllAVDTenImages', // This tells server which Route to use OKAYYYY
            type: 'POST',
            async: false,
            timeout: 50000,
            data: {
                'ThisTenNow': SelTenNow,
                'TRPKey': TRPKey
            },
            success: function(data) {
                if (data.message) {

                    document.getElementById("WhatToGetFromServer").innerHTML = "FETCHIMAGESTEN";

                } else {
                    document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
                }
            },
            error: function() {
                document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
            }
        });

    }
});

function ApplySelImageNowForAVDTemp() {

    var ThisNow = document.getElementById("AllTenImagesListND").value;
    var RC = ThisNow.split("_")
    var FinalID = RC[2];

    document.getElementById("EntImageURIN").value = FinalID;


}

function PushKPIAgentFunctionNow(ThisID) {

    var ThisMsg = "Please push KPI Agent from Hosts Monitor & Actions Pane...."
    document.getElementById("FootMessageID").innerHTML = ThisMsg;
    document.getElementById("ThisMSGFooter").style.marginLeft = "00px";
    document.getElementById("GettingReadyID").style.display = "none";

    var MyTimerFooter = setInterval(function() { FunctionFooterDIV() }, 5000);

    function FunctionFooterDIV() {
        document.getElementById("ThisMSGFooter").style.marginLeft = "-1000px";
        clearInterval(MyTimerFooter);
    }


}

function LoadAPIUpdateFileNow() {

    $.ajax({
        url: '/LoadAPIUpdateFileNow', // This tells server which Route to use OKAYYYY
        type: 'POST',
        async: true,
        datatype: "JSON",
        success: function(data) {

        },
        error: function() {}
    });

}

function MonitoringActionLogoffUserFunction(ThisID) {

    //var AllAttr = HostNameNow + ":" + AppProcess+":"+ProcessID;                            

    var RC = ThisID.split(":")
    var ThisHost = RC[0];
    var ThisAppProcess = RC[1];
    var ThisProcessID = RC[2];

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Are you sure you want to Kill Process:  " + ThisAppProcess + " with ID: " + ThisProcessID + " ?";
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "ALLMONITORACTIONS";
    document.getElementById("ForMultiStringID").innerHTML = "KILLPROCESS:" + ThisHost + ":" + ThisAppProcess + ":" + ThisProcessID;

}

$("#RefreshAllProfAndHListN").click(function(e) {

    e.preventDefault();
    document.getElementById("ProfManaSwitchTenNN").click();

});


$("#MonitoringCloseHostActionBarNR").click(function(e) {

    e.preventDefault();
    document.getElementById("SessionHostMonitorDivForMonitoring").style.display = "none";

});

$("#HostActionMonitorHostNow").click(function(e) {

    e.preventDefault();
    document.getElementById("SessionHostMonitorDivForMonitoring").style.display = "block";

});

$("#SwitchToHostPoolsStatusNN").click(function(e) {

    e.preventDefault();

    document.getElementById("HostPoolStatusResultDivNow").style.display = "block"
    document.getElementById("SessHostStatusDivNowDD").style.display = "none"

    // document.getElementById("SwitchToHostPoolsStatusNN").style.background = "#9ee8ff";
    // document.getElementById("SwitchToSessHostsStatusDD").style.background = "white";


});

$("#SwitchToSessHostsStatusDD").click(function(e) {

    e.preventDefault();

    document.getElementById("HostPoolStatusResultDivNow").style.display = "none"
    document.getElementById("SessHostStatusDivNowDD").style.display = "block"

    // document.getElementById("SwitchToHostPoolsStatusNN").style.background = "white";
    // document.getElementById("SwitchToSessHostsStatusDD").style.background = "#9ee8ff";

});

$("#ClearQucikProfileHandlesNow").click(function(e) {

    e.preventDefault();

    var ThisUserHandle = document.getElementById("UPNOrADUserNameValue").value;

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Are you sure you want to close Handle for user : " + ThisUserHandle + " ?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "QUICKCLOSESINGLEHANDLENOW";
    //document.getElementById("ForMultiStringID").innerHTML = ThisID;

});

function CloseSingleFileHandleFunction(ThisID) {

    //var HandleString = ThisProfTen + ":" + ThisTenShare + ":" + cells[3]

    var RC = ThisID.split(":")
    var ThisProfTen = RC[0];
    var ThisTenShare = RC[1];
    var ThisHandlePath = RC[2];

    document.getElementById("ConfirmDBox").style.display = "block";
    var MSGNow = "Are you sure you want to close Handle: " + ThisHandlePath + " ?"
    document.getElementById("TakeActionMSG").innerHTML = MSGNow;
    document.getElementById("ActionDoWhat").innerHTML = "CLOSESINGLEHANDLENOW";
    document.getElementById("ForMultiStringID").innerHTML = ThisID;

}

$("#UncheckAllDatesInGridNow").click(function(e) {


    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("CostAnaAllDatesForWeekChartTable");
    rows = table.rows;
    for (i = 0; i < (rows.length); i++) {

        x = rows[i].getElementsByTagName("TD")[0].innerHTML;
        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        document.getElementById(ThisIDNow).checked = false;
    }


});


$("#CheckAllDatesInGridNow").click(function(e) {

    var table, rows, i, x, y, shouldSwitch;
    table = document.getElementById("CostAnaAllDatesForWeekChartTable");
    rows = table.rows;
    for (i = 0; i < (rows.length); i++) {

        x = rows[i].getElementsByTagName("TD")[0].innerHTML;
        var ThisNow = x.split('"');
        var ThisIDNow = ThisNow[1];
        document.getElementById(ThisIDNow).checked = true;

    }


});

function UpdateNameNowFunction() {

    var ChartCol = document.getElementById("CostAnaAllChartCols").value;
    var SelPol = document.getElementById("CostAnaSelectScope").value;

    document.getElementById("WhatChartToDisp").innerHTML = "Date-Wise Chart for Chart Column: " + ChartCol + " For Pool: " + SelPol

}

function UpdateNameNowFunctionTwo() {

    var ChartCol = document.getElementById("CostAnaAllChartCols").value;
    var SelPol = document.getElementById("CostAnaSelectScope").value;

    document.getElementById("WhatChartToDisp").innerHTML = "Date-Wise Chart for Chart Column: " + ChartCol + " For Pool: " + SelPol

}

function ShowSecItemsFunction(ThisSecItem) {




}

document.getElementById("MultiThreadDepIsOff").checked = true;

function RefAllNotForSelTenNowAndAll() {



}

function GlobalTimerForRefreshingTasks() {

    var GlobalTasksRefTimer = setInterval(function() { RefAllTasksInTimerNowFunction() }, 10000);

    function RefAllTasksInTimerNowFunction() {
        document.getElementById("RefAllTaskRunningListButton").click();

    }

}
var socket = io({
    reconnection: true,
    reconnectionDelay: 1000,
    reconnectionDelayMax: 5000,
    reconnectionAttempts: 99999
});

socket.emit('join', { userId: userId });

socket.on('disconnect', function() {
    console.log('disconnected to server');
    socket.emit('join', { userId: userId });
});

socket.on('message', function(data) {
    console.log("DataRecevied", data);
    if (data && data.message) {
        if (data.type === "RefHostsHealth") {
            if (data.message == "FileNotFound") {
                if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                    document.getElementById("CollectingHostsStatusCircle").style.display = "none";
                }

            } else {
                GetHostsHealthStatusFunction(data.message)
                document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                document.getElementById("RefAllTaskRunningListButton").click();

                document.getElementById("CollectingHostsStatusCircle").style.display = "none";
            }
        }
        //ASHISH
        else if (data.type === "CheckServerActionFile") {
            console.log("got the data");
            if (data.message == "FileNotFound") {
                if (document.getElementById("WhatToGetFromServer").innerHTML == "NONE") {
                    document.getElementById("ServerActionCircleNow").style.display = "none";
                }
            } else {
                UpdateServerActionItemsFunction(data.message)
                document.getElementById("WhatToGetFromServer").innerHTML = "NONE";
                document.getElementById("RefAllTaskRunningListButton").click();

                document.getElementById("ServerActionCircleNow").style.display = "none";
            }
        }

    } else {
        document.getElementById("SuperNovaStatusID").innerHTML = "Server Down";
    }

});